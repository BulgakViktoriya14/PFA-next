(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6156:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:function(){return r}})},2224:function(t,e,n){"use strict";var r=n(6983),i=n(8886),o=n(2695),a=n(8448),s=n(4594);function u(t){return t&&"object"===typeof t&&"default"in t?t:{default:t}}var c,l=u(r),h=((c={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",c["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",c["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",c["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",c["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",c["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",c["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",c["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",c["recaptcha-error"]="ReCAPTCHA error.",c),f=new a.ErrorFactory("appCheck","AppCheck",h),p=new Map,d={activated:!1,tokenObservers:[]},v={enabled:!1};function g(t){return p.get(t)||d}function y(t,e){p.set(t,e)}function m(){return v}function b(){return self.grecaptcha}function _(t){if(!g(t).activated)throw f.create("use-before-activation",{appName:t.name})}var w="https://www.google.com/recaptcha/api.js";function I(t,e){var n=g(t),r=new a.Deferred;y(t,o.__assign(o.__assign({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);var u=b();return u?u.ready((function(){E(t,e,u,i),r.resolve(u)})):function(t){var e=document.createElement("script");e.src=""+w,e.onload=t,document.head.appendChild(e)}((function(){var n=b();if(!n)throw new Error("no recaptcha");n.ready((function(){E(t,e,n,i),r.resolve(n)}))})),r.promise}function T(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return _(t),[4,g(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=g(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function E(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),a=g(t);y(t,o.__assign(o.__assign({},a),{reCAPTCHAState:o.__assign(o.__assign({},a.reCAPTCHAState),{widgetId:i})}))}var S="https://content-firebaseappcheck.googleapis.com/v1beta",C=3e4,k=96e4,N=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new a.Deferred,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new a.Deferred,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function A(t,e){var n=t.url,r=t.body;return o.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,u,c,l,h,p,d;return o.__generator(this,(function(o){switch(o.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),a={method:"POST",body:JSON.stringify(r),headers:t},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,a)];case 2:return s=o.sent(),[3,4];case 3:throw u=o.sent(),f.create("fetch-network-error",{originalErrorMessage:u.message});case 4:if(200!==s.status)throw f.create("fetch-status-error",{httpStatus:s.status});o.label=5;case 5:return o.trys.push([5,7,,8]),[4,s.json()];case 6:return c=o.sent(),[3,8];case 7:throw l=o.sent(),f.create("fetch-parse-error",{originalErrorMessage:l.message});case 8:if(!(h=c.ttl.match(/^([\d.]+)(s)$/))||!h[2]||isNaN(Number(h[1])))throw f.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+c.ttl});return p=1e3*Number(h[1]),d=Date.now(),[2,{token:c.attestationToken,expireTimeMillis:d+p,issuedAtTimeMillis:d}]}}))}))}function P(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:S+"/projects/"+r+"/apps/"+i+":exchangeRecaptchaToken?key="+o,body:{recaptcha_token:e}}}function O(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:S+"/projects/"+r+"/apps/"+i+":exchangeDebugToken?key="+o,body:{debug_token:e}}}var R="firebase-app-check-store",x="debug-token",D=null;function M(){return D||(D=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(f.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(R,{keyPath:"compositeKey"})}}}catch(r){e(f.create("storage-open",{originalErrorMessage:r.message}))}})))}function L(t){return j(U(t))}function F(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,M()];case 1:return n=o.sent(),r=n.transaction(R,"readwrite"),i=r.objectStore(R),a=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){a.onsuccess=function(e){t()},r.onerror=function(t){var n;e(f.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function j(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,M()];case 1:return e=o.sent(),n=e.transaction(R,"readonly"),r=n.objectStore(R),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(f.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function U(t){return t.options.appId+"-"+t.name}var q=new s.Logger("@firebase/app-check");function V(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!a.isIndexedDBAvailable())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,L(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),q.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}function B(t,e){return a.isIndexedDBAvailable()?function(t,e){return F(U(t),e)}(t,e).catch((function(t){q.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function K(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,j(x)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),(r=e,F(x,r)).catch((function(t){return q.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}function W(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){if((t=m()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}var H={error:"UNKNOWN_ERROR"};function G(t){return a.base64.encodeString(JSON.stringify(t),!1)}function z(t,e,n){return void 0===n&&(n=!1),o.__awaiter(this,void 0,void 0,(function(){var r,i,s,u,c,l,h,p,d,v,b,w,I,E;return o.__generator(this,(function(S){switch(S.label){case 0:return _(t),r=g(t),i=r.token,s=void 0,i?[3,2]:[4,V(t)];case 1:(u=S.sent())&&X(u)&&(i=u,y(t,o.__assign(o.__assign({},r),{token:i})),$(t,{token:i.token})),S.label=2;case 2:return!n&&i&&X(i)?[2,{token:i.token}]:m().enabled?(l=A,h=O,p=[t],[4,W()]):[3,6];case 3:return[4,l.apply(void 0,[h.apply(void 0,p.concat([S.sent()])),e])];case 4:return c=S.sent(),[4,B(t,c)];case 5:return S.sent(),y(t,o.__assign(o.__assign({},r),{token:c})),[2,{token:c.token}];case 6:return S.trys.push([6,12,,13]),r.customProvider?[4,r.customProvider.getToken()]:[3,8];case 7:return d=S.sent(),v=a.issuedAtTime(d.token),b=null!==v&&v<Date.now()&&v>0?1e3*v:Date.now(),i=o.__assign(o.__assign({},d),{issuedAtTimeMillis:b}),[3,11];case 8:return[4,T(t).catch((function(t){throw f.create("recaptcha-error")}))];case 9:return w=S.sent(),[4,A(P(t,w),e)];case 10:i=S.sent(),S.label=11;case 11:return[3,13];case 12:return I=S.sent(),q.error(I),s=I,[3,13];case 13:return i?[3,14]:(E=function(t){return{token:G(H),error:t}}(s),[3,16]);case 14:return E={token:i.token},y(t,o.__assign(o.__assign({},r),{token:i})),[4,B(t,i)];case 15:S.sent(),S.label=16;case 16:return $(t,E),[2,E]}}))}))}function Q(t,e,n,r,i){var a=g(t),s={next:r,error:i,type:n},u=o.__assign(o.__assign({},a),{tokenObservers:o.__spreadArray(o.__spreadArray([],a.tokenObservers),[s])});if(!u.tokenRefresher){var c=function(t,e){var n=this;return new N((function(){return o.__awaiter(n,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return g(t).token?[3,2]:[4,z(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,z(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=g(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return n=Math.min(n,r),Math.max(0,n-Date.now())}return 0}),C,k)}(t,e);u.tokenRefresher=c}if(u.tokenRefresher.isRunning()||!0!==a.isTokenAutoRefreshEnabled||u.tokenRefresher.start(),a.token&&X(a.token)){var l=a.token;Promise.resolve().then((function(){return r({token:l.token})})).catch((function(){}))}y(t,u)}function Y(t,e){var n=g(t),r=n.tokenObservers.filter((function(t){return t.next!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),y(t,o.__assign(o.__assign({},n),{tokenObservers:r}))}function $(t,e){for(var n=0,r=g(t).tokenObservers;n<r.length;n++){var i=r[n];try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch(o){}}}function X(t){return t.expireTimeMillis-Date.now()>0}function J(t,e){return{app:t,activate:function(e,n){return function(t,e,n){var r=g(t);if(r.activated)throw f.create("already-activated",{appName:t.name});var i=o.__assign(o.__assign({},r),{activated:!0});"string"===typeof e?i.siteKey=e:i.customProvider=e,i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,y(t,i),i.siteKey&&I(t,i.siteKey).catch((function(){}))}(t,e,n)},setTokenAutoRefreshEnabled:function(e){return function(t,e){var n=g(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),y(t,o.__assign(o.__assign({},n),{isTokenAutoRefreshEnabled:e}))}(t,e)},getToken:function(n){return function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r;return o.__generator(this,(function(i){switch(i.label){case 0:return[4,z(t,e,n)];case 1:if((r=i.sent()).error)throw r.error;return[2,{token:r.token}]}}))}))}(t,e,n)},onTokenChanged:function(n,r,i){return function(t,e,n,r,i){var o=function(){},a=function(){};return o=null!=n.next?n.next.bind(n):n,null!=n.error?a=n.error.bind(n):r&&(a=r),Q(t,e,"EXTERNAL",o,a),function(){return Y(t,o)}}(t,e,n,r)},INTERNAL:{delete:function(){for(var e=0,n=g(t).tokenObservers;e<n.length;e++){var r=n[e];Y(t,r.next)}return Promise.resolve()}}}}var Z="app-check-internal";!function(t){t.INTERNAL.registerComponent(new i.Component("appCheck",(function(t){return J(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider(Z).initialize()}))),t.INTERNAL.registerComponent(new i.Component(Z,(function(t){return function(t,e){return{getToken:function(n){return z(t,e,n)},addTokenListener:function(n){return Q(t,e,"INTERNAL",n)},removeTokenListener:function(e){return Y(t,e)}}}(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.2.0")}(l.default),function(){var t=a.getGlobal();if("string"===typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){var e=m();e.enabled=!0;var n=new a.Deferred;e.token=n,"string"===typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(K())}}()},2695:function(t,e,n){"use strict";n.r(e),n.d(e,{__extends:function(){return i},__assign:function(){return o},__rest:function(){return a},__decorate:function(){return s},__param:function(){return u},__metadata:function(){return c},__awaiter:function(){return l},__generator:function(){return h},__createBinding:function(){return f},__exportStar:function(){return p},__values:function(){return d},__read:function(){return v},__spread:function(){return g},__spreadArrays:function(){return y},__spreadArray:function(){return m},__await:function(){return b},__asyncGenerator:function(){return _},__asyncDelegator:function(){return w},__asyncValues:function(){return I},__makeTemplateObject:function(){return T},__importStar:function(){return S},__importDefault:function(){return C},__classPrivateFieldGet:function(){return k},__classPrivateFieldSet:function(){return N}});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var f=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function p(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||f(e,t,n)}function d(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function _(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof b?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(r){l(o[0][3],r)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:b(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&f(e,t,n);return E(e,t),e}function C(t){return t&&t.__esModule?t:{default:t}}function k(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function N(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}},6983:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return w},firebase:function(){return _}});var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create;Object.create;var i,o,a=n(8448),s=n(8886),u=n(4594),c=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i),l=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",f="[DEFAULT]",p=((o={})[h]="fire-core",o["@firebase/analytics"]="fire-analytics",o["@firebase/app-check"]="fire-app-check",o["@firebase/auth"]="fire-auth",o["@firebase/database"]="fire-rtdb",o["@firebase/functions"]="fire-fn",o["@firebase/installations"]="fire-iid",o["@firebase/messaging"]="fire-fcm",o["@firebase/performance"]="fire-perf",o["@firebase/remote-config"]="fire-rc",o["@firebase/storage"]="fire-gcs",o["@firebase/firestore"]="fire-fst",o["fire-js"]="fire-js",o["firebase-wrapper"]="fire-js-all",o),d=new u.Logger("@firebase/app"),v=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,a.deepCopy)(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=f),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"===typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!==typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if((0,a.contains)(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=p[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void d.warn(c.join(" "))}o(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!==typeof t)throw l.create("invalid-log-argument");(0,u.setUserLogHandler)(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,a.contains)(e,t))throw l.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return d.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!==typeof t[s])throw l.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&(0,a.deepExtend)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++){var f=h[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=r(r({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,a.deepExtend)(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,a.isBrowser)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var b=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,a.isNode)()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),b.apply(void 0,t)};var _=g;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new y(t)}),"PRIVATE")),t.registerVersion(h,"0.6.28",e),t.registerVersion("fire-js","")}(_);var w=_},8886:function(t,e,n){"use strict";n.r(e),n.d(e,{Component:function(){return c},ComponentContainer:function(){return f},Provider:function(){return h}});function r(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function o(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function s(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create;var u=n(8448),c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),l="[DEFAULT]",h=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new u.Deferred;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:l})}catch(p){}try{for(var r=o(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=a(i.value,2),u=s[0],c=s[1],h=this.normalizeInstanceIdentifier(u);try{var f=this.getOrInitializeService({instanceIdentifier:h});c.resolve(f)}catch(p){}}}catch(d){e={error:d}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=l),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(s(s([],a(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),a(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=l),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:s,options:i});try{for(var c=o(this.instancesDeferred.entries()),l=c.next();!l.done;l=c.next()){var h=a(l.value,2),f=h[0],p=h[1];s===this.normalizeInstanceIdentifier(f)&&p.resolve(u)}}catch(d){e={error:d}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return u},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var a=o(i),s=a.next();!s.done;s=a.next()){var u=s.value;try{u(t,e)}catch(c){}}}catch(l){n={error:l}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===l?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(a){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=l),this.component?this.component.multipleInstances?t:l:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();var f=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new h(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},7790:function(t,e,n){"use strict";var r=n(6983),i=n(8886),o=n(8448),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function c(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function h(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(R){i={error:R}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function p(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create;var d=n(4594);t=n.hmd(t);var v=n(4155),g="";function y(t){g=t}var m=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.stringify)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.jsonEval)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),b=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.contains)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),_=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new m(e)}}catch(n){}return new b},w=_("localStorage"),I=_("sessionStorage"),T=new d.Logger("@firebase/database"),E=function(){var t=1;return function(){return t++}}(),S=function(t){var e=(0,o.stringToByteArray)(t),n=new o.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"===typeof i&&"number"===typeof i.length?n+=C.apply(null,i):n+="object"===typeof i?(0,o.stringify)(i):i,n+=" "}return n},k=null,N=!0,A=function(t,e){(0,o.assert)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(T.logLevel=d.LogLevel.VERBOSE,k=T.log.bind(T),e&&I.set("logging_enabled",!0)):"function"===typeof t?k=t:(k=null,I.remove("logging_enabled"))},P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===N&&(N=!1,null===k&&!0===I.get("logging_enabled")&&A(!0)),k){var n=C.apply(null,t);k(n)}},O=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];P.apply(void 0,p([t],f(e)))}},R=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+C.apply(void 0,p([],f(t)));T.error(n)},x=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+C.apply(void 0,p([],f(t)));throw T.error(n),new Error(n)},D=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+C.apply(void 0,p([],f(t)));T.warn(n)},M=function(t){return"number"===typeof t&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},L="[MIN_NAME]",F="[MAX_NAME]",j=function(t,e){if(t===e)return 0;if(t===L||e===F)return-1;if(e===L||t===F)return 1;var n=Q(t),r=Q(e);return null!==n?null!==r?n-r===0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},U=function(t,e){return t===e?0:t<e?-1:1},q=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.stringify)(e))},V=function(t){if("object"!==typeof t||null===t)return(0,o.stringify)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.stringify)(e[i]),r+=":",r+=V(t[e[i]]);return r+="}"},B=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function K(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var W=function(t){(0,o.assert)(!M(t),"Invalid JSON number");var e,n,r,i,a,s=1023;0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),s))+s,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(e?1:0),u.reverse();var c=u.join(""),l="";for(a=0;a<64;a+=8){var h=parseInt(c.substr(a,8),2).toString(16);1===h.length&&(h="0"+h),l+=h}return l.toLowerCase()};var H=new RegExp("^-?(0*)\\d{1,10}$"),G=-2147483648,z=2147483647,Q=function(t){if(H.test(t)){var e=Number(t);if(e>=G&&e<=z)return e}return null},Y=function(t){try{t()}catch(e){setTimeout((function(){var t=e.stack||"";throw D("Exception was thrown by user callback.",t),e}),Math.floor(0))}},$=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n.unref&&n.unref(),n},X=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null===e||void 0===e?void 0:e.getImmediate({optional:!0}),this.appCheck||null===e||void 0===e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){D('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),J=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(P("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',D(t)},t}(),Z=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),tt="5",et=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,nt="websocket",rt="long_polling",it=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=w.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&w.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function ot(t,e,n){var r;if((0,o.assert)("string"===typeof e,"typeof type must == string"),(0,o.assert)("object"===typeof n,"typeof params must == object"),e===nt)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==rt)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return K(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}var at=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.contains)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.deepCopy)(this.counters_)},t}(),st={},ut={};function ct(t){var e=t.toString();return st[e]||(st[e]=new at),st[e]}var lt=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&Y((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},t}(),ht="start",ft="close",pt=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=O(t),this.stats_=ct(e),this.urlFn=function(t){return s.appCheckToken&&(t.ac=s.appCheckToken),ot(e,rt,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new lt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.isNodeSdk)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new dt((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=f(t,5),i=r[0],o=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===ht)n.id=o,n.password=a;else{if(i!==ft)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=f(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v=tt,n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&et.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(0,o.isNodeSdk)()&&(!!t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.base64Encode)(e),r=B(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.stringify)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),dt=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.isNodeSdk)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=E(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(u){P("frame writing exception"),u.stack&&P(u.stack),P(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||P("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.isNodeSdk)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){P("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),vt=null;"undefined"!==typeof MozWebSocket?vt=MozWebSocket:"undefined"!==typeof WebSocket&&(vt=WebSocket);var gt=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=O(this.connId),this.stats_=ct(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={};return i.v=tt,!(0,o.isNodeSdk)()&&"undefined"!==typeof location&&location.hostname&&et.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i.ac=r),ot(t,nt,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,w.set("previous_websocket_failure",!0);try{if((0,o.isNodeSdk)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+g+"/"+v.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization=this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a=v.env,s=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new vt(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new vt(this.connURL,[],i)}}catch(c){this.log_("Error instantiating WebSocket.");var u=c.message||c.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==vt&&!t.forceDisallow_},t.previouslyFailed=function(){return w.isInMemoryStorage||!0===w.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){w.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.jsonEval)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.assert)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=B(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),yt=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[pt,gt]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=gt&&gt.isAvailable(),o=i&&!gt.previouslyFailed();if(e.webSocketOnly&&(i||D("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[gt];else{var a=this.transports_=[];try{for(var s=h(t.ALL_TRANSPORTS),u=s.next();!u.done;u=s.next()){var c=u.value;c&&c.isAvailable()&&a.push(c)}}catch(l){n={error:l}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),mt=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=O("c:"+this.id+":"),this.transportManager_=new yt(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=$((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=q("t",t),n=q("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=q("t",t),n=q("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=q("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?R("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):R("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),tt!==n&&D("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),$((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):$((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(w.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),bt=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),_t=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.assert)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=p([],f(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.assert)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),wt=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,o.isMobileCordova)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(_t),It=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function Tt(){return new It("")}function Et(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function St(t){return t.pieces_.length-t.pieceNum_}function Ct(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new It(t.pieces_,e)}function kt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Nt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function At(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new It(e,0)}function Pt(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof It)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new It(n,0)}function Ot(t){return t.pieceNum_>=t.pieces_.length}function Rt(t,e){var n=Et(t),r=Et(e);if(null===n)return e;if(n===r)return Rt(Ct(t),Ct(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function xt(t,e){for(var n=Nt(t,0),r=Nt(e,0),i=0;i<n.length&&i<r.length;i++){var o=j(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Dt(t,e){if(St(t)!==St(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Mt(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(St(t)>St(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Lt=function(t,e){this.errorPrefix_=e,this.parts_=Nt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.stringLength)(this.parts_[n]);Ft(this)};function Ft(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+jt(t))}function jt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Ut,qt,Vt=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(n="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(_t),Bt=1e3,Kt=function(t){function e(n,r,i,a,s,u,c,l){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=e.nextPersistentConnectionId_++,h.log_=O("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=Bt,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!(0,o.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Vt.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&wt.getInstance().on("online",h.onOnline_,h),h}return s(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_((0,o.stringify)(i)),(0,o.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new o.Deferred,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&i===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.assert)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&(0,o.contains)(t,"w")){var n=(0,o.safeGet)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();D("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.isAdmin)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.isValidFormat)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.stringify)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):R("Unrecognized action received from server: "+(0,o.stringify)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Bt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Bt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Bt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return c(this,void 0,void 0,(function(){var t,n,r,i,a,s,u,c,h,p,d,v,g,y,m=this;return l(this,(function(l){switch(l.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())},h=function(t){(0,o.assert)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)},this.realtime_={close:c,sendRequest:h},p=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)])];case 2:return d=f.apply(void 0,[l.sent(),2]),v=d[0],g=d[1],s?P("getToken() completed but was canceled"):(P("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=g&&g.token,u=new mt(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){D(t+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")}),a)),[3,4];case 3:return y=l.sent(),this.log_("Failed to get token: "+y),s||(this.repoInfo_.nodeAdmin&&D(y),c()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){P("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){P("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=Bt,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return V(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new It(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){P("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){P("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=h(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,h(a.values())),u=s.next();!u.done;u=s.next()){var c=u.value;this.sendListen_(c)}}catch(p){n={error:p}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(d){t={error:d}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.isNodeSdk)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+g.replace(/\./g,"-")]=1,(0,o.isMobileCordova)()?t["framework.cordova"]=1:(0,o.isReactNative)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=wt.getInstance().currentlyOnline();return(0,o.isEmpty)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(bt),Wt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Ht=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Wt(L,t),r=new Wt(L,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Wt.MIN},t}(),Gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Ut},set:function(t){Ut=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return j(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Wt.MIN},e.prototype.maxPost=function(){return new Wt(F,Ut)},e.prototype.makePost=function(t,e){return(0,o.assert)("string"===typeof t,"KeyIndex indexValue must always be a string."),new Wt(t,Ut)},e.prototype.toString=function(){return".key"},e}(Ht),zt=new Gt,Qt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Yt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Xt.EMPTY_NODE,this.right=null!=o?o:Xt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Xt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Xt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),$t=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Yt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Xt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Yt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Yt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Qt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Qt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Qt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Qt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new $t,t}();function Jt(t,e){return j(t.name,e.name)}function Zt(t,e){return j(t,e)}var te,ee,ne,re=function(t){return"number"===typeof t?"number:"+W(t):"string:"+t},ie=function(t){if(t.isLeafNode()){var e=t.val();(0,o.assert)("string"===typeof e||"number"===typeof e||"object"===typeof e&&(0,o.contains)(e,".sv"),"Priority must be a string or number.")}else(0,o.assert)(t===qt||t.isEmpty(),"priority of unexpected type.");(0,o.assert)(t===qt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},oe=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ie(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return te},set:function(t){te=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return Ot(e)?this:".priority"===Et(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=Et(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.assert)(".priority"!==r||1===St(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ct(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+re(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?W(this.value_):this.value_,this.lazyHash_=S(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.assert)(i>=0,"Unknown leaf type: "+n),(0,o.assert)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var ae,se,ue=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?j(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Wt.MIN},e.prototype.maxPost=function(){return new Wt(F,new oe("[PRIORITY-POST]",ne))},e.prototype.makePost=function(t,e){var n=ee(t);return new Wt(e,new oe("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Ht)),ce=Math.log(2),le=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/ce,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),he=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new Yt(a,o.node,Yt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new Yt(a,o.node,Yt.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new Yt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,Yt.BLACK):(s(h,Yt.BLACK),s(h,Yt.RED))}return o}(new le(t.length));return new Xt(r||e,o)},fe={},pe=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.assert)(fe&&ue,"ChildrenNode.ts has not been loaded"),ae=ae||new t({".priority":fe},{".priority":ue})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.safeGet)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Xt?e:null},t.prototype.hasIndex=function(t){return(0,o.contains)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.assert)(e!==zt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,s=n.getIterator(Wt.Wrap),c=s.getNext();c;)a=a||e.isDefinedOn(c.node),i.push(c),c=s.getNext();r=a?he(i,e.getCompare()):fe;var l=e.toString(),h=u({},this.indexSet_);h[l]=e;var f=u({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.map)(this.indexes_,(function(t,i){var a=(0,o.safeGet)(r.indexSet_,i);if((0,o.assert)(a,"Missing index implementation for "+i),t===fe){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(Wt.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),he(s,a.getCompare())}return fe}var l=n.get(e.name),h=t;return l&&(h=h.remove(new Wt(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.map)(this.indexes_,(function(t){if(t===fe)return t;var r=n.get(e.name);return r?t.remove(new Wt(e.name,r)):t})),this.indexSet_)},t}(),de=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ie(this.priorityNode_),this.children_.isEmpty()&&(0,o.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return se||(se=new t(new Xt(Zt),null,pe.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||se},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?se:e},t.prototype.getChild=function(t){var e=Et(t);return null===e?this:this.getImmediateChild(e).getChild(Ct(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.assert)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Wt(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?se:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=Et(t);if(null===n)return e;(0,o.assert)(".priority"!==Et(t)||1===St(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(Ct(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(ue,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+re(this.getPriority().val())+":"),this.forEachChild(ue,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":S(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Wt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Wt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Wt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Wt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Wt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ve?-1:0},t.prototype.withIndex=function(e){if(e===zt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===zt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(ue),r=e.getIterator(ue),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===zt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),ve=new(function(t){function e(){return t.call(this,new Xt(Zt),de.EMPTY_NODE,pe.Default)||this}return s(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return de.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(de));Object.defineProperties(Wt,{MIN:{value:new Wt(L,de.EMPTY_NODE)},MAX:{value:new Wt(F,ve)}}),Gt.__EMPTY_NODE=de.EMPTY_NODE,oe.__childrenNodeConstructor=de,qt=ve,function(t){ne=t}(ve);function ge(t,e){if(void 0===e&&(e=null),null===t)return de.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.assert)(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t)return new oe(t,ge(e));if(t instanceof Array){var n=de.EMPTY_NODE;return K(t,(function(e,r){if((0,o.contains)(t,e)&&"."!==e.substring(0,1)){var i=ge(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(ge(e))}var r=[],i=!1;if(K(t,(function(t,e){if("."!==t.substring(0,1)){var n=ge(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Wt(t,n)))}})),0===r.length)return de.EMPTY_NODE;var a=he(r,Jt,(function(t){return t.name}),Zt);if(i){var s=he(r,ue.getCompare());return new de(a,ge(e),new pe({".priority":s},{".priority":ue}))}return new de(a,ge(e),pe.Default)}!function(t){ee=t}(ge);var ye=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.assert)(!Ot(e)&&".priority"!==Et(e),"Can't create PathIndex with empty path or .priority key"),n}return s(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?j(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=ge(t),r=de.EMPTY_NODE.updateChild(this.indexPath_,n);return new Wt(e,r)},e.prototype.maxPost=function(){var t=de.EMPTY_NODE.updateChild(this.indexPath_,ve);return new Wt(F,t)},e.prototype.toString=function(){return Nt(this.indexPath_,0).join("/")},e}(Ht),me=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?j(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Wt.MIN},e.prototype.maxPost=function(){return Wt.MAX},e.prototype.makePost=function(t,e){var n=ge(t);return new Wt(e,n)},e.prototype.toString=function(){return".value"},e}(Ht)),be="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",_e=function(){var t=0,e=[];return function(n){var r,i=n===t;t=n;var a=new Array(8);for(r=7;r>=0;r--)a[r]=be.charAt(n%64),n=Math.floor(n/64);(0,o.assert)(0===n,"Cannot push at time == 0");var s=a.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)s+=be.charAt(e[r]);return(0,o.assert)(20===s.length,"nextPushId: Length should be 20."),s}}(),we=function(t){if("2147483647"===t)return"-";var e=Q(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return F;var o=n[i],a=be.charAt(be.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},Ie=function(t){if("-2147483648"===t)return L;var e=Q(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=be.charAt(be.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function Te(t){return{type:"value",snapshotNode:t}}function Ee(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Se(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ce(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var ke=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){(0,o.assert)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(Se(e,s)):(0,o.assert)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(Ee(e,n)):a.trackChildChange(Ce(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(ue,(function(t,r){e.hasChild(t)||n.trackChildChange(Se(t,r))})),e.isLeafNode()||e.forEachChild(ue,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Ce(e,r,i))}else n.trackChildChange(Ee(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?de.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ne=function(){function t(e){this.indexedFilter_=new ke(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Wt(e,n))||(n=de.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=de.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(de.EMPTY_NODE);var i=this;return e.forEachChild(ue,(function(t,e){i.matches(new Wt(t,e))||(r=r.updateImmediateChild(t,de.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Ae=function(){function t(t){this.rangedFilter_=new Ne(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Wt(e,n))||(n=de.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=de.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=de.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(de.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){a=i.getNext();!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,de.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;(0,o.assert)(u.numChildren()===this.limit_,"");var c=new Wt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),p=r.getChildAfterChild(this.index_,l,this.reverse_);null!=p&&(p.name===e||u.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:a(p,c);if(h&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(Ce(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Se(e,f));var v=u.updateImmediateChild(e,de.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(Ee(p.name,p.node)),v.updateImmediateChild(p.name,p.node)):v}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=i&&(i.trackChildChange(Se(l.name,l.node)),i.trackChildChange(Ee(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,de.EMPTY_NODE)):t},t}(),Pe=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ue}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:L},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:F},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===ue},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Oe(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Re(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function xe(t,e){var n=t.copy();return n.index_=e,n}function De(t){var e,n={};return t.isDefault()||(t.index_===ue?e="$priority":t.index_===me?e="$value":t.index_===zt?e="$key":((0,o.assert)(t.index_ instanceof ye,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,o.stringify)(e),t.startSet_&&(n.startAt=(0,o.stringify)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,o.stringify)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,o.stringify)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,o.stringify)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function Me(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==ue&&(e.i=t.index_.toString()),e}var Le=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=O("p:rest:"),o.listens_={},o}return s(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.assert)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=De(t._queryParams);this.restRequest_(s+".json",l,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),(0,o.safeGet)(a.listens_,u)===c)&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=De(t._queryParams),r=t._path.toString(),i=new o.Deferred;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=f(i,2),s=a[0],u=a[1];s&&s.accessToken&&(e.auth=s.accessToken),u&&u.token&&(e.ac=u.token);var c=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.querystring)(e);r.log_("Sending REST request for "+c);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(n&&4===l.readyState){r.log_("REST Response for "+c+" received. status:",l.status,"response:",l.responseText);var t=null;if(l.status>=200&&l.status<300){try{t=(0,o.jsonEval)(l.responseText)}catch(e){D("Failed to parse JSON response for "+c+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&D("Got unsuccessful REST response for "+c+" Status: "+l.status),n(l.status);n=null}},l.open("GET",c,!0),l.send()}))},e}(bt),Fe=function(){function t(){this.rootNode_=de.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function je(){return{value:null,children:new Map}}function Ue(t,e,n){if(Ot(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=Et(e);t.children.has(r)||t.children.set(r,je()),Ue(t.children.get(r),e=Ct(e),n)}}function qe(t,e){if(Ot(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(ue,(function(e,n){Ue(t,new It(e),n)})),qe(t,e)}if(t.children.size>0){var r=Et(e);if(e=Ct(e),t.children.has(r))qe(t.children.get(r),e)&&t.children.delete(r);return 0===t.children.size}return!0}function Ve(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){Ve(r,new It(e.toString()+"/"+t),n)}))}var Be,Ke=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=u({},t);return this.last_&&K(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),We=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ke(t);var n=1e4+2e4*Math.random();$(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;K(e,(function(e,i){i>0&&(0,o.contains)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),$(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function He(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Be||(Be={}));var Ge,ze=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Be.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(Ot(this.path)){if(null!=this.affectedTree.value)return(0,o.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new It(e));return new t(Tt(),n,this.revert)}return(0,o.assert)(Et(this.path)===e,"operationForChild called for unrelated child."),new t(Ct(this.path),this.affectedTree,this.revert)},t}(),Qe=function(){function t(t,e){this.source=t,this.path=e,this.type=Be.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return Ot(this.path)?new t(this.source,Tt()):new t(this.source,Ct(this.path))},t}(),Ye=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Be.OVERWRITE}return t.prototype.operationForChild=function(e){return Ot(this.path)?new t(this.source,Tt(),this.snap.getImmediateChild(e)):new t(this.source,Ct(this.path),this.snap)},t}(),$e=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Be.MERGE}return t.prototype.operationForChild=function(e){if(Ot(this.path)){var n=this.children.subtree(new It(e));return n.isEmpty()?null:n.value?new Ye(this.source,Tt(),n.value):new t(this.source,Tt(),n)}return(0,o.assert)(Et(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ct(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Xe=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(Ot(t))return this.isFullyInitialized()&&!this.filtered_;var e=Et(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Je=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function Ze(t,e,n,r,i,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.assertionError)("Should only compare child_ events.");var r=new Wt(e.childName,e.snapshotNode),i=new Wt(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function tn(t,e){return{eventCache:t,serverCache:e}}function en(t,e,n,r){return tn(new Xe(e,n,r),t.serverCache)}function nn(t,e,n,r){return tn(t.eventCache,new Xe(e,n,r))}function rn(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function on(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var an=function(){function t(t,e){void 0===e&&(Ge||(Ge=new Xt(U)),e=Ge),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return K(e,(function(t,e){n=n.set(new It(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:Tt(),value:this.value};if(Ot(t))return null;var n=Et(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(Ct(t),e);return null!=i?{path:Pt(new It(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(Ot(e))return this;var n=Et(e),r=this.children.get(n);return null!==r?r.subtree(Ct(e)):new t(null)},t.prototype.set=function(e,n){if(Ot(e))return new t(n,this.children);var r=Et(e),i=(this.children.get(r)||new t(null)).set(Ct(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(Ot(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=Et(e),r=this.children.get(n);if(r){var i=r.remove(Ct(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(Ot(t))return this.value;var e=Et(t),n=this.children.get(e);return n?n.get(Ct(t)):null},t.prototype.setTree=function(e,n){if(Ot(e))return n;var r=Et(e),i=(this.children.get(r)||new t(null)).setTree(Ct(e),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(Tt(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Pt(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,Tt(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(Ot(t))return null;var i=Et(t),o=this.children.get(i);return o?o.findOnPath_(Ct(t),Pt(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,Tt(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(Ot(e))return this;this.value&&r(n,this.value);var i=Et(e),o=this.children.get(i);return o?o.foreachOnPath_(Ct(e),Pt(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(Tt(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(Pt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),sn=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new an(null))},t}();function un(t,e,n){if(Ot(e))return new sn(new an(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=Rt(i,e);return o=o.updateChild(a,n),new sn(t.writeTree_.set(i,o))}var s=new an(n),u=t.writeTree_.setTree(e,s);return new sn(u)}function cn(t,e,n){var r=t;return K(n,(function(t,n){r=un(r,Pt(e,t),n)})),r}function ln(t,e){if(Ot(e))return sn.empty();var n=t.writeTree_.setTree(e,new an(null));return new sn(n)}function hn(t,e){return null!=fn(t,e)}function fn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Rt(n.path,e)):null}function pn(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ue,(function(t,n){e.push(new Wt(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Wt(t,n.value))})),e}function dn(t,e){if(Ot(e))return t;var n=fn(t,e);return new sn(null!=n?new an(n):t.writeTree_.subtree(e))}function vn(t){return t.writeTree_.isEmpty()}function gn(t,e){return yn(Tt(),t.writeTree_,e)}function yn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.assert)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=yn(Pt(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(Pt(t,".priority"),r)),n}function mn(t,e){return On(e,t)}function bn(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.assert)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=t.allWrites.length-1;i&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&_n(u,r.path)?i=!1:Mt(r.path,u.path)&&(a=!0)),s--}if(i){if(a)return function(t){t.visibleWrites=In(t.allWrites,wn,Tt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0;r.snap?t.visibleWrites=ln(t.visibleWrites,r.path):K(r.children,(function(e){t.visibleWrites=ln(t.visibleWrites,Pt(r.path,e))}));return!0}return!1}function _n(t,e){if(t.snap)return Mt(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&Mt(Pt(t.path,n),e))return!0;return!1}function wn(t){return t.visible}function In(t,e,n){for(var r=sn.empty(),i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)Mt(n,s)?r=un(r,u=Rt(n,s),a.snap):Mt(s,n)&&(u=Rt(s,n),r=un(r,Tt(),a.snap.getChild(u)));else{if(!a.children)throw(0,o.assertionError)("WriteRecord should have .snap or .children");if(Mt(n,s))r=cn(r,u=Rt(n,s),a.children);else if(Mt(s,n))if(Ot(u=Rt(s,n)))r=cn(r,Tt(),a.children);else{var c=(0,o.safeGet)(a.children,Et(u));if(c){var l=c.getChild(Ct(u));r=un(r,Tt(),l)}}}}}return r}function Tn(t,e,n,r,i){if(r||i){var o=dn(t.visibleWrites,e);if(!i&&vn(o))return n;if(i||null!=n||hn(o,Tt())){return gn(In(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(Mt(t.path,e)||Mt(e,t.path))}),e),n||de.EMPTY_NODE)}return null}var a=fn(t.visibleWrites,e);if(null!=a)return a;var s=dn(t.visibleWrites,e);return vn(s)?n:null!=n||hn(s,Tt())?gn(s,n||de.EMPTY_NODE):null}function En(t,e,n,r){return Tn(t.writeTree,t.treePath,e,n,r)}function Sn(t,e){return function(t,e,n){var r=de.EMPTY_NODE,i=fn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ue,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=dn(t.visibleWrites,e);return n.forEachChild(ue,(function(t,e){var n=gn(dn(o,new It(t)),e);r=r.updateImmediateChild(t,n)})),pn(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return pn(dn(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function Cn(t,e,n,r){return function(t,e,n,r,i){(0,o.assert)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Pt(e,n);if(hn(t.visibleWrites,a))return null;var s=dn(t.visibleWrites,a);return vn(s)?i.getChild(n):gn(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function kn(t,e){return function(t,e){return fn(t.visibleWrites,e)}(t.writeTree,Pt(t.treePath,e))}function Nn(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=dn(t.visibleWrites,e),c=fn(u,Tt());if(null!=c)s=c;else{if(null==n)return[];s=gn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),p=f.getNext();p&&l.length<i;)0!==h(p,r)&&l.push(p),p=f.getNext();return l}(t.writeTree,t.treePath,e,n,r,i,o)}function An(t,e,n){return function(t,e,n,r){var i=Pt(e,n),o=fn(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?gn(dn(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Pn(t,e){return On(Pt(t.treePath,e),t.writeTree)}function On(t,e){return{treePath:t,writeTree:e}}var Rn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.assert)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,Ce(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,Se(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,Ee(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.assertionError)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,Ce(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),xn=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Dn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Xe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return An(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:on(this.viewCache_),i=Nn(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();function Mn(t,e,n,r,i){var a,s,u=new Rn;if(n.type===Be.OVERWRITE){var c=n;c.source.fromUser?a=jn(t,e,c.path,c.snap,r,i,u):((0,o.assert)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!Ot(c.path),a=Fn(t,e,c.path,c.snap,r,i,s,u))}else if(n.type===Be.MERGE){var l=n;l.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=Pt(n,r);Un(e,Et(c))&&(s=jn(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=Pt(n,r);Un(e,Et(c))||(s=jn(t,s,c,u,i,o,a))})),s}(t,e,l.path,l.children,r,i,u):((0,o.assert)(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered(),a=Vn(t,e,l.path,l.children,r,i,s,u))}else if(n.type===Be.ACK_USER_WRITE){var h=n;a=h.revert?function(t,e,n,r,i,a){var s;if(null!=kn(r,n))return e;var u=new Dn(r,e,i),c=e.eventCache.getNode(),l=void 0;if(Ot(n)||".priority"===Et(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=En(r,on(e));else{var f=e.serverCache.getNode();(0,o.assert)(f instanceof de,"serverChildren would be complete if leaf node"),h=Sn(r,f)}h=h,l=t.filter.updateFullNode(c,h,a)}else{var p=Et(n),d=An(r,p,e.serverCache);null==d&&e.serverCache.isCompleteForChild(p)&&(d=c.getImmediateChild(p)),(l=null!=d?t.filter.updateChild(c,p,d,Ct(n),u,a):e.eventCache.getNode().hasChild(p)?t.filter.updateChild(c,p,de.EMPTY_NODE,Ct(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=En(r,on(e))).isLeafNode()&&(l=t.filter.updateFullNode(l,s,a))}return s=e.serverCache.isFullyInitialized()||null!=kn(r,Tt()),en(e,l,s,t.filter.filtersNodes())}(t,e,h.path,r,i,u):function(t,e,n,r,i,o,a){if(null!=kn(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(Ot(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Fn(t,e,n,u.getNode().getChild(n),i,o,s,a);if(Ot(n)){var c=new an(null);return u.getNode().forEachChild(zt,(function(t,e){c=c.set(new It(t),e)})),Vn(t,e,n,c,i,o,s,a)}return e}var l=new an(null);return r.foreach((function(t,e){var r=Pt(n,t);u.isCompleteForPath(r)&&(l=l.set(t,u.getNode().getChild(r)))})),Vn(t,e,n,l,i,o,s,a)}(t,e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==Be.LISTEN_COMPLETE)throw(0,o.assertionError)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache,a=nn(e,o.getNode(),o.isFullyInitialized()||Ot(n),o.isFiltered());return Ln(t,a,n,r,xn,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=rn(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Te(rn(e)))}}(e,a,f),{viewCache:a,changes:f}}function Ln(t,e,n,r,i,a){var s=e.eventCache;if(null!=kn(r,n))return e;var u=void 0,c=void 0;if(Ot(n))if((0,o.assert)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var l=on(e),h=Sn(r,l instanceof de?l:de.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),h,a)}else{var f=En(r,on(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var p=Et(n);if(".priority"===p){(0,o.assert)(1===St(n),"Can't have a priority with additional path components");var d=s.getNode(),v=Cn(r,n,d,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(d,v):s.getNode()}else{var g=Ct(n),y=void 0;if(s.isCompleteForChild(p)){c=e.serverCache.getNode();var m=Cn(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(p).updateChild(g,m):s.getNode().getImmediateChild(p)}else y=An(r,p,e.serverCache);u=null!=y?t.filter.updateChild(s.getNode(),p,y,g,i,a):s.getNode()}}return en(e,u,s.isFullyInitialized()||Ot(n),t.filter.filtersNodes())}function Fn(t,e,n,r,i,o,a,s){var u,c=e.serverCache,l=a?t.filter:t.filter.getIndexedFilter();if(Ot(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=Et(n);if(!c.isCompleteForPath(n)&&St(n)>1)return e;var p=Ct(n),d=c.getNode().getImmediateChild(f).updateChild(p,r);u=".priority"===f?l.updatePriority(c.getNode(),d):l.updateChild(c.getNode(),f,d,p,xn,null)}var v=nn(e,u,c.isFullyInitialized()||Ot(n),l.filtersNodes());return Ln(t,v,n,i,new Dn(i,v,o),s)}function jn(t,e,n,r,i,o,a){var s,u,c=e.eventCache,l=new Dn(i,e,o);if(Ot(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=en(e,u,!0,t.filter.filtersNodes());else{var h=Et(n);if(".priority"===h)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=en(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=Ct(n),p=c.getNode().getImmediateChild(h),d=void 0;if(Ot(f))d=r;else{var v=l.getCompleteChild(h);d=null!=v?".priority"===kt(f)&&v.getChild(At(f)).isEmpty()?v:v.updateChild(f,r):de.EMPTY_NODE}if(p.equals(d))s=e;else s=en(e,t.filter.updateChild(c.getNode(),h,d,f,l,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function Un(t,e){return t.eventCache.isCompleteForChild(e)}function qn(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function Vn(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=Ot(n)?r:new an(null).setTree(n,r);var l=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=qn(0,e.serverCache.getNode().getImmediateChild(n),r);c=Fn(t,c,new It(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=qn(0,e.serverCache.getNode().getImmediateChild(n),r);c=Fn(t,c,new It(n),h,i,o,a,s)}})),c}var Bn,Kn=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new ke(r.getIndex()),o=(n=r).loadsAllData()?new ke(n.getIndex()):n.hasLimit()?new Ae(n):new Ne(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(de.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(de.EMPTY_NODE,s.getNode(),null),l=new Xe(u,a.isFullyInitialized(),i.filtersNodes()),h=new Xe(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=tn(h,l),this.eventGenerator_=new Je(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function Wn(t,e){var n=on(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ot(e)&&!n.getImmediateChild(Et(e)).isEmpty())?n.getChild(e):null}function Hn(t){return 0===t.eventRegistrations_.length}function Gn(t,e,n){var r=[];if(n){(0,o.assert)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function zn(t,e,n,r){e.type===Be.MERGE&&null!==e.source.queryId&&((0,o.assert)(on(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.assert)(rn(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=t.viewCache_,u=Mn(t.processor_,s,e,n,r);return i=t.processor_,a=u.viewCache,(0,o.assert)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,o.assert)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,o.assert)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,Qn(t,u.changes,u.viewCache.eventCache.getNode(),null)}function Qn(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Ze(t,i,"child_removed",e,r,n),Ze(t,i,"child_added",e,r,n),Ze(t,i,"child_moved",o,r,n),Ze(t,i,"child_changed",e,r,n),Ze(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}var Yn,$n=function(){this.views=new Map};function Xn(t,e,n,r){var i,a,s=e.source.queryId;if(null!==s){var u=t.views.get(s);return(0,o.assert)(null!=u,"SyncTree gave us an op for an invalid query."),zn(u,e,n,r)}var c=[];try{for(var l=h(t.views.values()),f=l.next();!f.done;f=l.next()){u=f.value;c=c.concat(zn(u,e,n,r))}}catch(p){i={error:p}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return c}function Jn(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=En(n,i?r:null),u=!1;s?u=!0:r instanceof de?(s=Sn(n,r),u=!1):(s=de.EMPTY_NODE,u=!1);var c=tn(new Xe(s,u,!1),new Xe(r,i,!1));return new Kn(e,c)}return a}function Zn(t,e,n,r,i,o){var a=Jn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ue,(function(t,e){r.push(Ee(t,e))})),n.isFullyInitialized()&&r.push(Te(n.getNode())),Qn(t,r,n.getNode(),e)}(a,n)}function tr(t,e,n,r){var i,a,s=e._queryIdentifier,u=[],c=[],l=or(t);if("default"===s)try{for(var p=h(t.views.entries()),d=p.next();!d.done;d=p.next()){var v=f(d.value,2),g=v[0],y=v[1];c=c.concat(Gn(y,n,r)),Hn(y)&&(t.views.delete(g),y.query._queryParams.loadsAllData()||u.push(y.query))}}catch(m){i={error:m}}finally{try{d&&!d.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}else(y=t.views.get(s))&&(c=c.concat(Gn(y,n,r)),Hn(y)&&(t.views.delete(s),y.query._queryParams.loadsAllData()||u.push(y.query)));return l&&!or(t)&&u.push(new((0,o.assert)(Bn,"Reference.ts has not been loaded"),Bn)(e._repo,e._path)),{removed:u,events:c}}function er(t){var e,n,r=[];try{for(var i=h(t.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function nr(t,e){var n,r,i=null;try{for(var o=h(t.views.values()),a=o.next();!a.done;a=o.next()){var s=a.value;i=i||Wn(s,e)}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function rr(t,e){if(e._queryParams.loadsAllData())return ar(t);var n=e._queryIdentifier;return t.views.get(n)}function ir(t,e){return null!=rr(t,e)}function or(t){return null!=ar(t)}function ar(t){var e,n;try{for(var r=h(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var sr=1,ur=function(t){this.listenProvider_=t,this.syncPointTree_=new an(null),this.pendingWriteTree_={visibleWrites:sn.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function cr(t,e,n,r,i){return function(t,e,n,r,i){(0,o.assert)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=un(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?yr(t,new Ye({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function lr(t,e,n,r){!function(t,e,n,r){(0,o.assert)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=cn(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=an.fromObject(n);return yr(t,new $e({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}function hr(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(bn(t.pendingWriteTree_,e)){var i=new an(null);return null!=r.snap?i=i.set(Tt(),!0):K(r.children,(function(t){i=i.set(new It(t),!0)})),yr(t,new ze(r.path,i,n))}return[]}function fr(t,e,n){return yr(t,new Ye({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function pr(t,e,n,r){var i=e._path,o=t.syncPointTree_.get(i),a=[];if(o&&("default"===e._queryIdentifier||ir(o,e))){var s=tr(o,e,n,r);0===o.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex((function(t){return t._queryParams.loadsAllData()})),l=t.syncPointTree_.findOnPath(i,(function(t,e){return or(e)}));if(c&&!l){var h=t.syncPointTree_.subtree(i);if(!h.isEmpty())for(var f=function(t){return t.fold((function(t,e,n){if(e&&or(e))return[ar(e)];var r=[];return e&&(r=er(e)),K(n,(function(t,e){r=r.concat(e)})),r}))}(h),p=0;p<f.length;++p){var d=f[p],v=d.query,g=_r(t,d);t.listenProvider_.startListening(Cr(v),wr(t,v),g.hashFn,g.onComplete)}}if(!l&&u.length>0&&!r)if(c){t.listenProvider_.stopListening(Cr(e),null)}else u.forEach((function(e){var n=t.queryToTagMap.get(Ir(e));t.listenProvider_.stopListening(Cr(e),n)}));!function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=Ir(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,u)}return a}function dr(t,e,n){var r=e._path,i=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=Rt(t,r);i=i||nr(e,n),a=a||or(e)}));var s,u=t.syncPointTree_.get(r);(u?(a=a||or(u),i=i||nr(u,Tt())):(u=new $n,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=i)?s=!0:(s=!1,i=de.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=nr(e,Tt());n&&(i=i.updateImmediateChild(t,n))})));var c=ir(u,e);if(!c&&!e._queryParams.loadsAllData()){var l=Ir(e);(0,o.assert)(!t.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=sr++;t.queryToTagMap.set(l,h),t.tagToQueryMap.set(h,l)}var f=Zn(u,e,n,mn(t.pendingWriteTree_,r),i,s);if(!c&&!a){var p=rr(u,e);f=f.concat(function(t,e,n){var r=e._path,i=wr(t,e),a=_r(t,n),s=t.listenProvider_.startListening(Cr(e),i,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(i)(0,o.assert)(!or(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!Ot(t)&&e&&or(e))return[ar(e).query];var r=[];return e&&(r=r.concat(er(e).map((function(t){return t.query})))),K(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];t.listenProvider_.stopListening(Cr(h),wr(t,h))}return s}(t,e,p))}return f}function vr(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=nr(n,Rt(t,e));if(r)return r}));return Tn(r,e,i,n,!0)}function gr(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=Rt(t,n);r=r||nr(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||nr(i,Tt()):(i=new $n,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Xe(r,!0,!1):null;return function(t){return rn(t.viewCache_)}(Jn(i,e,mn(t.pendingWriteTree_,e._path),o?a.getNode():de.EMPTY_NODE,o))}function yr(t,e){return mr(e,t.syncPointTree_,null,mn(t.pendingWriteTree_,Tt()))}function mr(t,e,n,r){if(Ot(t.path))return br(t,e,n,r);var i=e.get(Tt());null==n&&null!=i&&(n=nr(i,Tt()));var o=[],a=Et(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=Pn(r,a);o=o.concat(mr(s,u,c,l))}return i&&(o=o.concat(Xn(i,t,r,n))),o}function br(t,e,n,r){var i=e.get(Tt());null==n&&null!=i&&(n=nr(i,Tt()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=Pn(r,e),u=t.operationForChild(e);u&&(o=o.concat(br(u,i,a,s)))})),i&&(o=o.concat(Xn(i,t,r,n))),o}function _r(t,e){var n=e.query,r=wr(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||de.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=Tr(t,n);if(r){var i=Er(r),o=i.path,a=i.queryId,s=Rt(o,e);return Sr(t,o,new Qe(He(a),s))}return[]}(t,n._path,r):function(t,e){return yr(t,new Qe({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return pr(t,n,null,i)}}}function wr(t,e){var n=Ir(e);return t.queryToTagMap.get(n)}function Ir(t){return t._path.toString()+"$"+t._queryIdentifier}function Tr(t,e){return t.tagToQueryMap.get(e)}function Er(t){var e=t.indexOf("$");return(0,o.assert)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new It(t.substr(0,e))}}function Sr(t,e,n){var r=t.syncPointTree_.get(e);return(0,o.assert)(r,"Missing sync point for query tag that we're tracking"),Xn(r,n,mn(t.pendingWriteTree_,e),null)}function Cr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.assert)(Yn,"Reference.ts has not been loaded"),Yn)(t._repo,t._path):t}var kr=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),Nr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=Pt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return vr(this.syncTree_,this.path_)},t}(),Ar=function(t,e,n){return t&&"object"===typeof t?((0,o.assert)(".sv"in t,"Unexpected leaf node or priority contents"),"string"===typeof t[".sv"]?Pr(t[".sv"],e,n):"object"===typeof t[".sv"]?Or(t[".sv"],e):void(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Pr=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,o.assert)(!1,"Unexpected server value: "+t)}},Or=function(t,e,n){t.hasOwnProperty("increment")||(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!==typeof r&&(0,o.assert)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.assert)(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},Rr=function(t,e,n,r){return Dr(e,new Nr(n,t),r)},xr=function(t,e,n){return Dr(t,new kr(e),n)};function Dr(t,e,n){var r,i=t.getPriority().val(),o=Ar(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=Ar(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new oe(s,ge(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new oe(o))),u.forEachChild(ue,(function(t,i){var o=Dr(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var Mr=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function Lr(t,e){for(var n=e instanceof It?e:new It(e),r=t,i=Et(n);null!==i;){var a=(0,o.safeGet)(r.node.children,i)||{children:{},childCount:0};r=new Mr(i,r,a),i=Et(n=Ct(n))}return r}function Fr(t){return t.node.value}function jr(t,e){t.node.value=e,Kr(t)}function Ur(t){return t.node.childCount>0}function qr(t,e){K(t.node.children,(function(n,r){e(new Mr(n,t,r))}))}function Vr(t,e,n,r){n&&!r&&e(t),qr(t,(function(t){Vr(t,e,!0,r)})),n&&r&&e(t)}function Br(t){return new It(null===t.parent?t.name:Br(t.parent)+"/"+t.name)}function Kr(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===Fr(t)&&!Ur(t)}(n),i=(0,o.contains)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Kr(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,Kr(t))}(t.parent,t.name,t)}var Wr=/[\[\].#$\/\u0000-\u001F\u007F]/,Hr=/[\[\].#$\u0000-\u001F\u007F]/,Gr=10485760,zr=function(t){return"string"===typeof t&&0!==t.length&&!Wr.test(t)},Qr=function(t){return"string"===typeof t&&0!==t.length&&!Hr.test(t)},Yr=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!M(t)||t&&"object"===typeof t&&(0,o.contains)(t,".sv")},$r=function(t,e,n,r){r&&void 0===e||Xr((0,o.errorPrefix)(t,"value"),e,n)},Xr=function(t,e,n){var r=n instanceof It?new Lt(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+jt(r));if("function"===typeof e)throw new Error(t+"contains a function "+jt(r)+" with contents = "+e.toString());if(M(e))throw new Error(t+"contains "+e.toString()+" "+jt(r));if("string"===typeof e&&e.length>Gr/3&&(0,o.stringLength)(e)>Gr)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+jt(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"===typeof e){var i=!1,a=!1;if(K(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!zr(e)))throw new Error(t+" contains an invalid key ("+e+") "+jt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.stringLength)(e),Ft(t)}(r,e),Xr(t,n,r),function(t){var e=t.parts_.pop();t.byteLength_-=(0,o.stringLength)(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)})),i&&a)throw new Error(t+' contains ".value" child '+jt(r)+" in addition to actual children.")}},Jr=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.errorPrefix)(t,"values");if(!e||"object"!==typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var a=[];K(e,(function(t,e){var r=new It(t);if(Xr(i,e,Pt(n,r)),".priority"===kt(r)&&!Yr(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=Nt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!zr(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(xt);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&Mt(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},Zr=function(t,e,n){if(!n||void 0!==e){if(M(e))throw new Error((0,o.errorPrefix)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Yr(e))throw new Error((0,o.errorPrefix)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ti=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.errorPrefix)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},ei=function(t,e,n,r){if((!r||void 0!==n)&&!zr(n))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ni=function(t,e,n,r){if((!r||void 0!==n)&&!Qr(n))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ri=function(t,e){if(".info"===Et(e))throw new Error(t+" failed = Can't modify data under /.info/")},ii=function(t,e){var n=e.path.toString();if("string"!==typeof e.repoInfo.host||0===e.repoInfo.host.length||!zr(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Qr(t)}(n))throw new Error((0,o.errorPrefix)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},oi=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error((0,o.errorPrefix)(t,e)+"must be a boolean.")},ai=function(){this.eventLists_=[],this.recursionDepth_=0};function si(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||Dt(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function ui(t,e,n){si(t,n),li(t,(function(t){return Dt(t,e)}))}function ci(t,e,n){si(t,n),li(t,(function(t){return Mt(t,e)||Mt(e,t)}))}function li(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];if(i)e(i.path)?(hi(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}n&&(t.eventLists_=[]),t.recursionDepth_--}function hi(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();k&&P("event: "+n.toString()),Y(r)}}}var fi="repo_interrupt",pi=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ai,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=je(),this.transactionQueueTree_=new Mr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function di(t,e,n){if(t.stats_=ct(t.repoInfo_),t.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Le(t.repoInfo_,(function(e,n,r,i){yi(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return mi(t,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.stringify)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Kt(t.repoInfo_,e,(function(e,n,r,i){yi(t,e,n,r,i)}),(function(e){mi(t,e)}),(function(e){!function(t,e){K(e,(function(e,n){bi(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(t,e){var n=t.toString();return ut[n]||(ut[n]=e()),ut[n]}(t.repoInfo_,(function(){return new We(t.stats_,t.server_)})),t.infoData_=new Fe,t.infoSyncTree_=new ur({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=fr(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),bi(t,"connected",!1),t.serverSyncTree_=new ur({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);ci(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}function vi(t){var e=t.infoData_.getNode(new It(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function gi(t){return(e=(e={timestamp:vi(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function yi(t,e,n,r,i){t.dataUpdateCount++;var a=new It(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i)if(r){var u=(0,o.map)(n,(function(t){return ge(t)}));s=function(t,e,n,r){var i=Tr(t,r);if(i){var o=Er(i),a=o.path,s=o.queryId,u=Rt(a,e),c=an.fromObject(n);return Sr(t,a,new $e(He(s),u,c))}return[]}(t.serverSyncTree_,a,u,i)}else{var c=ge(n);s=function(t,e,n,r){var i=Tr(t,r);if(null!=i){var o=Er(i),a=o.path,s=o.queryId,u=Rt(a,e);return Sr(t,a,new Ye(He(s),u,n))}return[]}(t.serverSyncTree_,a,c,i)}else if(r){var l=(0,o.map)(n,(function(t){return ge(t)}));s=function(t,e,n){var r=an.fromObject(n);return yr(t,new $e({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,l)}else{var h=ge(n);s=fr(t.serverSyncTree_,a,h)}var f=a;s.length>0&&(f=Pi(t,a)),ci(t.eventQueue_,f,s)}function mi(t,e){bi(t,"connected",e),!1===e&&function(t){Ci(t,"onDisconnectEvents");var e=gi(t),n=je();Ve(t.onDisconnect_,Tt(),(function(r,i){var o=Rr(r,i,t.serverSyncTree_,e);Ue(n,r,o)}));var r=[];Ve(n,Tt(),(function(e,n){r=r.concat(fr(t.serverSyncTree_,e,n));var i=Mi(t,e);Pi(t,i)})),t.onDisconnect_=je(),ci(t.eventQueue_,Tt(),r)}(t)}function bi(t,e,n){var r=new It("/.info/"+e),i=ge(n);t.infoData_.updateSnapshot(r,i);var o=fr(t.infoSyncTree_,r,i);ci(t.eventQueue_,r,o)}function _i(t){return t.nextWriteId_++}function wi(t,e,n,r,i){Ci(t,"set",{path:e.toString(),value:n,priority:r});var o=gi(t),a=ge(n,r),s=vr(t.serverSyncTree_,e),u=xr(a,s,o),c=_i(t),l=cr(t.serverSyncTree_,e,u,c,!0);si(t.eventQueue_,l),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||D("set at "+e+" failed: "+n);var a=hr(t.serverSyncTree_,c,!o);ci(t.eventQueue_,e,a),ki(t,i,n,r)}));var h=Mi(t,e);Pi(t,h),ci(t.eventQueue_,h,[])}function Ii(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&qe(t.onDisconnect_,e),ki(t,n,r,i)}))}function Ti(t,e,n,r){var i=ge(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&Ue(t.onDisconnect_,e,i),ki(t,r,n,o)}))}function Ei(t,e,n){var r;r=".info"===Et(e._path)?pr(t.infoSyncTree_,e,n):pr(t.serverSyncTree_,e,n),ui(t.eventQueue_,e._path,r)}function Si(t){t.persistentConnection_&&t.persistentConnection_.interrupt(fi)}function Ci(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),P.apply(void 0,p([r],f(e)))}function ki(t,e,n,r){e&&Y((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function Ni(t,e,n){return vr(t.serverSyncTree_,e,n)||de.EMPTY_NODE}function Ai(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||Di(t,e),Fr(e)){var n=Ri(t,e);(0,o.assert)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=Ni(t,e,r),a=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];(0,o.assert)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=Rt(e,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=e;t.server_.put(f.toString(),h,(function(r){Ci(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(hr(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);Di(t,Lr(t.transactionQueueTree_,e)),Ai(t,t.transactionQueueTree_),ci(t.eventQueue_,e,i);for(s=0;s<o.length;s++)Y(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{D("transaction at "+f.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}Pi(t,e)}}),s)}(t,Br(e),n)}else Ur(e)&&qr(e,(function(e){Ai(t,e)}))}function Pi(t,e){var n=Oi(t,e),r=Br(n);return function(t,e,n){if(0===e.length)return;for(var r=[],i=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c,l=e[s],h=Rt(n,l.path),f=!1;if((0,o.assert)(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)f=!0,u=l.abortReason,i=i.concat(hr(t.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)f=!0,u="maxretry",i=i.concat(hr(t.serverSyncTree_,l.currentWriteId,!0));else{var p=Ni(t,l.path,a);l.currentInputSnapshot=p;var d=e[s].update(p.val());if(void 0!==d){Xr("transaction failed: Data returned ",d,l.path);var v=ge(d);"object"===typeof d&&null!=d&&(0,o.contains)(d,".priority")||(v=v.updatePriority(p.getPriority()));var g=l.currentWriteId,y=gi(t),m=xr(v,p,y);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=m,l.currentWriteId=_i(t),a.splice(a.indexOf(g),1),i=(i=i.concat(cr(t.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally))).concat(hr(t.serverSyncTree_,g,!0))}else f=!0,u="nodata",i=i.concat(hr(t.serverSyncTree_,l.currentWriteId,!0))}ci(t.eventQueue_,n,i),i=[],f&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===u?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(u),!1,null)}))))},u=0;u<e.length;u++)s(u);Di(t,t.transactionQueueTree_);for(u=0;u<r.length;u++)Y(r[u]);Ai(t,t.transactionQueueTree_)}(t,Ri(t,n),r),r}function Oi(t,e){var n,r=t.transactionQueueTree_;for(n=Et(e);null!==n&&void 0===Fr(r);)r=Lr(r,n),n=Et(e=Ct(e));return r}function Ri(t,e){var n=[];return xi(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function xi(t,e,n){var r=Fr(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);qr(e,(function(e){xi(t,e,n)}))}function Di(t,e){var n=Fr(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,jr(e,n.length>0?n:void 0)}qr(e,(function(e){Di(t,e)}))}function Mi(t,e){var n=Br(Oi(t,e)),r=Lr(t.transactionQueueTree_,e);return function(t,e,n){for(var r=n?t:t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){Li(t,e)})),Li(t,r),Vr(r,(function(e){Li(t,e)})),n}function Li(t,e){var n=Fr(e);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?((0,o.assert)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):((0,o.assert)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(hr(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));-1===a?jr(e,void 0):n.length=a+1,ci(t.eventQueue_,Br(e),i);for(s=0;s<r.length;s++)Y(r[s])}}var Fi=function(t,e){var n=ji(t),r=n.namespace;"firebase.com"===n.domain&&x(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||x("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&D("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new it(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new It(n.pathString)}},ji=function(t){var e="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"===typeof t){var c=t.indexOf("//");c>=0&&(s=t.substring(0,c-1),t=t.substring(c+2));var l=t.indexOf("/");-1===l&&(l=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(l,f)),l<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(l,f)));var p=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=h(t.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):D("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(c=e.indexOf(":"))>=0?(a="https"===s||"wss"===s,u=parseInt(e.substring(c+1),10)):c=e.length;var d=e.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in p&&(o=p.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},Ui=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.stringify)(this.snapshot.exportVal())},t}(),qi=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Vi=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Bi=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.Deferred;return Ii(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){ri("OnDisconnect.remove",this._path);var t=new o.Deferred;return Ti(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){ri("OnDisconnect.set",this._path),$r("OnDisconnect.set",t,this._path,!1);var e=new o.Deferred;return Ti(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){ri("OnDisconnect.setWithPriority",this._path),$r("OnDisconnect.setWithPriority",t,this._path,!1),Zr("OnDisconnect.setWithPriority",e,!1);var n=new o.Deferred;return function(t,e,n,r,i){var o=ge(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&Ue(t.onDisconnect_,e,o),ki(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){ri("OnDisconnect.update",this._path),Jr("OnDisconnect.update",t,this._path,!1);var e=new o.Deferred;return function(t,e,n,r){if((0,o.isEmpty)(n))return P("onDisconnect().update() called with empty data.  Don't do anything."),void ki(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&K(n,(function(n,r){var i=ge(r);Ue(t.onDisconnect_,Pt(e,n),i)})),ki(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),Ki=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return Ot(this._path)?null:kt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new zi(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Me(this._queryParams),e=V(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Me(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,o.getModularInstance)(e))instanceof t))return!1;var n=this._repo===e._repo,r=Dt(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function Wi(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hi(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===zt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==L)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==F)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===ue){if(null!=e&&!Yr(e)||null!=n&&!Yr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.assert)(t.getIndex()instanceof ye||t.getIndex()===me,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Gi(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var zi=function(t){function e(e,n){return t.call(this,e,n,new Pe,!1)||this}return s(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=At(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(Ki),Qi=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new It(e),r=Xi(this.ref,e);return new t(this._node.getChild(n),r,ue)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,Xi(n.ref,r),ue))}))},t.prototype.hasChild=function(t){var e=new It(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Yi(t,e){return(t=(0,o.getModularInstance)(t))._checkNotDeleted("ref"),void 0!==e?Xi(t._root,e):t._root}function $i(t,e){(t=(0,o.getModularInstance)(t))._checkNotDeleted("refFromURL");var n=Fi(e,t._repo.repoInfo_.nodeAdmin);ii("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||x("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Yi(t,n.path.toString())}function Xi(t,e){var n,r,i,a;return null===Et((t=(0,o.getModularInstance)(t))._path)?(n="child",r="path",a=!1,(i=e)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),ni(n,r,i,a)):ni("child","path",e,!1),new zi(t._repo,Pt(t._path,e))}function Ji(t,e){t=(0,o.getModularInstance)(t),ri("push",t._path),$r("push",e,t._path,!0);var n,r=vi(t._repo),i=_e(r),a=Xi(t,i),s=Xi(t,i);return n=null!=e?to(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Zi(t){return ri("remove",t._path),to(t,null)}function to(t,e){t=(0,o.getModularInstance)(t),ri("set",t._path),$r("set",e,t._path,!1);var n=new o.Deferred;return wi(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function eo(t,e){t=(0,o.getModularInstance)(t),ri("setPriority",t._path),Zr("setPriority",e,!1);var n=new o.Deferred;return wi(t._repo,Pt(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function no(t,e,n){if(ri("setWithPriority",t._path),$r("setWithPriority",e,t._path,!1),Zr("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.Deferred;return wi(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function ro(t,e){Jr("update",e,t._path,!1);var n=new o.Deferred;return function(t,e,n,r){Ci(t,"update",{path:e.toString(),value:n});var i=!0,o=gi(t),a={};if(K(n,(function(n,r){i=!1,a[n]=Rr(Pt(e,n),ge(r),t.serverSyncTree_,o)})),i)P("update() called with empty data.  Don't do anything."),ki(0,r,"ok",void 0);else{var s=_i(t),u=lr(t.serverSyncTree_,e,a,s);si(t.eventQueue_,u),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||D("update at "+e+" failed: "+n);var a=hr(t.serverSyncTree_,s,!o),u=a.length>0?Pi(t,e):e;ci(t.eventQueue_,u,a),ki(0,r,n,i)})),K(n,(function(n){var r=Mi(t,Pt(e,n));Pi(t,r)})),ci(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function io(t){return function(t,e){var n=gr(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=ge(n).withIndex(e._queryParams.getIndex()),i=fr(t.serverSyncTree_,e._path,r);return ui(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return Ci(t,"get for query "+(0,o.stringify)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=(0,o.getModularInstance)(t))._repo,t).then((function(e){return new Qi(e,new zi(t._repo,t._path),t._queryParams.getIndex())}))}var oo=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Ui("value",this,new Qi(t.snapshotNode,new zi(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new qi(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),ao=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new qi(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.assert)(null!=t.childName,"Child events should have a childName.");var n=Xi(new zi(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Ui(t.type,this,new Qi(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function so(t,e,n,r,i){var o;if("object"===typeof r&&(o=void 0,i=r),"function"===typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){Ei(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Vi(n,o||void 0),c="value"===e?new oo(u):new ao(e,u);return function(t,e,n){var r;r=".info"===Et(e._path)?dr(t.infoSyncTree_,e,n):dr(t.serverSyncTree_,e,n),ui(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return Ei(t._repo,t,c)}}function uo(t,e,n,r){return so(t,"value",e,n,r)}function co(t,e,n,r){return so(t,"child_added",e,n,r)}function lo(t,e,n,r){return so(t,"child_changed",e,n,r)}function ho(t,e,n,r){return so(t,"child_moved",e,n,r)}function fo(t,e,n,r){return so(t,"child_removed",e,n,r)}function po(t,e,n){var r=null,i=n?new Vi(n):null;"value"===e?r=new oo(i):e&&(r=new ao(e,i)),Ei(t._repo,t,r)}var vo=function(){},go=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){$r("endAt",this._value,t._path,!0);var e=Re(t._queryParams,this._value,this._key);if(Gi(e),Hi(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ki(t._repo,t._path,e,t._orderByCalled)},e}(vo);function yo(t,e){return ei("endAt","key",e,!0),new go(t,e)}var mo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){$r("endBefore",this._value,t._path,!1);var e=function(t,e,n){var r;return t.index_===zt?("string"===typeof e&&(e=Ie(e)),r=Re(t,e,n)):r=Re(t,e,null==n?L:Ie(n)),r.endBeforeSet_=!0,r}(t._queryParams,this._value,this._key);if(Gi(e),Hi(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ki(t._repo,t._path,e,t._orderByCalled)},e}(vo);function bo(t,e){return ei("endBefore","key",e,!0),new mo(t,e)}var _o=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){$r("startAt",this._value,t._path,!0);var e=Oe(t._queryParams,this._value,this._key);if(Gi(e),Hi(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ki(t._repo,t._path,e,t._orderByCalled)},e}(vo);function wo(t,e){return void 0===t&&(t=null),ei("startAt","key",e,!0),new _o(t,e)}var Io=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){$r("startAfter",this._value,t._path,!1);var e=function(t,e,n){var r;t.index_===zt?("string"===typeof e&&(e=we(e)),r=Oe(t,e,n)):r=Oe(t,e,null==n?F:we(n));return r.startAfterSet_=!0,r}(t._queryParams,this._value,this._key);if(Gi(e),Hi(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ki(t._repo,t._path,e,t._orderByCalled)},e}(vo);function To(t,e){return ei("startAfter","key",e,!0),new Io(t,e)}var Eo=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return s(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ki(t._repo,t._path,function(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(t._queryParams,this._limit),t._orderByCalled)},e}(vo);function So(t){if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Eo(t)}var Co=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return s(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ki(t._repo,t._path,function(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(t._queryParams,this._limit),t._orderByCalled)},e}(vo);function ko(t){if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Co(t)}var No=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return s(e,t),e.prototype._apply=function(t){Wi(t,"orderByChild");var e=new It(this._path);if(Ot(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new ye(e),r=xe(t._queryParams,n);return Hi(r),new Ki(t._repo,t._path,r,!0)},e}(vo);function Ao(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ni("orderByChild","path",t,!1),new No(t)}var Po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){Wi(t,"orderByKey");var e=xe(t._queryParams,zt);return Hi(e),new Ki(t._repo,t._path,e,!0)},e}(vo);function Oo(){return new Po}var Ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){Wi(t,"orderByPriority");var e=xe(t._queryParams,ue);return Hi(e),new Ki(t._repo,t._path,e,!0)},e}(vo);function xo(){return new Ro}var Do=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){Wi(t,"orderByValue");var e=xe(t._queryParams,me);return Hi(e),new Ki(t._repo,t._path,e,!0)},e}(vo);function Mo(){return new Do}var Lo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){if($r("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new go(this._value,this._key)._apply(new _o(this._value,this._key)._apply(t))},e}(vo);function Fo(t,e){return ei("equalTo","key",e,!0),new Lo(t,e)}function jo(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=(0,o.getModularInstance)(t);try{for(var s=h(r),u=s.next();!u.done;u=s.next()){var c=u.value;a=c._apply(a)}}catch(l){e={error:l}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return a}!function(t){(0,o.assert)(!Bn,"__referenceConstructor has already been defined"),Bn=t}(zi),function(t){(0,o.assert)(!Yn,"__referenceConstructor has already been defined"),Yn=t}(zi);var Uo={},qo=!1;function Vo(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||x("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),P("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=Fi(o,i),u=s.repoInfo,c=void 0;"undefined"!==typeof v&&(c=v.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=Fi(o,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new Z(Z.OWNER):new J(t.name,t.options,e);ii("Invalid Firebase Database URL",s),Ot(s.path)||x("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n,r){var i=Uo[e.name];i||(i={},Uo[e.name]=i);var o=i[t.toURLString()];o&&x("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new pi(t,qo,n,r),i[t.toURLString()]=o,o}(u,t,l,new X(t.name,n));return new Bo(h,t)}var Bo=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(di(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new zi(this._repo,Tt())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){return this._checkNotDeleted("delete"),function(t,e){var n=Uo[e];n&&n[t.key]===t||x("Database "+e+"("+t.repoInfo_+") has already been deleted."),Si(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&x("Cannot call "+t+" on a deleted database.")},t}();function Ko(t,e,n,r){void 0===r&&(r={}),(t=(0,o.getModularInstance)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&x("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&x('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Z(Z.OWNER);else if(r.mockUserToken){var s=(0,o.createMockUserToken)(r.mockUserToken,t.app.options.projectId);a=new Z(s)}!function(t,e,n,r){t.repoInfo_=new it(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(i,e,n,a)}function Wo(t){(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOffline"),Si(t._repo)}function Ho(t){var e;(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(fi)}var Go={".sv":"timestamp"};var zo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Qo(t,e,n){var r;if(t=(0,o.getModularInstance)(t),ri("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,a=new o.Deferred,s=uo(t,(function(){}));return function(t,e,n,r,i,a){Ci(t,"transaction on "+e);var s={path:e,update:n,onComplete:r,status:null,order:E(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=Ni(t,e,void 0);s.currentInputSnapshot=u;var c=s.update(u.val());if(void 0===c)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Xr("transaction failed: Data returned ",c,s.path),s.status=0;var l=Lr(t.transactionQueueTree_,e),h=Fr(l)||[];h.push(s),jr(l,h);var f=void 0;"object"===typeof c&&null!==c&&(0,o.contains)(c,".priority")?(f=(0,o.safeGet)(c,".priority"),(0,o.assert)(Yr(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(vr(t.serverSyncTree_,e)||de.EMPTY_NODE).getPriority().val();var p=gi(t),d=ge(c,f),v=xr(d,u,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=v,s.currentWriteId=_i(t);var g=cr(t.serverSyncTree_,e,v,s.currentWriteId,s.applyLocally);ci(t.eventQueue_,e,g),Ai(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(function(e,n,r){var i=null;e?a.reject(e):(i=new Qi(r,new zi(t._repo,t._path),ue),a.resolve(new zo(n,i)))}),s,i),a.promise}var Yo=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.validateArgCount)("OnDisconnect.set",1,2,arguments.length),(0,o.validateCallback)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.validateArgCount)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,D("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.validateCallback)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),$o=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Xo=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.validateArgCount)("DataSnapshot.child",0,1,arguments.length),e=String(e),ni("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),ni("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),(0,o.validateCallback)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),new Zo(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Jo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var a,s=this;(0,o.validateArgCount)("Query.on",2,4,arguments.length),(0,o.validateCallback)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,i),c=function(t,e){n.call(u.context,new Xo(s.database,t),e)};c.userCallback=n,c.context=u.context;var l=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return uo(this._delegate,c,l),n;case"child_added":return co(this._delegate,c,l),n;case"child_removed":return fo(this._delegate,c,l),n;case"child_changed":return lo(this._delegate,c,l),n;case"child_moved":return ho(this._delegate,c,l),n;default:throw new Error((0,o.errorPrefix)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.validateArgCount)("Query.off",0,3,arguments.length),ti("Query.off",t,!0),(0,o.validateCallback)("Query.off","callback",e,!0),(0,o.validateContextObject)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,po(this._delegate,t,r)}else po(this._delegate,t)},t.prototype.get=function(){var t=this;return io(this._delegate).then((function(e){return new Xo(t.database,e)}))},t.prototype.once=function(e,n,r,i){var a=this;(0,o.validateArgCount)("Query.once",1,4,arguments.length),(0,o.validateCallback)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=new o.Deferred,c=function(t,e){var r=new Xo(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":uo(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":co(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":fo(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":lo(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":ho(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error((0,o.errorPrefix)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return(0,o.validateArgCount)("Query.limitToFirst",1,1,arguments.length),new t(this.database,jo(this._delegate,So(e)))},t.prototype.limitToLast=function(e){return(0,o.validateArgCount)("Query.limitToLast",1,1,arguments.length),new t(this.database,jo(this._delegate,ko(e)))},t.prototype.orderByChild=function(e){return(0,o.validateArgCount)("Query.orderByChild",1,1,arguments.length),new t(this.database,jo(this._delegate,Ao(e)))},t.prototype.orderByKey=function(){return(0,o.validateArgCount)("Query.orderByKey",0,0,arguments.length),new t(this.database,jo(this._delegate,Oo()))},t.prototype.orderByPriority=function(){return(0,o.validateArgCount)("Query.orderByPriority",0,0,arguments.length),new t(this.database,jo(this._delegate,xo()))},t.prototype.orderByValue=function(){return(0,o.validateArgCount)("Query.orderByValue",0,0,arguments.length),new t(this.database,jo(this._delegate,Mo()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAt",0,2,arguments.length),new t(this.database,jo(this._delegate,wo(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAfter",0,2,arguments.length),new t(this.database,jo(this._delegate,To(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endAt",0,2,arguments.length),new t(this.database,jo(this._delegate,yo(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endBefore",0,2,arguments.length),new t(this.database,jo(this._delegate,bo(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.validateArgCount)("Query.equalTo",1,2,arguments.length),new t(this.database,jo(this._delegate,Fo(e,n)))},t.prototype.toString=function(){return(0,o.validateArgCount)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.validateArgCount)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.validateCallback)(t,"cancel",r.cancel,!0),r.context=n,(0,o.validateContextObject)(t,"context",r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error((0,o.errorPrefix)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Zo(this.database,new zi(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Zo=function(t){function e(e,n){var r=t.call(this,e,new Ki(n._repo,n._path,new Pe,!1))||this;return r.database=e,r._delegate=n,r}return s(e,t),e.prototype.getKey=function(){return(0,o.validateArgCount)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.validateArgCount)("Reference.child",1,1,arguments.length),"number"===typeof t&&(t=String(t)),new e(this.database,Xi(this._delegate,t))},e.prototype.getParent=function(){(0,o.validateArgCount)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.validateArgCount)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.validateArgCount)("Reference.set",1,2,arguments.length),(0,o.validateCallback)("Reference.set","onComplete",e,!0);var n=to(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.validateArgCount)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,D("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ri("Reference.update",this._delegate._path),(0,o.validateCallback)("Reference.update","onComplete",e,!0);var i=ro(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("Reference.setWithPriority","onComplete",n,!0);var r=no(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.validateArgCount)("Reference.remove",0,1,arguments.length),(0,o.validateCallback)("Reference.remove","onComplete",t,!0);var e=Zi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.validateArgCount)("Reference.transaction",1,3,arguments.length),(0,o.validateCallback)("Reference.transaction","transactionUpdate",t,!1),(0,o.validateCallback)("Reference.transaction","onComplete",e,!0),oi("Reference.transaction","applyLocally",n,!0);var i=Qo(this._delegate,t,{applyLocally:n}).then((function(t){return new $o(t.committed,new Xo(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.validateArgCount)("Reference.setPriority",1,2,arguments.length),(0,o.validateCallback)("Reference.setPriority","onComplete",e,!0);var n=eo(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.validateArgCount)("Reference.push",0,2,arguments.length),(0,o.validateCallback)("Reference.push","onComplete",n,!0);var i=Ji(this._delegate,t),a=i.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return ri("Reference.onDisconnect",this._delegate._path),new Yo(new Bi(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Jo),ta=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),Ko(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,o.validateArgCount)("database.ref",0,1,arguments.length),t instanceof Zo){var e=$i(this._delegate,t.toString());return new Zo(this,e)}e=Yi(this._delegate,t);return new Zo(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.validateArgCount)(e,1,1,arguments.length);var n=$i(this._delegate,t);return new Zo(this,n)},t.prototype.goOffline=function(){return(0,o.validateArgCount)("database.goOffline",0,0,arguments.length),Wo(this._delegate)},t.prototype.goOnline=function(){return(0,o.validateArgCount)("database.goOnline",0,0,arguments.length),Ho(this._delegate)},t.ServerValue={TIMESTAMP:Go,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}();var ea=Object.freeze({__proto__:null,forceLongPolling:function(){gt.forceDisallow(),pt.forceAllow()},forceWebSockets:function(){pt.forceDisallow()},isWebSocketsAvailable:function(){return gt.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!==typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Ke(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);K(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n,r;t.stats_.incrementCounter(e),n=t.statsReporter_,r=e,n.statsToReport_[r]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,a=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;y(r);var c=new i.Provider("auth-internal",new i.ComponentContainer("database-standalone"));return c.setComponent(new i.Component("auth-internal",(function(){return o}),"PRIVATE")),{instance:new ta(Vo(e,c,void 0,n,u),e),namespace:a}}}),na=Kt;Kt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Kt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var ra=mt,ia=it,oa=Object.freeze({__proto__:null,DataConnection:na,RealTimeConnection:ra,hijackHash:function(t){var e=Kt.prototype.put;return Kt.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Kt.prototype.put=e}},ConnectionTarget:ia,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){qo=t}(t)}}),aa=ta.ServerValue;!function(e){y(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.Component("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new ta(Vo(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Zo,Query:Jo,Database:ta,DataSnapshot:Xo,enableLogging:A,INTERNAL:ea,ServerValue:aa,TEST_ACCESS:oa}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.10.7"),(0,o.isNodeSdk)()&&(t.exports=n)}(r.default)},4594:function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(e),n.d(e,{LogLevel:function(){return o},Logger:function(){return h},setLogLevel:function(){return f},setUserLogHandler:function(){return p}});var o,a=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"===typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){a.forEach((function(e){e.setLogLevel(t)}))}function p(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"===typeof t)return t;if("number"===typeof t||"boolean"===typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!==r&&void 0!==r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++){n(i[r])}}},8448:function(t,e,n){"use strict";n.r(e),n.d(e,{CONSTANTS:function(){return o},Deferred:function(){return d},ErrorFactory:function(){return R},FirebaseError:function(){return O},MAX_VALUE_MILLIS:function(){return st},RANDOM_FACTOR:function(){return ut},Sha1:function(){return Y},areCookiesEnabled:function(){return A},assert:function(){return a},assertionError:function(){return s},async:function(){return J},base64:function(){return c},base64Decode:function(){return h},base64Encode:function(){return l},calculateBackoffMillis:function(){return ct},contains:function(){return B},createMockUserToken:function(){return v},createSubscribe:function(){return $},decode:function(){return F},deepCopy:function(){return f},deepExtend:function(){return p},errorPrefix:function(){return et},extractQuerystring:function(){return Q},getGlobal:function(){return P},getModularInstance:function(){return ht},getUA:function(){return g},isAdmin:function(){return V},isBrowser:function(){return b},isBrowserExtension:function(){return _},isElectron:function(){return I},isEmpty:function(){return W},isIE:function(){return T},isIndexedDBAvailable:function(){return k},isMobileCordova:function(){return y},isNode:function(){return m},isNodeSdk:function(){return S},isReactNative:function(){return w},isSafari:function(){return C},isUWP:function(){return E},isValidFormat:function(){return q},isValidTimestamp:function(){return j},issuedAtTime:function(){return U},jsonEval:function(){return M},map:function(){return H},ordinal:function(){return lt},querystring:function(){return G},querystringDecode:function(){return z},safeGet:function(){return K},stringLength:function(){return at},stringToByteArray:function(){return ot},stringify:function(){return L},validateArgCount:function(){return tt},validateCallback:function(){return rt},validateContextObject:function(){return it},validateIndexedDBOpenable:function(){return N},validateNamespace:function(){return nt}});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create;Object.create;var o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},a=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},u=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){var e=u(t);return c.encodeByteArray(e,!0)},h=function(t){try{return c.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=p(t[n],e[n]));return t}var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function v(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=i({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[c.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),c.encodeString(JSON.stringify(a),!1),""].join(".")}function g(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function m(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function b(){return"object"===typeof self&&self.self===self}function _(){var t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function I(){return g().indexOf("Electron/")>=0}function T(){var t=g();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E(){return g().indexOf("MSAppHost/")>=0}function S(){return!0===o.NODE_CLIENT||!0===o.NODE_ADMIN}function C(){return!m()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){return"indexedDB"in self&&null!=indexedDB}function N(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(o){e(o)}}))}function A(){return!(!navigator||!navigator.cookieEnabled)}function P(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}var O=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,R.prototype.create),o}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),R=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?x(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new O(i,s,r);return u},t}();function x(t,e){return t.replace(D,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var D=/\{\$([^}]+)}/g;function M(t){return JSON.parse(t)}function L(t){return JSON.stringify(t)}var F=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=M(h(o[0])||""),n=M(h(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}},j=function(t){var e=F(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"===typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},U=function(t){var e=F(t).claims;return"object"===typeof e&&e.hasOwnProperty("iat")?e.iat:null},q=function(t){var e=F(t).claims;return!!e&&"object"===typeof e&&e.hasOwnProperty("iat")},V=function(t){var e=F(t).claims;return"object"===typeof e&&!0===e.admin};function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function K(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function W(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function H(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function G(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function z(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[0],i=n[1];e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function Q(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var Y=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function $(t,e){var n=new X(t,e);return n.subscribe.bind(n)}var X=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=Z),void 0===r.error&&(r.error=Z),void 0===r.complete&&(r.complete=Z);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function J(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function Z(){}var tt=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function et(t,e){return t+" failed: "+e+" argument "}function nt(t,e,n){if((!n||e)&&"string"!==typeof e)throw new Error(et(t,"namespace")+"must be a valid firebase namespace.")}function rt(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(et(t,e)+"must be a valid function.")}function it(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(et(t,e)+"must be a valid context object.")}var ot=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,a(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},at=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},st=144e5,ut=.5;function ct(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(ut*r*(Math.random()-.5)*2);return Math.min(st,r+i)}function lt(t){return Number.isFinite(t)?t+function(t){var e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";var n=t%10;if(1===n)return"st";if(2===n)return"nd";if(3===n)return"rd";return"th"}(t):""+t}function ht(t){return t&&t._delegate?t._delegate:t}},8278:function(t,e,n){"use strict";n.d(e,{Z:function(){return r.default}});var r=n(6983);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,n){if(n){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(n=n(o=r[t=t[t.length-1]]))!=o&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(b){this.f(b)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(b){n.reject(b)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(qn){o(qn)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Ra(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Ra(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Ra(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,l=null;function h(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function p(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function d(t){var e=p(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==p(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function y(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++_)}var m="closure_uid_"+(1e9*Math.random()>>>0),_=0;function w(t,e,n){return t.call.apply(t.bind,arguments)}function I(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function T(t,e,n){return(T=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:I).apply(null,arguments)}function E(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var S=Date.now;function C(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function k(t){return t}function N(t,e,n){this.code=O+t,this.message=e||R[t]||"",this.a=n||null}function A(t){var e=t&&t.code;return e?new N(e.substring(O.length),t.message,t.serverResponse):null}C(N,Error),N.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},N.prototype.toJSON=function(){return this.w()};var P,O="auth/",R={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},x={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function D(t){for(var e in x)if(x[e].id===t)return{firebaseEndpoint:(t=x[e]).Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function M(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function F(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");L.call(this,n+t[r])}function j(t,e){throw new F("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function U(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function q(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function V(){this.b=this.a=null}P=D("__EID__")?"__EID__":void 0,C(L,Error),L.prototype.name="CustomError",C(F,L),F.prototype.name="AssertionError",U.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var B=new U((function(){return new W}),(function(t){t.reset()}));function K(){var t=we,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function W(){this.next=this.b=this.a=null}V.prototype.add=function(t,e){var n=B.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},W.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},W.prototype.reset=function(){this.next=this.b=this.a=null};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var z=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"===typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},Q=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"===typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},Y=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function $(t,e){return 0<=H(t,e)}function X(t,e){var n;return(n=0<=(e=H(t,e)))&&Array.prototype.splice.call(t,e,1),n}function J(t,e){!function(t,e){for(var n="string"===typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function Z(t){return Array.prototype.concat.apply([],arguments)}function tt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var et,nt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},rt=/&/g,it=/</g,ot=/>/g,at=/"/g,st=/'/g,ut=/\x00/g,ct=/[\x00&<>"']/;function lt(t,e){return-1!=t.indexOf(e)}function ht(t,e){return t<e?-1:t>e?1:0}t:{var ft=u.navigator;if(ft){var pt=ft.userAgent;if(pt){et=pt;break t}}et=""}function dt(t){return lt(et,t)}function vt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function gt(t){for(var e in t)return!1;return!0}function yt(t){var e,n={};for(e in t)n[e]=t[e];return n}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<mt.length;o++)n=mt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _t(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&"undefined"!=typeof i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;j("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function wt(t,e){this.a=t===St&&e||"",this.b=Et}function It(t){return t instanceof wt&&t.constructor===wt&&t.b===Et?t.a:(j("expected object of type Const, got '"+t+"'"),"type_error:Const")}wt.prototype.ta=!0,wt.prototype.sa=function(){return this.a},wt.prototype.toString=function(){return"Const{"+this.a+"}"};var Tt,Et={},St={};function Ct(){if(void 0===Tt){var t=null,e=u.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:k,createScript:k,createScriptURL:k})}catch(n){u.console&&u.console.error(n.message)}Tt=t}else Tt=t}return Tt}function kt(t,e){this.a=e===Rt?t:""}function Nt(t){return t instanceof kt&&t.constructor===kt?t.a:(j("expected object of type TrustedResourceUrl, got '"+t+"' of type "+p(t)),"type_error:TrustedResourceUrl")}function At(t,e){var n=It(t);if(!Ot.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=Ct();return new kt(t=e?e.createScriptURL(t):t,Rt)}(t=n.replace(Pt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof wt?It(t):encodeURIComponent(String(t))})))}kt.prototype.ta=!0,kt.prototype.sa=function(){return this.a.toString()},kt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Pt=/%{(\w+)}/g,Ot=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Rt={};function xt(t,e){this.a=e===qt?t:""}function Dt(t){return t instanceof xt&&t.constructor===xt?t.a:(j("expected object of type SafeUrl, got '"+t+"' of type "+p(t)),"type_error:SafeUrl")}xt.prototype.ta=!0,xt.prototype.sa=function(){return this.a.toString()},xt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Mt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Ft=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function jt(t){if(t instanceof xt)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),Ft.test(t))t=new xt(t,qt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&Mt.test(e[1])?new xt(t,qt):null}return t}function Ut(t){return t instanceof xt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),Ft.test(t)||(t="about:invalid#zClosurez"),new xt(t,qt))}var qt={},Vt=new xt("about:invalid#zClosurez",qt);function Bt(t,e,n){this.a=n===Kt?t:""}Bt.prototype.ta=!0,Bt.prototype.sa=function(){return this.a.toString()},Bt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Kt={};function Wt(t,e,n,r){return t=t instanceof xt?t:Ut(t),e=e||u,n=n instanceof wt?It(n):n||"",e.open(Dt(t),n,r,void 0)}function Ht(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Gt(t){return ct.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(rt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(it,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(ot,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(at,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(st,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(ut,"&#0;"))),t}function zt(t){return zt[" "](t),t}zt[" "]=f;var Qt,Yt=dt("Opera"),$t=dt("Trident")||dt("MSIE"),Xt=dt("Edge"),Jt=Xt||$t,Zt=dt("Gecko")&&!(lt(et.toLowerCase(),"webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),te=lt(et.toLowerCase(),"webkit")&&!dt("Edge");function ee(){var t=u.document;return t?t.documentMode:void 0}t:{var ne="",re=function(){var t=et;return Zt?/rv:([^\);]+)(\)|;)/.exec(t):Xt?/Edge\/([\d\.]+)/.exec(t):$t?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):te?/WebKit\/(\S+)/.exec(t):Yt?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(re&&(ne=re?re[1]:""),$t){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){Qt=String(ie);break t}}Qt=ne}var oe,ae={};function se(t){return function(t,e){var n=ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=nt(String(Qt)).split("."),r=nt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ht(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ht(0==a[2].length,0==s[2].length)||ht(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}if(u.document&&$t){var ue=ee();oe=ue||(parseInt(Qt,10)||void 0)}else oe=void 0;var ce=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(da){}var le=!$t||9<=Number(ce);function he(t){var e=document;return"string"===typeof t?e.getElementById(t):t}function fe(t,e){vt(e,(function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ve.hasOwnProperty(n)?t.setAttribute(ve[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var pe,de,ve={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ge(t,e,n){function r(n){n&&e.appendChild("string"===typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!d(o)||g(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(g(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){a="function"==typeof o.item;break t}}a=!1}G(a?tt(o):o,r)}}}function ye(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function me(t){u.setTimeout((function(){throw t}),0)}function be(t,e){de||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);de=function(){t.then(Ie)}}else de=function(){var t=Ie;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!dt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(pe||(pe=function(){var t=u.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(t=function(){var t=ye(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=T((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!dt("Trident")&&!dt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),pe(t)):u.setImmediate(t)}}(),_e||(de(),_e=!0),we.add(t,e)}var _e=!1,we=new V;function Ie(){for(var t;t=K();){try{t.a.call(t.b)}catch(e){me(e)}q(B,t)}_e=!1}function Te(t,e){if(this.a=Ee,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Fe(n,Se,t)}),(function(t){if(!(t instanceof We))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(Hp){}Fe(n,Ce,t)}))}catch(r){Fe(this,Ce,r)}}var Ee=0,Se=2,Ce=3;function ke(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ke.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ne=new U((function(){return new ke}),(function(t){t.reset()}));function Ae(t,e,n){var r=Ne.get();return r.g=t,r.b=e,r.f=n,r}function Pe(t){if(t instanceof Te)return t;var e=new Te(f);return Fe(e,Se,t),e}function Oe(t){return new Te((function(e,n){n(t)}))}function Re(t,e,n){je(t,e,n,null)||be(E(e,t))}function xe(t){return new Te((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Re(t[o],E(i,o,!0),E(i,o,!1));else e(r)}))}function De(t,e){if(t.a==Ee)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Ee&&1==r?De(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):qe(n),Ve(n,i,Ce,e)))}t.c=null}else Fe(t,Ce,e)}function Me(t,e){t.b||t.a!=Se&&t.a!=Ce||Ue(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,r){var i=Ae(null,null,null);return i.a=new Te((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(b){o(b)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof We?o(e):t(i)}catch(b){o(b)}}:o})),i.a.c=t,Me(t,i),i.a}function Fe(t,e,n){t.a==Ee&&(t===n&&(e=Ce,n=new TypeError("Promise cannot resolve to itself")),t.a=1,je(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Ue(t),e!=Ce||n instanceof We||function(t,e){t.g=!0,be((function(){t.g&&Ke.call(null,e)}))}(t,n)))}function je(t,e,n,r){if(t instanceof Te)return Me(t,Ae(e||f,n||null,r)),!0;if(M(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(u){o(u)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Ue(t){t.h||(t.h=!0,be(t.gc,t))}function qe(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Ve(t,e,n,r){if(n==Ce&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Be(e,n,r);else try{e.c?e.g.call(e.f):Be(e,n,r)}catch(Hp){Ke.call(null,Hp)}q(Ne,e)}function Be(t,e,n){e==Se?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Te.prototype.then=function(t,e,n){return Le(this,v(t)?t:null,v(e)?e:null,n)},Te.prototype.$goog_Thenable=!0,(t=Te.prototype).oa=function(t,e){return(t=Ae(t,t,e)).c=!0,Me(this,t),this},t.o=function(t,e){return Le(this,null,t,e)},t.cancel=function(t){if(this.a==Ee){var e=new We(t);be((function(){De(this,e)}),this)}},t.$c=function(t){this.a=Ee,Fe(this,Se,t)},t.ad=function(t){this.a=Ee,Fe(this,Ce,t)},t.gc=function(){for(var t;t=qe(this);)Ve(this,t,this.a,this.i);this.h=!1};var Ke=me;function We(t){L.call(this,t)}function He(){0!=Ge&&(ze[y(this)]=this),this.ya=this.ya,this.pa=this.pa}C(We,L),We.prototype.name="cancel";var Ge=0,ze={};function Qe(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=Ge)){var e=y(t);if(0!=Ge&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[e]}}He.prototype.ya=!1,He.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Ye=Object.freeze||function(t){return t},$e=!$t||9<=Number(ce),Xe=$t&&!se("9"),Je=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(n){}return t}();function Ze(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function tn(t,e){if(Ze.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Zt){t:{try{zt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:en[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ze.prototype.preventDefault=function(){this.defaultPrevented=!0},C(tn,Ze);var en=Ye({2:"touch",3:"pen",4:"mouse"});tn.prototype.preventDefault=function(){tn.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},tn.prototype.g=function(){return this.a};var nn="closure_listenable_"+(1e6*Math.random()|0),rn=0;function on(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++rn,this.wa=this.Qa=!1}function an(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function sn(t){this.src=t,this.a={},this.b=0}function un(t,e){var n=e.type;n in t.a&&X(t.a[n],e)&&(an(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function cn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==r)return i}return-1}sn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=cn(t,e,r,i);return-1<a?(e=t[a],n||(e.Qa=!1)):((e=new on(e,this.src,o,!!r,i)).Qa=n,t.push(e)),e};var ln="closure_lm_"+(1e6*Math.random()|0),hn={};function fn(t,e,n,r,i){if(r&&r.once)dn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)fn(t,e[o],n,r,i);else n=Tn(n),t&&t[nn]?Sn(t,e,n,g(r)?!!r.capture:!!r,i):pn(t,e,n,!1,r,i)}function pn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=g(i)?!!i.capture:!!i,s=wn(t);if(s||(t[ln]=s=new sn(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=_n,e=$e?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Je||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(yn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else n=Tn(n),t&&t[nn]?Cn(t,e,n,g(r)?!!r.capture:!!r,i):pn(t,e,n,!0,r,i)}function vn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)vn(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=Tn(n),t&&t[nn]?(t=t.v,(e=String(e).toString())in t.a&&(-1<(n=cn(o=t.a[e],n,r,i))&&(an(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=wn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=cn(e,n,r,i)),(n=-1<t?e[t]:null)&&gn(n))}function gn(t){if("number"!==typeof t&&t&&!t.wa){var e=t.src;if(e&&e[nn])un(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(yn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=wn(e))?(un(n,t),0==n.b&&(n.src=null,e[ln]=null)):an(t)}}}function yn(t){return t in hn?hn[t]:hn[t]="on"+t}function mn(t,e,n,r){var i=!0;if((t=wn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=bn(o,r),i=i&&!1!==o)}return i}function bn(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&gn(t),n.call(r,e)}function _n(t,e){if(t.wa)return!0;if(!$e){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new tn(r=e,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=mn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=mn(r[i],t,!1,e),n=n&&o}return n}return bn(t,new tn(e,this))}function wn(t){return(t=t[ln])instanceof sn?t:null}var In="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tn(t){return v(t)?t:(t[In]||(t[In]=function(e){return t.handleEvent(e)}),t[In])}function En(){He.call(this),this.v=new sn(this),this.bc=this,this.hb=null}function Sn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Cn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function kn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&un(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function Nn(t,e,n){if(v(t))n&&(t=T(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=T(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function An(t){var e=null;return new Te((function(n,r){-1==(e=Nn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw u.clearTimeout(e),t}))}function Pn(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"===typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function On(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(d(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Rn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Rn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function xn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Dn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Dn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}C(En,He),En.prototype[nn]=!0,En.prototype.addEventListener=function(t,e,n,r){fn(this,t,e,n,r)},En.prototype.removeEventListener=function(t,e,n,r){vn(this,t,e,n,r)},En.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"===typeof t)t=new Ze(t,n);else if(t instanceof Ze)t.target=t.target||n;else{var i=t;bt(t=new Ze(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=kn(a,r,!0,t)&&i}if(i=kn(a=t.b=n,r,!0,t)&&i,i=kn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=kn(a=t.b=e[o],r,!1,t)&&i;return i},En.prototype.Da=function(){if(En.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)an(n[r]);delete e.a[t],e.b--}}this.hb=null},(t=Rn.prototype).X=function(){xn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return xn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Dn(this.b,t)?this.b[t]:e},t.set=function(t,e){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Mn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Fn(this,t.c),this.l=t.l,this.a=t.a,jn(this,t.g),this.f=t.f,Un(this,or(t.b)),this.h=t.h):t&&(n=String(t).match(Mn))?(this.i=!!e,Fn(this,n[1]||"",!0),this.l=Hn(n[2]||""),this.a=Hn(n[3]||"",!0),jn(this,n[4]),this.f=Hn(n[5]||"",!0),Un(this,n[6]||"",!0),this.h=Hn(n[7]||"")):(this.i=!!e,this.b=new Zn(null,this.i))}function Fn(t,e,n){t.c=n?Hn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function jn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Un(t,e,n){e instanceof Zn?(t.b=e,function(t,e){e&&!t.f&&(tr(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(nr(this,e),ir(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Gn(e,Xn)),t.b=new Zn(e,t.i))}function Vn(t,e,n){t.b.set(e,n)}function Bn(t,e){return t.b.get(e)}function Kn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function Wn(t,e,n,r){var i=new Ln(null,void 0);return t&&Fn(i,t),e&&(i.a=e),n&&jn(i,n),r&&(i.f=r),i}function Hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Gn(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,zn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function zn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Gn(e,Qn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Gn(e,Qn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Gn(n,"/"==n.charAt(0)?$n:Yn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Gn(n,Jn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Fn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)jn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(lt(i,"./")||lt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?Un(e,or(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Qn=/[#\/\?@]/g,Yn=/[#\?:]/g,$n=/[#\?]/g,Xn=/[#\?@]/g,Jn=/#/g;function Zn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function tr(t){t.a||(t.a=new Rn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function er(t){var e=On(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new Zn(null,void 0);t=Pn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?ir(n,i,o):n.add(i,o)}return n}function nr(t,e){tr(t),e=ar(t,e),Dn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Dn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&xn(t)))}function rr(t,e){return tr(t),e=ar(t,e),Dn(t.a.b,e)}function ir(t,e,n){nr(t,e),0<n.length&&(t.c=null,t.a.set(ar(t,e),tt(n)),t.b+=n.length)}function or(t){var e=new Zn;return e.c=t.c,t.a&&(e.a=new Rn(t.a),e.b=t.b),e}function ar(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function sr(t){var e=[];return cr(new ur,t,e),e.join("")}function ur(){}function cr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),cr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&("function"!=typeof(o=e[r])&&(n.push(i),fr(r,n),n.push(":"),cr(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":fr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Zn.prototype).add=function(t,e){tr(this),this.c=null,t=ar(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){tr(this),this.a.forEach((function(n,r){G(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){tr(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.X=function(t){tr(this);var e=[];if("string"===typeof t)rr(this,t)&&(e=Z(e,this.a.get(ar(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=Z(e,t[n])}return e},t.set=function(t,e){return tr(this),this.c=null,rr(this,t=ar(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var lr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},hr=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function fr(t,e){e.push('"',t.replace(hr,(function(t){var e=lr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),lr[t]=e),e})),'"')}function pr(){var t=xr();return $t&&!!ce&&11==ce||/Edge\/\d+/.test(t)}function dr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function vr(t,e){e=e||u.window;var n="about:blank";t&&(n=Dt(jt(t)||Vt)),e.location.href=n}function gr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<gr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function yr(t){return!!((t=(t||xr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function mr(t){t=t||u.window;try{t.close()}catch(e){}}function br(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=xr().toLowerCase(),r&&(e.target=r,lt(n,"crios/")&&(e.target="_blank")),Pr(xr())==Nr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof xt?n:jt("undefined"!=typeof n.href?n.href:String(n))||Vt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((dt("iPhone")&&!dt("iPod")&&!dt("iPad")||dt("iPad")||dt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(_t(a=ye(document,"A"),"HTMLAnchorElement"),e=e instanceof xt?e:Ut(e),a.href=Dt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Wt("",r,n,a),t=Dt(e),a&&(Jt&&lt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Gt(t)+'">',t=new Bt(t=(r=Ct())?r.createHTML(t):t,null,Kt),r=a.document)&&(r.write(function(t){return t instanceof Bt&&t.constructor===Bt?t.a:(j("expected object of type SafeHtml, got '"+t+"' of type "+p(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Wt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var _r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wr=/^[^@]+@[^@]+$/;function Ir(){var t=null;return new Te((function(e){"complete"==u.document.readyState?e():(t=function(){e()},dn(window,"load",t))})).o((function(e){throw vn(window,"load",t),e}))}function Tr(t){return t=t||xr(),!("file:"!==jr()&&"ionic:"!==jr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Er(){var t=u.window;try{return!(!t||t==t.top)}catch(e){return!1}}function Sr(){return"undefined"!==typeof u.WorkerGlobalScope&&"function"===typeof u.importScripts}function Cr(){return r.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.default.INTERNAL.hasOwnProperty("node")?"Node":Sr()?"Worker":"Browser"}function kr(){var t=Cr();return"ReactNative"===t||"Node"===t}var Nr="Firefox",Ar="Chrome";function Pr(t){var e=t.toLowerCase();return lt(e,"opera/")||lt(e,"opr/")||lt(e,"opios/")?"Opera":lt(e,"iemobile")?"IEMobile":lt(e,"msie")||lt(e,"trident/")?"IE":lt(e,"edge/")?"Edge":lt(e,"firefox/")?Nr:lt(e,"silk/")?"Silk":lt(e,"blackberry")?"Blackberry":lt(e,"webos")?"Webos":!lt(e,"safari/")||lt(e,"chrome/")||lt(e,"crios/")||lt(e,"android")?!lt(e,"chrome/")&&!lt(e,"crios/")||lt(e,"edge/")?lt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Ar:"Safari"}var Or={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Rr(t,e){e=e||[];var n,r=[],i={};for(n in Or)i[Or[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Cr())?r=Pr(i=xr()):"Worker"===r&&(r=Pr(i=xr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function xr(){return u.navigator&&u.navigator.userAgent||""}function Dr(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Mr(){try{var t=u.localStorage,e=Kr();if(t)return t.setItem(e,"1"),t.removeItem(e),!pr()||!!u.indexedDB}catch(n){return Sr()&&!!u.indexedDB}return!1}function Lr(){return(Fr()||"chrome-extension:"===jr()||Tr())&&!kr()&&Mr()&&!Sr()}function Fr(){return"http:"===jr()||"https:"===jr()}function jr(){return u.location&&u.location.protocol||null}function Ur(t){return!yr(t=t||xr())&&Pr(t)!=Nr}function qr(t){return"undefined"===typeof t?null:sr(t)}function Vr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Br(t){if(null!==t)return JSON.parse(t)}function Kr(t){return t||Math.floor(1e9*Math.random()).toString()}function Wr(t){return"Safari"!=Pr(t=t||xr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Hr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Gr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=xr(),e=Cr(),this.b=yr(t)||"ReactNative"===e}function zr(){var t=u.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function Qr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Yr(){return!(!Dr("fireauth.oauthhelper",u)&&!Dr("fireauth.iframe",u))}Gr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!==typeof t.onLine||!Fr()&&"chrome-extension:"!==jr()&&"undefined"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var $r,Xr={};function Jr(t){Xr[t]||(Xr[t]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(t))}try{var Zr={};Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:2}),$r=2==Zr.abcd}catch(da){$r=!1}function ti(t,e,n){$r?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function ei(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&ti(t,n,e[n])}function ni(t){var e={};return ei(e,t),e}function ri(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)ti(e,n,ri(t[n]));return e}function ii(t){var e=t&&(t[ci]?"phone":null);if(!(e&&t&&t[ui]))throw new N("internal-error","Internal assert: invalid MultiFactorInfo object");ti(this,"uid",t[ui]),ti(this,"displayName",t[ai]||null);var n=null;t[si]&&(n=new Date(t[si]).toUTCString()),ti(this,"enrollmentTime",n),ti(this,"factorId",e)}function oi(t){try{var e=new li(t)}catch(n){e=null}return e}ii.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ai="displayName",si="enrolledAt",ui="mfaEnrollmentId",ci="phoneInfo";function li(t){ii.call(this,t),ti(this,"phoneNumber",t[ci])}function hi(t){var e={},n=t[vi],r=t[yi],i=t[mi];if(t=oi(t[gi]),!i||i!=pi&&i!=di&&!n||i==di&&!r||i==fi&&!t)throw Error("Invalid checkActionCode response!");i==di?(e[_i]=n||null,e[Ii]=n||null,e[bi]=r):(e[_i]=r||null,e[Ii]=r||null,e[bi]=n||null),e[wi]=t||null,ti(this,Ei,i),ti(this,Ti,ri(e))}C(li,ii),li.prototype.w=function(){var t=li.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var fi="REVERT_SECOND_FACTOR_ADDITION",pi="EMAIL_SIGNIN",di="VERIFY_AND_CHANGE_EMAIL",vi="email",gi="mfaInfo",yi="newEmail",mi="requestType",bi="email",_i="fromEmail",wi="multiFactorInfo",Ii="previousEmail",Ti="data",Ei="operation";function Si(t){var e=Bn(t=Kn(t),Ci)||null,n=Bn(t,ki)||null,r=Bn(t,Pi)||null;if(r=r&&Ri[r]||null,!e||!n||!r)throw new N("argument-error",Ci+", "+ki+"and "+Pi+" are required in a valid action code URL.");ei(this,{apiKey:e,operation:r,code:n,continueUrl:Bn(t,Ni)||null,languageCode:Bn(t,Ai)||null,tenantId:Bn(t,Oi)||null})}var Ci="apiKey",ki="oobCode",Ni="continueUrl",Ai="languageCode",Pi="mode",Oi="tenantId",Ri={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:fi,signIn:pi,verifyAndChangeEmail:di,verifyEmail:"VERIFY_EMAIL"};function xi(t){try{return new Si(t)}catch(e){return null}}function Di(t){var e=t[Ui];if("undefined"===typeof e)throw new N("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new N("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Mi];if(n&&"object"===typeof n){e=n[Bi];var r=n[qi];if(n=n[Vi],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new N("argument-error",qi+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new N("argument-error",Vi+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new N("argument-error",Bi+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new N("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new N("argument-error",Mi+" property must be a non null object when specified.");if(this.f=null,(e=t[ji])&&"object"===typeof e){if("string"===typeof(e=e[Ki])&&e.length)this.f=e;else if("undefined"!==typeof e)throw new N("argument-error",Ki+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new N("argument-error",ji+" property must be a non null object when specified.");if("undefined"!==typeof(e=t[Fi])&&"boolean"!==typeof e)throw new N("argument-error",Fi+" property must be a boolean when specified.");if(this.c=!!e,"undefined"!==typeof(t=t[Li])&&("string"!==typeof t||"string"===typeof t&&!t.length))throw new N("argument-error",Li+" property must be a non empty string when specified.");this.i=t||null}var Mi="android",Li="dynamicLinkDomain",Fi="handleCodeInApp",ji="iOS",Ui="url",qi="installApp",Vi="minimumVersion",Bi="packageName",Ki="bundleId";function Wi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Hi=null;function Gi(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Hi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Hi){Hi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Hi[o]&&(Hi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}function zi(t){var e=Yi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Qi(t){try{return new zi(t)}catch(e){return null}}function Yi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=Gi(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(b){}return null}zi.prototype.T=function(){return this.f},zi.prototype.l=function(){return this.c},zi.prototype.toString=function(){return this.h};var $i="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Xi=["client_id","response_type","scope","redirect_uri","state"],Ji={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:Xi},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:Xi},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:Xi},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:$i},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Zi(t){for(var e in Ji)if(Ji[e].fa==t)return Ji[e];return null}function to(t){var e={};e["facebook.com"]=oo,e["google.com"]=so,e["github.com"]=ao,e["twitter.com"]=uo;var n=t&&t[no];try{if(n)return e[n]?new e[n](t):new io(t);if("undefined"!==typeof t[eo])return new ro(t)}catch(r){}return null}var eo="idToken",no="providerId";function ro(t){var e=t[no];if(!e&&t[eo]){var n=Qi(t[eo]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),ti(this,"providerId",e),ti(this,"isNewUser",n)}function io(t){ro.call(this,t),ti(this,"profile",ri((t=Br(t.rawUserInfo||"{}"))||{}))}function oo(t){if(io.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ao(t){if(io.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");ti(this,"username",this.profile&&this.profile.login||null)}function so(t){if(io.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function uo(t){if(io.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");ti(this,"username",t.screenName||null)}function co(t){var e=Kn(t),n=Bn(e,"link"),r=Bn(Kn(n),"link");return e=Bn(e,"deep_link_id"),Bn(Kn(e),"link")||e||r||n||t}function lo(t,e){if(!t&&!e)throw new N("internal-error","Internal assert: no raw session string available");if(t&&e)throw new N("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?ho:fo}C(io,ro),C(oo,io),C(ao,io),C(so,io),C(uo,io);var ho="enroll",fo="signin";function po(){}function vo(t,e){return t.then((function(t){if(t[is]){var n=Qi(t[is]);if(!n||e!=n.i)throw new N("user-mismatch");return t}throw new N("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==O+"user-not-found"?new N("user-mismatch"):t}))}function go(t,e){if(!e)throw new N("internal-error","failed to construct a credential");this.a=e,ti(this,"providerId",t),ti(this,"signInMethod",t)}function yo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function mo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new go(t.providerId,t.pendingToken)}catch(e){}return null}function bo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&ti(this,"idToken",e.idToken),e.accessToken&&ti(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&ti(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new N("internal-error","failed to construct a credential");ti(this,"accessToken",e.oauthToken),ti(this,"secret",e.oauthTokenSecret)}ti(this,"providerId",t),ti(this,"signInMethod",n)}function _o(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:er(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function wo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new bo(t.providerId,e,t.signInMethod)}catch(n){}}return null}function Io(t,e){this.Qc=e||[],ei(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(Zi(t)||{}).Ja||null,this.pb=null}function To(t){if("string"!==typeof t||0!=t.indexOf("saml."))throw new N("argument-error",'SAML provider IDs must be prefixed with "saml."');Io.call(this,t,[])}function Eo(t){Io.call(this,t,Xi),this.a=[]}function So(){Eo.call(this,"facebook.com")}function Co(t){if(!t)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new So).credential({accessToken:e})}function ko(){Eo.call(this,"github.com")}function No(t){if(!t)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new ko).credential({accessToken:e})}function Ao(){Eo.call(this,"google.com"),this.Ca("profile")}function Po(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new Ao).credential({idToken:n,accessToken:e})}function Oo(){Io.call(this,"twitter.com",$i)}function Ro(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new N("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new bo("twitter.com",n,"twitter.com")}function xo(t,e,n){this.a=t,this.f=e,ti(this,"providerId","password"),ti(this,"signInMethod",n===Mo.EMAIL_LINK_SIGN_IN_METHOD?Mo.EMAIL_LINK_SIGN_IN_METHOD:Mo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Do(t){return t&&t.email&&t.password?new xo(t.email,t.password,t.signInMethod):null}function Mo(){ei(this,{providerId:"password",isOAuthProvider:!1})}function Lo(t,e){if(!(e=Fo(e)))throw new N("argument-error","Invalid email link!");return new xo(t,e.code,Mo.EMAIL_LINK_SIGN_IN_METHOD)}function Fo(t){return(t=xi(t=co(t)))&&t.operation===pi?t:null}function jo(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new N("internal-error");this.a=t,ti(this,"providerId","phone"),this.fa="phone",ti(this,"signInMethod","phone")}function Uo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return G(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new jo(e)}return null}function qo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function Vo(t){try{this.a=t||r.default.auth()}catch(e){throw new N("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}ei(this,{providerId:"phone",isOAuthProvider:!1})}function Bo(t,e){if(!t)throw new N("missing-verification-id");if(!e)throw new N("missing-verification-code");return new jo({fb:t,eb:e})}function Ko(t){if(t.temporaryProof&&t.phoneNumber)return new jo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Po(o,n);case"facebook.com":return Co(n);case"github.com":return No(n);case"twitter.com":return Ro(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new go(e,a):new bo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Eo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Wo(t){if(!t.isOAuthProvider)throw new N("invalid-oauth-provider")}function Ho(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new N("invalid-auth-event");if(this.g&&this.a)throw new N("invalid-auth-event");if(this.g&&!this.f)throw new N("invalid-auth-event")}function Go(t){return(t=t||{}).type?new Ho(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&A(t.error),t.postBody,t.tenantId):null}function zo(){this.b=null,this.a=[]}lo.prototype.Ha=function(){return this.a?Pe(this.a):Pe(this.b)},lo.prototype.w=function(){return this.type==ho?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},po.prototype.ka=function(){},po.prototype.b=function(){},po.prototype.c=function(){},po.prototype.w=function(){},go.prototype.ka=function(t){return Cs(t,yo(this))},go.prototype.b=function(t,e){var n=yo(this);return n.idToken=e,ks(t,n)},go.prototype.c=function(t,e){return vo(Ns(t,yo(this)),e)},go.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},bo.prototype.ka=function(t){return Cs(t,_o(this))},bo.prototype.b=function(t,e){var n=_o(this);return n.idToken=e,ks(t,n)},bo.prototype.c=function(t,e){return vo(Ns(t,_o(this)),e)},bo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Io.prototype.Ka=function(t){return this.Jb=yt(t),this},C(To,Io),C(Eo,Io),Eo.prototype.Ca=function(t){return $(this.a,t)||this.a.push(t),this},Eo.prototype.Rb=function(){return tt(this.a)},Eo.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new N("argument-error","credential failed: must provide the ID token and/or the access token.");return new bo(this.providerId,n,this.providerId)},C(So,Eo),ti(So,"PROVIDER_ID","facebook.com"),ti(So,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),C(ko,Eo),ti(ko,"PROVIDER_ID","github.com"),ti(ko,"GITHUB_SIGN_IN_METHOD","github.com"),C(Ao,Eo),ti(Ao,"PROVIDER_ID","google.com"),ti(Ao,"GOOGLE_SIGN_IN_METHOD","google.com"),C(Oo,Io),ti(Oo,"PROVIDER_ID","twitter.com"),ti(Oo,"TWITTER_SIGN_IN_METHOD","twitter.com"),xo.prototype.ka=function(t){return this.signInMethod==Mo.EMAIL_LINK_SIGN_IN_METHOD?cu(t,Ls,{email:this.a,oobCode:this.f}):cu(t,iu,{email:this.a,password:this.f})},xo.prototype.b=function(t,e){return this.signInMethod==Mo.EMAIL_LINK_SIGN_IN_METHOD?cu(t,Fs,{idToken:e,email:this.a,oobCode:this.f}):cu(t,$s,{idToken:e,email:this.a,password:this.f})},xo.prototype.c=function(t,e){return vo(this.ka(t),e)},xo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},ei(Mo,{PROVIDER_ID:"password"}),ei(Mo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),ei(Mo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),jo.prototype.ka=function(t){return t.gb(qo(this))},jo.prototype.b=function(t,e){var n=qo(this);return n.idToken=e,cu(t,au,n)},jo.prototype.c=function(t,e){var n=qo(this);return n.operation="REAUTH",vo(t=cu(t,su,n),e)},jo.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Vo.prototype.gb=function(t,e){var n=this.a.a;return Pe(e.verify()).then((function(r){if("string"!==typeof r)throw new N("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=g(t)?t.session:null,o=g(t)?t.phoneNumber:t;return(i&&i.type==ho?i.Ha().then((function(t){return function(t,e){return cu(t,Js,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==fo?i.Ha().then((function(e){return function(t,e){return cu(t,Zs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return cu(t,Qs,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"===typeof e.reset&&e.reset(),t}),(function(t){throw"function"===typeof e.reset&&e.reset(),t}));default:throw new N("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},ei(Vo,{PROVIDER_ID:"phone"}),ei(Vo,{PHONE_SIGN_IN_METHOD:"phone"}),Ho.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Ho.prototype.T=function(){return this.h},Ho.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Qo,Yo=null;function $o(t){var e="unauthorized-domain",n=void 0,r=Kn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Ht("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Ht("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",N.call(this,e,n)}function Xo(t,e,n){N.call(this,t,n),(t=e||{}).Kb&&ti(this,"email",t.Kb),t.ea&&ti(this,"phoneNumber",t.ea),t.credential&&ti(this,"credential",t.credential),t.$b&&ti(this,"tenantId",t.$b)}function Jo(t){if(t.code){var e=t.code||"";0==e.indexOf(O)&&(e=e.substring(O.length));var n={credential:Ko(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new N(e,t.message||void 0);return new Xo(e,n,t.message)}return null}function Zo(){}function ta(t){return t.c||(t.c=t.b())}function ea(){}function na(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(Hp){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ra(){}function ia(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=T(this.qc,this),this.a.onerror=T(this.Tb,this),this.a.onprogress=T(this.rc,this),this.a.ontimeout=T(this.vc,this)}function oa(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function aa(t,e,n){this.reset(t,e,n,void 0,void 0)}C($o,N),C(Xo,N),Xo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&bt(t,e),t},Xo.prototype.toJSON=function(){return this.w()},Zo.prototype.c=null,C(ea,Zo),ea.prototype.a=function(){var t=na(this);return t?new ActiveXObject(t):new XMLHttpRequest},ea.prototype.b=function(){var t={};return na(this)&&(t[0]=!0,t[1]=!0),t},Qo=new ea,C(ra,Zo),ra.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new ia;throw Error("Unsupported browser")},ra.prototype.b=function(){return{}},(t=ia.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,oa(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",oa(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,oa(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},aa.prototype.a=null;function sa(t){this.f=t,this.b=this.c=this.a=null}function ua(t,e){this.name=t,this.value=e}aa.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||S(),delete this.a},ua.prototype.toString=function(){return this.name};var ca=new ua("SEVERE",1e3),la=new ua("WARNING",900),ha=new ua("CONFIG",700),fa=new ua("FINE",500);function pa(t){return t.c?t.c:t.a?pa(t.a):(j("Root logger has no level set."),null)}sa.prototype.log=function(t,e,n){if(t.value>=pa(this).value)for(v(e)&&(e=e()),t=new aa(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var da,va={},ga=null;function ya(t){var e;if(ga||(ga=new sa(""),va[""]=ga,ga.c=ha),!(e=va[t])){e=new sa(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=ya(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,va[t]=e}return e}function ma(t,e){t&&t.log(fa,e,void 0)}function ba(t){this.f=t}function _a(t){En.call(this),this.u=t,this.h=void 0,this.readyState=wa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=ya("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}C(ba,Zo),ba.prototype.a=function(){return new _a(this.f)},ba.prototype.b=(da={},function(){return da}),C(_a,En);var wa=0;function Ia(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function Ta(t){t.readyState=4,t.g=null,t.c=null,t.m=null,Ea(t)}function Ea(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Sa(t){En.call(this),this.headers=new Rn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ca,this.u=this.S=!1}(t=_a.prototype).open=function(t,e){if(this.readyState!=wa)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,Ea(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Ta(this)),this.readyState=wa},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Ea(this)),this.a&&(this.readyState=3,Ea(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):"undefined"!==typeof u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,Ia(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Ta(this):Ea(this),3==this.readyState&&Ia(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,Ta(this))},t.sc=function(t){this.a&&(this.response=t,Ta(this))},t.Va=function(t){var e=this.i;e&&e.log(la,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&Ta(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(la,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(la,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(_a.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),C(Sa,En);var Ca="";Sa.prototype.b=ya("goog.net.XhrIo");var ka=/^https?$/i,Na=["POST","PUT"];function Aa(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Qo.a(),t.C=t.D?ta(t.D):ta(Qo),t.a.onreadystatechange=T(t.Wb,t);try{ma(t.b,ja(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(a){return ma(t.b,ja(t,"Error opening Xhr: "+a.message)),void Oa(t,a)}e=r||"";var o=new Rn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"===typeof t)G(t,e,void 0);else for(var n=On(t),r=Pn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Pa,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!$(Na,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Ma(t),0<t.g&&(t.u=function(t){return $t&&se(9)&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(t.a),ma(t.b,ja(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=T(t.Ma,t)):t.s=Nn(t.Ma,t.g,t)),ma(t.b,ja(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){ma(t.b,ja(t,"Send error: "+a.message)),Oa(t,a)}}function Pa(t){return"content-type"==t.toLowerCase()}function Oa(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Ra(t),Da(t)}function Ra(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function xa(t){if(t.c&&"undefined"!=typeof s)if(t.C[1]&&4==La(t)&&2==Fa(t))ma(t.b,ja(t,"Local request error detected and ignored"));else if(t.i&&4==La(t))Nn(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==La(t)){ma(t.b,ja(t,"Request complete")),t.c=!1;try{var e,n=Fa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Mn)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!ka.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<La(t)?t.a.statusText:""}catch(l){ma(t.b,"Can not get status: "+l.message),c=""}t.h=c+" ["+Fa(t)+"]",Ra(t)}}finally{Da(t)}}}function Da(t,e){if(t.a){Ma(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(Hp){(t=t.b)&&t.log(ca,"Problem encountered resetting onreadystatechange: "+Hp.message,void 0)}}}function Ma(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(u.clearTimeout(t.s),t.s=null)}function La(t){return t.a?t.a.readyState:0}function Fa(t){try{return 2<La(t)?t.a.status:-1}catch(e){return-1}}function ja(t,e){return e+" ["+t.P+" "+t.l+" "+Fa(t)+"]"}function Ua(t){var e=$a;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function qa(t,e,n){t.a=!0,t.c=n,t.f=!e,Wa(t)}function Va(t){if(t.a){if(!t.v)throw new Ha(t);t.v=!1}}function Ba(t,e,n,r){t.g.push([e,n,r]),t.a&&Wa(t)}function Ka(t){return Y(t.g,(function(t){return v(t[1])}))}function Wa(t){if(t.h&&t.a&&Ka(t)){var e=t.h,n=Qa[e];n&&(u.clearTimeout(n.a),delete Qa[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.s,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(M(e)||"function"===typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ka(t)||(n=!0)}}t.c=e,r&&(s=T(t.m,t,!0),r=T(t.m,t,!1),e instanceof Ua?(Ba(e,s,r),e.C=!0):e.then(s,r)),n&&(e=new za(e),Qa[e.a]=e,t.h=e.a)}function Ha(){L.call(this)}function Ga(){L.call(this)}function za(t){this.a=u.setTimeout(T(this.c,this),0),this.b=t}(t=Sa.prototype).Ma=function(){"undefined"!=typeof s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ma(this.b,ja(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ma(this.b,ja(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Da(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Da(this,!0)),Sa.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?xa(this):this.Jc())},t.Jc=function(){xa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ca:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ca,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ma(this.b,"Can not get response: "+e.message),null}},Ua.prototype.cancel=function(t){if(this.a)this.c instanceof Ua&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Ga(this),Va(this),qa(this,!1,t))}},Ua.prototype.m=function(t,e){this.i=!1,qa(this,t,e)},Ua.prototype.then=function(t,e,n){var r,i,o=new Te((function(t,e){r=t,i=e}));return Ba(this,r,(function(t){t instanceof Ga?o.cancel():i(t)})),o.then(t,e,n)},Ua.prototype.$goog_Thenable=!0,C(Ha,L),Ha.prototype.message="Deferred has already fired",Ha.prototype.name="AlreadyCalledError",C(Ga,L),Ga.prototype.message="Deferred was canceled",Ga.prototype.name="CanceledError",za.prototype.c=function(){throw delete Qa[this.a],this.b};var Qa={};function Ya(t){var e={},n=e.document||document,r=Nt(t).toString(),i=ye(document,"SCRIPT"),o={Xb:i,Ma:void 0},a=new Ua(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout((function(){Xa(i,!0);var t=new ts(Za,"Timeout reached for loading script "+r);Va(a),qa(a,!1,t)}),c),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Xa(i,e.xd||!1,s),Va(a),qa(a,!0,null))},i.onerror=function(){Xa(i,!0,s);var t=new ts(Ja,"Error while loading script "+r);Va(a),qa(a,!1,t)},bt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),fe(i,o),function(t,e){_t(t,"HTMLScriptElement"),t.src=Nt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=u?e=h(e.document):(null===l&&(l=h(u.document)),e=l),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function $a(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&Xa(t,!0,this.Ma)}}function Xa(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ja=0,Za=1;function ts(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function es(t){this.f=t}function ns(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||os,this.g=yt(t.secureTokenHeaders||as),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||ss,this.a=yt(t.firebaseHeaders||us),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Cr(),!(n=u.XMLHttpRequest||n&&r.default.INTERNAL.node&&r.default.INTERNAL.node.XMLHttpRequest)&&!Sr())throw new N("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Sr()?this.f=new ba(self):kr()?this.f=new es(n):this.f=new ra,this.b=null}C(ts,L),C(es,Zo),es.prototype.a=function(){return new this.f},es.prototype.b=function(){return{}};var rs,is="idToken",os=new Gr(3e4,6e4),as={"Content-Type":"application/x-www-form-urlencoded"},ss=new Gr(3e4,6e4),us={"Content-Type":"application/json"};function cs(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ls(t,e){e&&(t.l=hs("https://securetoken.googleapis.com/v1/token",e),t.h=hs("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=hs("https://identitytoolkit.googleapis.com/v2/",e))}function hs(t,e){return t=Kn(t),e=Kn(e.url),t.f=t.a+t.f,Fn(t,e.c),t.a=e.a,jn(t,e.g),t.toString()}function fs(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function ps(t,e,n,r,i,o,a){(function(){var t=xr();return!((t=Pr(t)!=Ar?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!$t||!ce||9<ce)})()||Sr()?t=T(t.u,t):(rs||(rs=new Te((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{u[vs]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Ba(t,null,e,void 0)}(Ya(At(ds,{onload:vs})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=T(t.s,t)),t(e,n,r,i,o,a)}ns.prototype.T=function(){return this.b},ns.prototype.u=function(t,e,n,r,i,o){if(Sr()&&("undefined"===typeof u.fetch||"undefined"===typeof u.Headers||"undefined"===typeof u.Request))throw new N("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Sa(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}Sn(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ma(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(b){t=null}e&&e(t)})),Cn(a,"ready",(function(){s&&clearTimeout(s),Qe(this)})),Cn(a,"timeout",(function(){s&&clearTimeout(s),Qe(this),e&&e(null)})),Aa(a,t,n,r,i)};var ds=new wt(St,"https://apis.google.com/js/client.js?onload=%{onload}"),vs="__fcb"+Math.floor(1e6*Math.random()).toString();function gs(t,e,n,r,i,o,a){var s=Kn(e+n);Vn(s,"key",t.c),a&&Vn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Vn(s,c,i[c]);return new Te((function(e,n){ps(t,s.toString(),(function(t){t?t.error?n(hu(t,o||{})):e(t):n(new N("network-request-failed"))}),r,u?void 0:sr(Vr(i)),t.a,t.v.get())}))}function ys(t){if("string"!==typeof(t=t.email)||!wr.test(t))throw new N("invalid-email")}function ms(t){"email"in t&&ys(t)}function bs(t){if(!t[is]){if(t.mfaPendingCredential)throw new N("multi-factor-auth-required",null,yt(t));throw new N("internal-error")}}function _s(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new N("internal-error")}else{if(!t.sessionInfo)throw new N("missing-verification-id");if(!t.code)throw new N("missing-verification-code")}}ns.prototype.s=function(t,e,n,r,i){var o=this;rs.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},ns.prototype.Ab=function(){return cu(this,Xs,{})},ns.prototype.Cb=function(t,e){return cu(this,Ys,{idToken:t,email:e})},ns.prototype.Db=function(t,e){return cu(this,$s,{idToken:t,password:e})};var ws={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Is(t){if(!t.phoneVerificationInfo)throw new N("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new N("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new N("missing-verification-code")}function Ts(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new N("internal-error")}function Es(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(rr(t=new Zn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Ss(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Jo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Jo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Jo(t)):t.errorMessage&&(e=lu(t.errorMessage)),e)throw e;bs(t)}function Cs(t,e){return e.returnIdpCredential=!0,cu(t,tu,e)}function ks(t,e){return e.returnIdpCredential=!0,cu(t,nu,e)}function Ns(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,cu(t,eu,e)}function As(t){if(!t.oobCode)throw new N("invalid-action-code")}(t=ns.prototype).Eb=function(t,e){var n={idToken:t},r=[];return vt(ws,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),cu(this,Ys,n)},t.wb=function(t,e){return bt(t={requestType:"PASSWORD_RESET",email:t},e),cu(this,Ws,t)},t.xb=function(t,e){return bt(t={requestType:"EMAIL_SIGNIN",email:t},e),cu(this,Vs,t)},t.vb=function(t,e){return bt(t={requestType:"VERIFY_EMAIL",idToken:t},e),cu(this,Bs,t)},t.Fb=function(t,e,n){return bt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),cu(this,Ks,t)},t.gb=function(t){return cu(this,ou,t)},t.ob=function(t,e){return cu(this,zs,{oobCode:t,newPassword:e})},t.Sa=function(t){return cu(this,Os,{oobCode:t})},t.kb=function(t){return cu(this,Ps,{oobCode:t})};var Ps={endpoint:"setAccountInfo",A:As,Z:"email",B:!0},Os={endpoint:"resetPassword",A:As,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new N("internal-error")},B:!0},Rs={endpoint:"signupNewUser",A:function(t){if(ys(t),!t.password)throw new N("weak-password")},G:bs,V:!0,B:!0},xs={endpoint:"createAuthUri",B:!0},Ds={endpoint:"deleteAccount",O:["idToken"]},Ms={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new N("internal-error")}},Ls={endpoint:"emailLinkSignin",O:["email","oobCode"],A:ys,G:bs,V:!0,B:!0},Fs={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:ys,G:bs,V:!0},js={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:Is,G:bs,B:!0,Na:!0},Us={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:Is,G:bs,B:!0,Na:!0},qs={endpoint:"getAccountInfo"},Vs={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new N("internal-error");ys(t)},Z:"email",B:!0},Bs={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new N("internal-error")},Z:"email",B:!0},Ks={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new N("internal-error")},Z:"email",B:!0},Ws={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new N("internal-error");ys(t)},Z:"email",B:!0},Hs={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Gs={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new N("internal-error")}},zs={endpoint:"resetPassword",A:As,Z:"email",B:!0},Qs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ys={endpoint:"setAccountInfo",O:["idToken"],A:ms,V:!0},$s={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(ms(t),!t.password)throw new N("weak-password")},G:bs,V:!0},Xs={endpoint:"signupNewUser",G:bs,V:!0,B:!0},Js={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new N("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new N("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new N("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new N("internal-error")},B:!0,Na:!0},Zs={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new N("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new N("internal-error")},B:!0,Na:!0},tu={endpoint:"verifyAssertion",A:Ts,Za:Es,G:Ss,V:!0,B:!0},eu={endpoint:"verifyAssertion",A:Ts,Za:Es,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new N("user-not-found");if(t.errorMessage)throw lu(t.errorMessage);bs(t)},V:!0,B:!0},nu={endpoint:"verifyAssertion",A:function(t){if(Ts(t),!t.idToken)throw new N("internal-error")},Za:Es,G:Ss,V:!0},ru={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new N("invalid-custom-token")},G:bs,V:!0,B:!0},iu={endpoint:"verifyPassword",A:function(t){if(ys(t),!t.password)throw new N("wrong-password")},G:bs,V:!0,B:!0},ou={endpoint:"verifyPhoneNumber",A:_s,G:bs,B:!0},au={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new N("internal-error");_s(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Jo(t);bs(t)}},su={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:_s,G:bs,B:!0},uu={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[is]^!!t.refreshToken)throw new N("internal-error")},B:!0,Na:!0};function cu(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}(n,e.O))return Oe(new N("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return Pe(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&"undefined"===typeof n.tenantId&&(n.tenantId=t.b),gs(t,i?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)})).then((function(t){return r=t,e.Za?e.Za(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new N("internal-error");return r[e.Z]}))}function lu(t){return hu({error:{errors:[{message:t}],code:400,message:t}})}function hu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new N(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",bt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new N(r[i],e);return!e&&t&&(e=qr(t)),new N("internal-error",e)}function fu(t){this.b=t,this.a=null,this.sb=function(t){return(gu||(gu=new Te((function(t,e){function n(){Hr(),Dr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Hr(),e(Error("Network Error"))},timeout:du.get()})}if(Dr("gapi.iframes.Iframe"))t();else if(Dr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){Dr("gapi.load")?n():e(Error("Network Error"))},Pe(Ya(r=At(pu,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw gu=null,t})))).then((function(){return new Te((function(e,n){Dr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),vu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var pu=new wt(St,"https://apis.google.com/js/api.js?onload=%{onload}"),du=new Gr(3e4,6e4),vu=new Gr(5e3,15e3),gu=null;function yu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,this.g?t=Wn((t=Kn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):t=Wn("https",this.l,null,"/__/auth/iframe"),this.a=t,Vn(this.a,"apiKey",this.h),Vn(this.a,"appName",this.i),this.b=null,this.c=[]}function mu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function bu(t){try{return r.default.app(t).auth().Ga()}catch(e){return[]}}function _u(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function wu(t){var e=dr();return function(t){return cu(t,Hs,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Kn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Kn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:_r.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new $o(dr())}))}function Iu(t){return t.m||(t.m=Ir().then((function(){if(!t.u){var e=t.c,n=t.i,r=bu(t.b),i=new yu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=tt(r||[]),t.u=i.toString()}t.v=new fu(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then((function(){t.a.register("authEvent",e,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Go(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Pe(n)}return n.status="ERROR",Pe(n)}))}(t)}))),t.m}function Tu(t){return t.l||(t.C=t.c?Rr(t.c,bu(t.b)):null,t.l=new ns(t.g,D(t.i),t.C),t.f&&ls(t.l,t.f)),t.l}function Eu(t,e,n,r,i,o,a,s,u,c,l,h){return(t=new mu(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=yt(u||null),t.f=c,t.zb(l).toString()}function Su(t){if(this.a=t||r.default.INTERNAL.reactNative&&r.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new N("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Cu(t){this.b=t,this.a={},this.f=T(this.c,this)}yu.prototype.toString=function(){return this.f?Vn(this.a,"v",this.f):nr(this.a.b,"v"),this.b?Vn(this.a,"eid",this.b):nr(this.a.b,"eid"),this.c.length?Vn(this.a,"fw",this.c.join(",")):nr(this.a.b,"fw"),this.a.toString()},mu.prototype.zb=function(t){return this.h=t,this},mu.prototype.toString=function(){if(this.v){var t=Kn(this.v.url);t=Wn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Wn("https",this.u,null,"/__/auth/handler");if(Vn(t,"apiKey",this.s),Vn(t,"appName",this.c),Vn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.default.app(this.c).auth().la()}catch(u){n=null}for(var i in e.pb=n,Vn(t,"providerId",this.a.providerId),e=Vr((n=this.a).Jb))e[i]=e[i].toString();i=n.Qc,e=yt(e);for(var o=0;o<i.length;o++){var a=i[o];a in e&&delete e[a]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),gt(e)||Vn(t,"customParameters",qr(e))}if("function"===typeof this.a.Rb&&((n=this.a.Rb()).length&&Vn(t,"scopes",n.join(","))),this.l?Vn(t,"redirectUrl",this.l):nr(t.b,"redirectUrl"),this.g?Vn(t,"eventId",this.g):nr(t.b,"eventId"),this.i?Vn(t,"v",this.i):nr(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Bn(t,s)&&Vn(t,s,this.b[s]);return this.h?Vn(t,"tid",this.h):nr(t.b,"tid"),this.f?Vn(t,"eid",this.f):nr(t.b,"eid"),(s=bu(this.c)).length&&Vn(t,"fw",s.join(",")),t.toString()},(t=_u.prototype).Pb=function(t,e,n){var r=new N("popup-closed-by-user"),i=new N("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return Iu(t).then((function(){return function(t,e){return t.sb.then((function(){return new Te((function(n){t.a.send(e.type,e,n,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&mr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Te((function(e){return function n(){An(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return An(n).then((function(){e(r)}))}))},t.Yb=function(){var t=xr();return!Ur(t)&&!Wr(t)},t.Ub=function(){return!1},t.Nb=function(t,e,n,r,i,o,a,s){if(!t)return Oe(new N("popup-blocked"));if(a&&!Ur())return this.ma().o((function(e){mr(t),i(e)})),r(),Pe();this.a||(this.a=wu(Tu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw mr(t),i(e),e}));return r(),e})).then((function(){(Wo(n),a)||vr(Eu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Ob=function(t,e,n,r){this.a||(this.a=wu(Tu(this)));var i=this;return this.a.then((function(){Wo(e),vr(Eu(i.s,i.g,i.b,t,e,dr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return Iu(this).then((function(){return t.v.sb})).o((function(){throw t.a=null,new N("network-request-failed")}))},t.ac=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ta=function(t){J(this.h,(function(e){return e==t}))},(t=Su.prototype).get=function(t){return Pe(this.a.getItem(t)).then((function(t){return t&&Br(t)}))},t.set=function(t,e){return Pe(this.a.setItem(t,qr(e)))},t.U=function(t){return Pe(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var ku,Nu=[];function Au(t,e,n){gt(t.a)&&t.b.addEventListener("message",t.f),"undefined"===typeof t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Pu(t){this.a=t}function Ou(t){this.c=t,this.b=!1,this.a=[]}function Ru(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Oe(Error("connection_unavailable"));var l=r?800:50,h="undefined"!==typeof MessageChannel?new MessageChannel:null;return new Te((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),"undefined"!==typeof t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return xu(t,c),e})).o((function(e){throw xu(t,c),e}))}function xu(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),J(t.a,(function(t){return t==e}))}}function Du(){if(!ju())throw new N("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Sr()&&self?(this.v=function(){var t=Sr()?self:null;if(G(Nu,(function(n){n.b==t&&(e=n)})),!e){var e=new Cu(t);Nu.push(e)}return e}(),Au(this.v,"keyChanged",(function(e,n){return Ku(t).then((function(e){return 0<e.length&&G(t.a,(function(t){t(e)})),{keyProcessed:$(e,n.key)}}))})),Au(this.v,"ping",(function(){return Pe(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?Pe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Pe(null)}().then((function(e){(t.h=e)&&(t.g=new Ou(new Pu(e)),Ru(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&$(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Mu(t){return new Te((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Te((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Mu(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Lu(t){return t.i||(t.i=Mu(t)),t.i}function Fu(t,e){var n=0;return new Te((function r(i,o){Lu(t).then(e).then(i).o((function(e){if(!(3<++n))return Lu(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function ju(){try{return!!u.indexedDB}catch(da){return!1}}function Uu(t){return t.objectStore("firebaseLocalStorage")}function qu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Vu(t){return new Te((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Bu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Ru(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Pe()}function Ku(t){return Lu(t).then((function(t){var e=Uu(qu(t,!1));return e.getAll?Vu(e.getAll()):new Te((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=gr(t.c,n),t.c=n}return r}))}function Wu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Hu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Pe().then((function(){if(ju()){var t=Kr(),r="__sak"+t;return ku||(ku=new Du),(n=ku).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){G(e.a,(function(e){e(t)}))})),t}))}function Gu(){this.a={},this.type="inMemory"}function zu(){if(!function(){var t="Node"==Cr();if(!(t=Qu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==Cr())throw new N("internal-error","The LocalStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=Qu()||r.default.INTERNAL.node.localStorage,this.type="localStorage"}function Qu(){try{var t=u.localStorage,e=Kr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Yu(){this.type="nullStorage"}function $u(){if(!function(){var t="Node"==Cr();if(!(t=Xu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==Cr())throw new N("internal-error","The SessionStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=Xu()||r.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Xu(){try{var t=u.sessionStorage,e=Kr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Ju(){var t={};t.Browser=ec,t.Node=nc,t.ReactNative=rc,t.Worker=ic,this.a=t[Cr()]}Cu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];G(r,(function(e){i.push(Pe().then((function(){return e(t.origin,t.data.data)})))})),xe(i).then((function(r){var i=[];G(r,(function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})})),G(i,(function(t){for(var e in t)"undefined"===typeof t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Pu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Ou.prototype.close=function(){for(;0<this.a.length;)xu(this,this.a[0]);this.b=!0},(t=Du.prototype).set=function(t,e){var n=this,r=!1;return Fu(this,(function(e){return Vu((e=Uu(qu(e,!0))).get(t))})).then((function(i){return Fu(n,(function(o){if(o=Uu(qu(o,!0)),i)return i.value=e,Vu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Vu(o.add(a))}))})).then((function(){return n.c[t]=e,Bu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Fu(this,(function(e){return Vu(Uu(qu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Fu(this,(function(r){return n=!0,e.b++,Vu(Uu(qu(r,!0)).delete(t))})).then((function(){return delete e.c[t],Bu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){function e(){t.f=setTimeout((function(){t.l=Ku(t).then((function(e){0<e.length&&G(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}Wu(t),e()}(this),this.a.push(t)},t.ia=function(t){J(this.a,(function(e){return e==t})),0==this.a.length&&Wu(this)},(t=Hu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){J(this.a,(function(e){return e==t}))},(t=Gu.prototype).get=function(t){return Pe(this.a[t])},t.set=function(t,e){return this.a[t]=e,Pe()},t.U=function(t){return delete this.a[t],Pe()},t.ca=function(){},t.ia=function(){},(t=zu.prototype).get=function(t){var e=this;return Pe().then((function(){return Br(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var r=qr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(t){u.window&&fn(u.window,"storage",t)},t.ia=function(t){u.window&&vn(u.window,"storage",t)},(t=Yu.prototype).get=function(){return Pe(null)},t.set=function(){return Pe()},t.U=function(){return Pe()},t.ca=function(){},t.ia=function(){},(t=$u.prototype).get=function(t){var e=this;return Pe().then((function(){return Br(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var r=qr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Zu,tc,ec={F:zu,cb:$u},nc={F:zu,cb:$u},rc={F:Su,cb:Yu},ic={F:zu,cb:Yu},oc={rd:"local",NONE:"none",td:"session"};function ac(){var t=!(Wr(xr())||!Er()),e=Ur(),n=Mr();this.m=t,this.h=e,this.l=n,this.a={},Zu||(Zu=new Ju),t=Zu;try{this.g=!pr()&&Yr()||!u.indexedDB?new t.a.F:new Hu(Sr()?new Gu:new t.a.F)}catch(r){this.g=new Gu,this.h=!0}try{this.i=new t.a.cb}catch(r){this.i=new Gu}this.v=new Gu,this.f=T(this.Zb,this),this.b={}}function sc(){return tc||(tc=new ac),tc}function uc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function cc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function lc(t,e,n){return n=cc(e,n),"local"==e.F&&(t.b[n]=null),uc(t,e.F).U(n)}function hc(t){t.c&&(clearInterval(t.c),t.c=null)}function fc(t){this.a=t,this.b=sc()}(t=ac.prototype).get=function(t,e){return uc(this,t.F).get(cc(t,e))},t.set=function(t,e,n){var r=cc(t,n),i=this,o=uc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=cc(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),gt(this.a)&&(uc(this,"local").ca(this.f),this.h||(pr()||!Yr())&&u.indexedDB||!this.l||function(t){hc(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new tn({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Zb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=cc(t,e),this.a[t]&&(J(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),gt(this.a)&&(uc(this,"local").ia(this.f),hc(this))},t.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?uc(this,"local").ia(this.f):hc(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&"undefined"===typeof t.a.a)return;var o=this;n=function(){"undefined"===typeof t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.nb(e))},$t&&ce&&10==ce&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else G(t,T(this.nb,this))},t.nb=function(t){this.a[t]&&G(this.a[t],(function(t){t()}))};var pc,dc={name:"authEvent",F:"local"};function vc(){this.a=sc()}function gc(t,e){this.b=yc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===pc&&(pc=u.Int32Array?new Int32Array(Ec):Ec),this.reset()}C(gc,(function(){this.b=-1}));for(var yc=64,mc=yc-1,bc=[],_c=0;_c<mc;_c++)bc[_c]=0;var wc=Z(128,bc);function Ic(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|pc[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Tc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"===typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Ic(t),i=0);else{if(!d(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Ic(t),i=0)}}t.c=i,t.g+=n}gc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):tt(this.h)};var Ec=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Sc(){gc.call(this,8,Cc)}C(Sc,gc);var Cc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function kc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new vc,this.g=new fc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Nc(t){return new N("invalid-cordova-configuration",t)}function Ac(t){var e=new Sc;Tc(e,t),t=[];var n=8*e.g;56>e.c?Tc(e,wc,56-e.c):Tc(e,wc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Ic(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return Q(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Pc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function Oc(t){return t.f||(t.f=t.ma().then((function(){return new Te((function(e){t.Ea((function n(r){return e(r),t.Ta(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Rc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=co(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"===typeof(o=Br(Bn(o=Kn(i),"firebaseError")||null))?A(o):null)?new Ho(r.c,r.b,null,null,o,null,r.T()):new Ho(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Pc(t,i)}))}var n=new Ho("unknown",null,null,null,new N("no-auth-event")),r=!1,i=An(500).then((function(){return Rc(t).then((function(){r||Pc(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Dr("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"===typeof o)try{o(t)}catch(n){console.error(n)}},Yo||(Yo=new zo),function(t){var e=Yo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"===typeof(t=Dr("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Rc(t){var e=null;return function(t){return t.b.get(dc,t.a).then((function(t){return Go(t)}))}(t.g).then((function(n){return e=n,lc((n=t.g).b,dc,n.a)})).then((function(){return e}))}function xc(t){this.a=t,this.b=sc()}(t=kc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(Tr(void 0)?Ir().then((function(){return new Te((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Oe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!==typeof Dr("universalLinks.subscribe",u))throw Nc("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof Dr("BuildInfo.packageName",u))throw Nc("cordova-plugin-buildinfo is not installed");if("function"!==typeof Dr("cordova.plugins.browsertab.openUrl",u))throw Nc("cordova-plugin-browsertab is not installed");if("function"!==typeof Dr("cordova.InAppBrowser.open",u))throw Nc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new N("cordova-not-ready")}))},t.Pb=function(t,e){return e(new N("operation-not-supported-in-this-environment")),Pe()},t.Nb=function(){return Oe(new N("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(t,e,n,r){if(this.c)return Oe(new N("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,l=null;return this.c=Pe().then((function(){return Wo(e),Oc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Ho(e,r,null,o,new N("no-auth-event"),null,i),s=Dr("BuildInfo.packageName",u);if("string"!==typeof s)throw new N("invalid-cordova-configuration");var c=Dr("BuildInfo.displayName",u),l={};if(xr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=s;else{if(!xr().toLowerCase().match(/android/))return Oe(new N("operation-not-supported-in-this-environment"));l.apn=s}c&&(l.appDisplayName=c),o=Ac(o),l.sessionId=o;var h=Eu(t.v,t.i,t.l,e,n,null,r,t.m,l,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(dc,a.w(),e)})).then((function(){var e=Dr("cordova.plugins.browsertab.isAvailable",u);if("function"!==typeof e)throw new N("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!==typeof(n=Dr("cordova.plugins.browsertab.openUrl",u)))throw new N("invalid-cordova-configuration");n(h)}else{if("function"!==typeof(n=Dr("cordova.InAppBrowser.open",u)))throw new N("invalid-cordova-configuration");e=xr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Te((function(t,e){s=function(){var e=Dr("cordova.plugins.browsertab.close",u);return t(),"function"===typeof e&&e(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),c=function(){a||(a=An(2e3).then((function(){e(new N("redirect-cancelled-by-user"))})))},l=function(){zr()&&c()},o.addEventListener("resume",c,!1),xr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(t){return Rc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),s&&i.Ta(s),i.c=null}))},t.Ea=function(t){this.b.push(t),Oc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ho("unknown",null,null,null,new N("no-auth-event")),t(e))}))},t.Ta=function(t){J(this.b,(function(e){return e==t}))};var Dc={name:"pendingRedirect",F:"session"};function Mc(t){return lc(t.b,Dc,t.a)}function Lc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=T(this.s,this),this.b=new Xc,this.C=new nl,this.g=new xc(Yc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Fc(this.D,this.v,this.m,P,this.J)}function Fc(t,e,n,i,o){var a=r.default.SDK_VERSION||null;return Tr()?new kc(t,e,n,a,i,o):new _u(t,e,n,a,i,o)}function jc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Uc(t){t.a.Yb()&&jc(t).o((function(e){var n=new Ho("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));Hc(e)&&t.s(n)})),t.a.Ub()||Jc(t.b)}function qc(t,e){$(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Dc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Mc(t.g).then((function(){jc(t).o((function(e){var n=new Ho("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));Hc(e)&&t.s(n)}))})):Uc(t)})).o((function(){Uc(t)}))}function Vc(t,e){J(t.h,(function(t){return t==e}))}Lc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Fc(this.D,this.v,this.m,null,this.J),this.i={}},Lc.prototype.s=function(t){if(!t)throw new N("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Jc(this.b),e};var Bc=new Gr(2e3,1e4),Kc=new Gr(3e4,6e4);function Wc(t,e,n,r,i,o,a){return t.a.Nb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Hc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Gc(t,e,n,r,i){var o;return function(t){return t.b.set(Dc,"pending",t.a)}(t.g).then((function(){return t.a.Ob(e,n,r,i).o((function(e){if(Hc(e))throw new N("operation-not-supported-in-this-environment");return o=e,Mc(t.g).then((function(){throw o}))})).then((function(){return t.a.ac()?new Te((function(){})):Mc(t.g).then((function(){return t.ra()})).then((function(){})).o((function(){}))}))}))}function zc(t,e,n,r,i){return t.a.Pb(r,(function(t){e.na(n,null,t,i)}),Bc.get())}Lc.prototype.ra=function(){return this.b.ra()};var Qc={};function Yc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function $c(t,e,n,r){var i=Yc(e,n,r);return Qc[i]||(Qc[i]=new Lc(t,e,n,r)),Qc[i]}function Xc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Jc(t){t.g||(t.g=!0,el(t,!1,null,null))}function Zc(t){t.g&&!t.i&&el(t,!1,null,null)}function tl(t,e){if(t.b=function(){return Pe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function el(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Oe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):tl(t,n):tl(t,{user:null}),t.f=[],t.c=[]}function nl(){}function rl(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function il(t,e){this.a=e,ti(this,"verificationId",t)}function ol(t,e,n,r){return new Vo(t).gb(e,n).then((function(t){return new il(t,r)}))}function al(t){var e=Yi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new N("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");ei(this,{token:t,expirationTime:Qr(1e3*e.exp),authTime:Qr(1e3*e.auth_time),issuedAtTime:Qr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function sl(t,e,n){var r=e&&e[cl];if(!r)throw new N("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=yt(e),this.g=n,this.c=new lo(null,r),this.b=[];var i=this;G(e[ul]||[],(function(t){(t=oi(t))&&i.b.push(t)})),ti(this,"auth",this.a),ti(this,"session",this.c),ti(this,"hints",this.b)}Xc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Xc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(el(this,!0,null,t.a),Pe()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){el(t,s,e,null)})).o((function(e){el(t,s,null,e)}))}(this,t,e):Oe(new N("invalid-auth-event")):(el(this,!1,null,null),Pe())}else Oe(new N("invalid-auth-event"))},Xc.prototype.ra=function(){var t=this;return new Te((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new N("timeout");t.a&&t.a.cancel(),t.a=An(Kc.get()).then((function(){t.b||(t.g=!0,el(t,!0,null,e))}))}(t))}))},nl.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Pe()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):Oe(new N("invalid-auth-event"))}else Oe(new N("invalid-auth-event"))},il.prototype.confirm=function(t){return t=Bo(this.verificationId,t),this.a(t)};var ul="mfaInfo",cl="mfaPendingCredential";function ll(t,e,n,r){N.call(this,"multi-factor-auth-required",r,e),this.b=new sl(t,e,n),ti(this,"resolver",this.b)}function hl(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new ll(e,t.serverResponse,n,t.message)}catch(r){}return null}function fl(){}function pl(t){ti(this,"factorId",t.fa),this.a=t}function dl(t){if(pl.call(this,t),this.a.fa!=Vo.PROVIDER_ID)throw new N("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function vl(t,e){for(var n in Ze.call(this,t),e)this[n]=e[n]}function gl(t,e){this.a=t,this.b=[],this.c=T(this.yc,this),fn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&G(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ui]=t.uid),t.displayName&&(r[ai]=t.displayName),t.enrollmentTime&&(r[si]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ci]=t.phoneNumber);try{e=new li(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),yl(this,n)}function yl(t,e){t.b=e,ti(t,"enrolledFactors",e)}function ml(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function bl(t,e){t.stop(),t.b=An(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=u.document,e=null;return zr()||!t?Pe():new Te((function(n){e=function(){zr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){bl(t,!0)})).o((function(e){t.i(e)&&bl(t,!1)}))}function _l(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function wl(t,e){"undefined"===typeof e&&(t.b?e=(e=t.b).a-e.g:e=0),t.c=Date.now()+1e3*e}function Il(t,e){t.b=Qi(e[is]||""),t.a=e.refreshToken,wl(t,"undefined"!==typeof(e=e.expiresIn)?Number(e):void 0)}function Tl(t,e){return function(t,e){return new Te((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ps(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(hu(t)):t.access_token&&t.refresh_token?n(t):r(new N("internal-error")):r(new N("network-request-failed"))}),"POST",er(e).toString(),t.g,t.m.get()):r(new N("internal-error"))}))}(t.f,e).then((function(e){return t.b=Qi(e.access_token),t.a=e.refresh_token,wl(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function El(t,e){this.a=t||null,this.b=e||null,ei(this,{lastSignInTime:Qr(e||null),creationTime:Qr(t||null)})}function Sl(t,e,n,r,i,o){ei(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Cl(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.default.SDK_VERSION?Rr(r.default.SDK_VERSION):null;this.a=new ns(this.l,D(P),i),(this.u=t.emulatorConfig||null)&&ls(this.a,this.u),this.h=new _l(this.a),Ml(this,e[is]),Il(this.h,e),ti(this,"refreshToken",this.h.a),jl(this,n||{}),En.call(this),this.P=!1,this.s&&Lr()&&(this.b=$c(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(t){return new ml((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.ba=T(this.ib,this);var o=this;this.za=null,this.Pa=function(t){o.xa(t.h)},this.qa=null,this.Ba=function(t){kl(o,t.c)},this.$=null,this.aa=[],this.Oa=function(t){Pl(o,t.f)},this.ja=null,this.S=new gl(this,n),ti(this,"multiFactor",this.S)}function kl(t,e){t.u=e,ls(t.a,e),t.b&&(e=t.b,t.b=$c(t.s,t.l,t.m,t.u),t.P&&(Vc(e,t),qc(t.b,t)))}function Nl(t,e){t.qa&&vn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&fn(e,"languageCodeChanged",t.Pa)}function Al(t,e){t.$&&vn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&fn(e,"emulatorConfigChanged",t.Ba)}function Pl(t,e){t.aa=e,fs(t.a,r.default.SDK_VERSION?Rr(r.default.SDK_VERSION,t.aa):null)}function Ol(t,e){t.ja&&vn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&fn(e,"frameworkChanged",t.Oa)}function Rl(t){try{return r.default.app(t.m).auth()}catch(e){throw new N("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function xl(t){t.J||t.D.b||(t.D.start(),vn(t,"tokenChanged",t.ba),fn(t,"tokenChanged",t.ba))}function Dl(t){vn(t,"tokenChanged",t.ba),t.D.stop()}function Ml(t,e){t.Aa=e,ti(t,"_lat",e)}function Ll(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return xe(e).then((function(){return t}))}function Fl(t){t.b&&!t.P&&(t.P=!0,qc(t.b,t))}function jl(t,e){ei(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new El(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Ul(){}function ql(t){return Pe().then((function(){if(t.J)throw new N("app-deleted")}))}function Vl(t){return Q(t.providerData,(function(t){return t.providerId}))}function Bl(t,e){e&&(Kl(t,e.providerId),t.providerData.push(e))}function Kl(t,e){J(t.providerData,(function(t){return t.providerId==e}))}function Wl(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&ti(t,e,n)}function Hl(t,e){t!=e&&(ei(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?ti(t,"metadata",function(t){return new El(t.a,t.b)}(e.metadata)):ti(t,"metadata",new El),G(e.providerData,(function(e){Bl(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),ti(t,"refreshToken",t.h.a),yl(t.S,e.S.b))}function Gl(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return cu(t.a,qs,{idToken:e}).then(T(t.Kc,t))}(t,e).then((function(){return n||Wl(t,"isAnonymous",!1),e}))}))}function zl(t,e){e[is]&&t.Aa!=e[is]&&(Il(t.h,e),t.dispatchEvent(new vl("tokenChanged")),Ml(t,e[is]),Wl(t,"refreshToken",t.h.a))}function Ql(t,e){return Gl(t).then((function(){if($(Vl(t),e))return Ll(t).then((function(){throw new N("provider-already-linked")}))}))}function Yl(t,e,n){return ni({user:t,credential:Ko(e),additionalUserInfo:e=to(e),operationType:n})}function $l(t,e){return zl(t,e),t.reload().then((function(){return t}))}function Xl(t,e,n,i,o){if(!Lr())return Oe(new N("operation-not-supported-in-this-environment"));if(t.i&&!o)return Oe(t.i);var a=Zi(n.providerId),s=Kr(t.uid+":::"),u=null;(!Ur()||Er())&&t.s&&n.isOAuthProvider&&(u=Eu(t.s,t.l,t.m,e,n,null,s,r.default.SDK_VERSION||null,null,null,t.tenantId,t.u));var c=br(u,a&&a.va,a&&a.ua);return i=i().then((function(){if(Zl(t),!o)return t.I().then((function(){}))})).then((function(){return Wc(t.b,c,e,n,s,!!u,t.tenantId)})).then((function(){return new Te((function(n,r){t.na(e,null,new N("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=s,t.c=zc(t.b,t,e,c,s)}))})).then((function(t){return c&&mr(c),t?ni(t):null})).o((function(t){throw c&&mr(c),t})),th(t,i,o)}function Jl(t,e,n,r,i){if(!Lr())return Oe(new N("operation-not-supported-in-this-environment"));if(t.i&&!i)return Oe(t.i);var o=null,a=Kr(t.uid+":::");return r=r().then((function(){if(Zl(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,Ll(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(rh,t.w(),e.a)),e})).then((function(){return Gc(t.b,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return ih(t.ha);throw o})).then((function(){if(o)throw o})),th(t,r,i)}function Zl(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new N("internal-error");throw new N("auth-domain-config-required")}}function th(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Oe(t.i)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new vl("userInvalidated")),t.i=e),e}))}(t,e,n);return t.N.push(r),r.oa((function(){X(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=hl(e.w(),Rl(t),T(t.jc,t))),n||e}))}function eh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[is]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new Cl(e,n,t);return t.providerData&&G(t.providerData,(function(t){t&&Bl(i,ni(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function nh(t){this.a=t,this.b=sc()}sl.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then((function(t){var n=yt(e.f);return delete n[ul],delete n[cl],bt(n,t),e.g(n)}))},C(ll,N),fl.prototype.tb=function(t,e,n){return e.type==ho?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},"undefined"!==typeof r&&(n.displayName=r),bt(n,{phoneVerificationInfo:qo(t.a)}),cu(e,js,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return bt(n={mfaPendingCredential:n},{phoneVerificationInfo:qo(t.a)}),cu(e,Us,n)}))}(this,t,e)},C(pl,fl),C(dl,pl),C(vl,Ze),(t=gl.prototype).yc=function(t){yl(this,function(t){var e=[];return G(t.mfaInfo||[],(function(t){(t=oi(t))&&e.push(t)})),e}(t.hd))},t.Sb=function(){return this.a.I().then((function(t){return new lo(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then((function(n){return t.tb(r,n,e)})).then((function(t){return zl(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"===typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return cu(r,uu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=z(e.b,(function(t){return t.uid!=n}));return yl(e,r),zl(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:Q(this.b,(function(t){return t.w()}))}}},ml.prototype.start=function(){this.a=this.c,bl(this,!0)},ml.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},_l.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},_l.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Oe(new N("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?Tl(this,{grant_type:"refresh_token",refresh_token:this.a}):Pe(null):Pe({accessToken:this.b.toString(),refreshToken:this.a})},El.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},C(Cl,En),Cl.prototype.xa=function(t){this.za=t,cs(this.a,t)},Cl.prototype.la=function(){return this.za},Cl.prototype.Ga=function(){return tt(this.aa)},Cl.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},ti(Cl.prototype,"providerId","firebase"),(t=Cl.prototype).reload=function(){var t=this;return th(this,ql(this).then((function(){return Gl(t).then((function(){return Ll(t)})).then(Ul)})))},t.oc=function(t){return this.I(t).then((function(t){return new al(t)}))},t.I=function(t){var e=this;return th(this,ql(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new N("internal-error");return t.accessToken!=e.Aa&&(Ml(e,t.accessToken),e.dispatchEvent(new vl("tokenChanged"))),Wl(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new N("internal-error");jl(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?Q(t,(function(t){return new Sl(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Bl(this,e[n]);Wl(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new vl("userReloaded",{hd:t}))},t.Lc=function(t){return Jr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},t.ub=function(t){var e=this,n=null;return th(this,t.c(this.a,this.uid).then((function(t){return zl(e,t),n=Yl(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Jr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},t.rb=function(t){var e=this,n=null;return th(this,Ql(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Yl(e,t,"link"),$l(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return th(this,Ql(this,"phone").then((function(){return ol(Rl(n),t,e,T(n.rb,n))})))},t.Mc=function(t,e){var n=this;return th(this,Pe().then((function(){return ol(Rl(n),t,e,T(n.ub,n))})),!0)},t.Cb=function(t){var e=this;return th(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return zl(e,t),e.reload()})))},t.ed=function(t){var e=this;return th(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return zl(e,t),e.reload()})))},t.Db=function(t){var e=this;return th(this,this.I().then((function(n){return e.a.Db(n,t)})).then((function(t){return zl(e,t),e.reload()})))},t.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return ql(this);var e=this;return th(this,this.I().then((function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return zl(e,t),Wl(e,"displayName",t.displayName||null),Wl(e,"photoURL",t.photoUrl||null),G(e.providerData,(function(t){"password"===t.providerId&&(ti(t,"displayName",e.displayName),ti(t,"photoURL",e.photoURL))})),Ll(e)})).then(Ul))},t.cd=function(t){var e=this;return th(this,Gl(this).then((function(n){return $(Vl(e),t)?function(t,e,n){return cu(t,Ms,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return G(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),G(Vl(e),(function(t){n[t]||Kl(e,t)})),n[Vo.PROVIDER_ID]||ti(e,"phoneNumber",null),Ll(e)})):Ll(e).then((function(){throw new N("no-such-provider")}))})))},t.delete=function(){var t=this;return th(this,this.I().then((function(e){return cu(t.a,Ds,{idToken:e})})).then((function(){t.dispatchEvent(new vl("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");Nl(t,null),Al(t,null),Ol(t,null),t.N=[],t.J=!0,Dl(t),ti(t,"refreshToken",null),t.b&&Vc(t.b,t)}))},t.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?T(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?T(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?T(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?T(this.Mb,this):null},t.Ec=function(t){var e=this;return Xl(this,"linkViaPopup",t,(function(){return Ql(e,t.providerId).then((function(){return Ll(e)}))}),!1)},t.Nc=function(t){return Xl(this,"reauthViaPopup",t,(function(){return Pe()}),!0)},t.Fc=function(t){var e=this;return Jl(this,"linkViaRedirect",t,(function(){return Ql(e,t.providerId)}),!1)},t.Oc=function(t){return Jl(this,"reauthViaRedirect",t,(function(){return Pe()}),!0)},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return th(this,this.I().then((function(n){return ks(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Yl(i,t,"link"),$l(i,t)})).then((function(){return o})))},t.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return th(this,Pe().then((function(){return vo(Ns(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Yl(i,t,"reauthenticate"),zl(i,t),i.i=null,i.reload()})).then((function(){return o})),!0)},t.vb=function(t){var e=this,n=null;return th(this,this.I().then((function(e){return n=e,"undefined"===typeof t||gt(t)?{}:Wi(new Di(t))})).then((function(t){return e.a.vb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Fb=function(t,e){var n=this,r=null;return th(this,this.I().then((function(t){return r=t,"undefined"===typeof e||gt(e)?{}:Wi(new Di(e))})).then((function(e){return n.a.Fb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return th(this,t=vo(Pe(t),n.uid).then((function(t){return e=Yl(n,t,"reauthenticate"),zl(n,t),n.i=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&bt(t,this.metadata.w()),G(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),bt(t,this.S.w()),t};var rh={name:"redirectUser",F:"session"};function ih(t){return lc(t.b,rh,t.a)}function oh(t){this.a=t,this.b=sc(),this.c=null,this.f=function(t){var e=uh("local"),n=uh("session"),r=uh("none");return function(t,e,n){var r=cc(e,n),i=uc(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=Br(u.localStorage.getItem(r))}catch(s){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(sh,t.a).then((function(t){return t?uh(t):e}))}))}))})).then((function(e){return t.c=e,ah(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(uh("local"),this.a,T(this.g,this))}function ah(t,e){var n,r=[];for(n in oc)oc[n]!==e&&r.push(lc(t.b,uh(oc[n]),t.a));return r.push(lc(t.b,sh,t.a)),function(t){return new Te((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Re(t[s],E(o,s),a);else e(i)}))}(r)}oh.prototype.g=function(){var t=this,e=uh("local");fh(this,(function(){return Pe().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return ah(t,"local").then((function(){t.c=e}))}))}))};var sh={name:"persistence",F:"session"};function uh(t){return{name:"authUser",F:t}}function ch(t,e){return fh(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function lh(t){return fh(t,(function(){return lc(t.b,t.c,t.a)}))}function hh(t,e,n){return fh(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),eh(t||{})}))}))}function fh(t,e){return t.f=t.f.then(e,e),t.f}function ph(t){if(this.l=!1,ti(this,"settings",new rl),ti(this,"app",t),!Ih(this).options||!Ih(this).options.apiKey)throw new N("invalid-api-key");t=r.default.SDK_VERSION?Rr(r.default.SDK_VERSION):null,this.a=new ns(Ih(this).options&&Ih(this).options.apiKey,D(P),t),this.P=[],this.s=[],this.N=[],this.Pa=r.default.INTERNAL.createSubscribe(T(this.zc,this)),this.W=void 0,this.ib=r.default.INTERNAL.createSubscribe(T(this.Ac,this)),_h(this,null),this.i=new oh(Ih(this).options.apiKey+":"+Ih(this).name),this.D=new nh(Ih(this).options.apiKey+":"+Ih(this).name),this.$=Ch(this,function(t){var e=Ih(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(rh,t.a).then((function(t){return t&&e&&(t.authDomain=e),eh(t||{})}))}(t.D,Ih(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),ih(t.D)}));return Ch(t,e)}(t).then((function(){return hh(t.i,e,t.R)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return ch(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:lh(t.i)}))):null})).then((function(e){_h(t,e||null)}));return Ch(t,n)}(this)),this.h=Ch(this,function(t){return t.$.then((function(){return mh(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(uh("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=T(this.Zc,this),this.Ba=T(this.da,this),this.qa=T(this.mc,this),this.za=T(this.wc,this),this.Aa=T(this.xc,this),this.b=null,function(t){var e=Ih(t).options.authDomain,n=Ih(t).options.apiKey;e&&Lr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=$c(e,n,Ih(t).name,t.R),qc(t.b,t),Th(t)&&Fl(Th(t)),t.m){Fl(t.m);var r=t.m;r.xa(t.la()),Nl(r,t),Pl(r=t.m,t.J),Ol(r,t),kl(r=t.m,t.R),Al(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=T(this.delete,this),this.INTERNAL.logFramework=T(this.Gc,this),this.u=0,En.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.R){var t=Kn(this.R.url);t=ni({protocol:t.c,host:t.a,port:t.g,options:ni({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.R=null}function dh(t){Ze.call(this,"languageCodeChanged"),this.h=t}function vh(t){Ze.call(this,"emulatorConfigChanged"),this.c=t}function gh(t){Ze.call(this,"frameworkChanged"),this.f=t}function yh(t){return t.Oa||Oe(new N("auth-domain-config-required"))}function mh(t){if(!Lr())return Oe(new N("operation-not-supported-in-this-environment"));var e=yh(t).then((function(){return t.b.ra()})).then((function(t){return t?ni(t):null}));return Ch(t,e)}function bh(t,e){var n={};return n.apiKey=Ih(t).options.apiKey,n.authDomain=Ih(t).options.authDomain,n.appName=Ih(t).name,t.R&&(n.emulatorConfig=t.R),t.$.then((function(){return function(t,e,n,r){var i=new Cl(t,e);return n&&(i.ha=n),r&&Pl(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return Th(t)&&e.uid==Th(t).uid?(Hl(Th(t),e),t.da(e)):(_h(t,e),Fl(e),t.da(e))})).then((function(){Sh(t)}))}function _h(t,e){Th(t)&&(function(t,e){J(t.W,(function(t){return t==e}))}(Th(t),t.Ba),vn(Th(t),"tokenChanged",t.qa),vn(Th(t),"userDeleted",t.za),vn(Th(t),"userInvalidated",t.Aa),Dl(Th(t))),e&&(e.W.push(t.Ba),fn(e,"tokenChanged",t.qa),fn(e,"userDeleted",t.za),fn(e,"userInvalidated",t.Aa),0<t.u&&xl(e)),ti(t,"currentUser",e),e&&(e.xa(t.la()),Nl(e,t),Pl(e,t.J),Ol(e,t),kl(e,t.R),Al(e,t))}function wh(t,e){var n=null,r=null;return Ch(t,e.then((function(e){return n=Ko(e),r=to(e),bh(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=hl(e.w(),t,T(t.kc,t))),n||e})).then((function(){return ni({user:Th(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function Ih(t){return t.app}function Th(t){return t.currentUser}function Eh(t){return Th(t)&&Th(t)._lat||null}function Sh(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](Eh(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](Eh(t))}}function Ch(t,e){return t.P.push(e),e.oa((function(){X(t.P,e)})),e}function kh(){}function Nh(){this.a={},this.b=1e12}oh.prototype.yb=function(t){var e=null,n=this;return function(t){var e=new N("invalid-persistence-type"),n=new N("unsupported-persistence-type");t:{for(r in oc)if(oc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(Cr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!ju()&&"none"!==t)throw n;break;default:if(!Mr()&&"none"!==t)throw n}}(t),fh(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,ah(n,t)})).then((function(){if(n.c=uh(t),e)return n.b.set(n.c,e,n.a)})):Pe()}))},C(ph,En),C(dh,Ze),C(vh,Ze),C(gh,Ze),(t=ph.prototype).yb=function(t){return Ch(this,t=this.i.yb(t))},t.xa=function(t){this.aa===t||this.l||(this.aa=t,cs(this.a,this.aa),this.dispatchEvent(new dh(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=u.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new N("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&!t&&Ir().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.R={url:t,ec:e},this.settings.jb=!0,ls(this.a,this.R),this.dispatchEvent(new vh(this.R))}},t.Gc=function(t){this.J.push(t),fs(this.a,r.default.SDK_VERSION?Rr(r.default.SDK_VERSION,this.J):null),this.dispatchEvent(new gh(this.J))},t.Ga=function(){return tt(this.J)},t.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:Ih(this).options.apiKey,authDomain:Ih(this).options.authDomain,appName:Ih(this).name,currentUser:Th(this)&&Th(this).w()}},t.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?T(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return wh(i,Cs(i.a,o))}))},t.Xc=function(t){if(!Lr())return Oe(new N("operation-not-supported-in-this-environment"));var e=this,n=Zi(t.providerId),i=Kr(),o=null;(!Ur()||Er())&&Ih(this).options.authDomain&&t.isOAuthProvider&&(o=Eu(Ih(this).options.authDomain,Ih(this).options.apiKey,Ih(this).name,"signInViaPopup",t,null,i,r.default.SDK_VERSION||null,null,null,this.T(),this.R));var a=br(o,n&&n.va,n&&n.ua);return Ch(this,n=yh(this).then((function(n){return Wc(n,a,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new Te((function(t,n){e.na("signInViaPopup",null,new N("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=zc(e.b,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&mr(a),t?ni(t):null})).o((function(t){throw a&&mr(a),t})))},t.Yc=function(t){if(!Lr())return Oe(new N("operation-not-supported-in-this-environment"));var e=this;return Ch(this,yh(this).then((function(){return function(t){return fh(t,(function(){return t.b.set(sh,t.c.F,t.a)}))}(e.i)})).then((function(){return Gc(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.ra=function(){var t=this;return mh(this).then((function(e){return t.b&&Zc(t.b.b),e})).o((function(e){throw t.b&&Zc(t.b.b),e}))},t.dd=function(t){if(!t)return Oe(new N("null-user"));if(this.S!=t.tenantId)return Oe(new N("tenant-id-mismatch"));var e=this,n={};n.apiKey=Ih(this).options.apiKey,n.authDomain=Ih(this).options.authDomain,n.appName=Ih(this).name;var r=function(t,e,n,r){var i=t.h,o={};return o[is]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new Cl(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&Pl(e,r),Hl(e,t),e}(t,n,e.D,e.Ga());return Ch(this,this.h.then((function(){if(Ih(e).options.apiKey!=t.l)return r.reload()})).then((function(){return Th(e)&&t.uid==Th(e).uid?(Hl(Th(e),t),e.da(t)):(_h(e,r),Fl(r),e.da(r))})).then((function(){Sh(e)})))},t.Bb=function(){var t=this;return Ch(this,this.h.then((function(){return t.b&&Zc(t.b.b),Th(t)?(_h(t,null),lh(t.i).then((function(){Sh(t)}))):Pe()})))},t.Zc=function(){var t=this;return hh(this.i,Ih(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=Th(t)&&e){n=Th(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Hl(Th(t),e),Th(t).I();(Th(t)||e)&&(_h(t,e),e&&(Fl(e),e.ha=t.D),t.b&&qc(t.b,t),Sh(t))}}))},t.da=function(t){return ch(this.i,t)},t.mc=function(){Sh(this),this.da(Th(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()},t.kc=function(t){var e=this;return this.h.then((function(){return wh(e,Pe(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(Th(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.N.push(e),Ch(t,t.h.then((function(){!t.l&&$(t.N,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(Eh(t)))})))}(this,(function(){t.next(Th(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"===typeof t?t(Th(r)):"function"===typeof t.next&&t.next(Th(r))})),this.Pa(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"===typeof t?t(Th(r)):"function"===typeof t.next&&t.next(Th(r))})),this.ib(t,e,n)},t.nc=function(t){var e=this;return Ch(this,this.h.then((function(){return Th(e)?Th(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return wh(e,cu(e.a,ru,{token:t}))})).then((function(t){var n=t.user;return Wl(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return wh(n,cu(n.a,iu,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return wh(n,cu(n.a,Rs,{email:t,password:e}))}))},t.ab=function(t){var e=this;return this.h.then((function(){return wh(e,t.ka(e.a))}))},t.Sc=function(t){return Jr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},t.Ab=function(){var t=this;return this.h.then((function(){var e=Th(t);if(e&&e.isAnonymous){var n=ni({providerId:null,isNewUser:!1});return ni({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return wh(t,t.a.Ab()).then((function(e){var n=e.user;return Wl(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return Th(this)&&Th(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&Th(this)&&xl(Th(this))},t.Pc=function(t){var e=this;G(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&Th(this)&&Dl(Th(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),Ch(this,this.h.then((function(){e.l||$(e.s,t)&&t(Eh(e))})))},t.removeAuthTokenListener=function(t){J(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(uh("local"),t.a,this.ja),this.b&&(Vc(this.b,this),Zc(this.b.b)),Promise.resolve()},t.hc=function(t){return Ch(this,function(t,e){return cu(t,xs,{identifier:e,continueUri:Fr()?dr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Fo(t)},t.xb=function(t,e){var n=this;return Ch(this,Pe().then((function(){var t=new Di(e);if(!t.c)throw new N("argument-error",Fi+" must be true when sending sign in link to email");return Wi(t)})).then((function(e){return n.a.xb(t,e)})).then((function(){})))},t.jd=function(t){return this.Sa(t).then((function(t){return t.data.email}))},t.ob=function(t,e){return Ch(this,this.a.ob(t,e).then((function(){})))},t.Sa=function(t){return Ch(this,this.a.Sa(t).then((function(t){return new hi(t)})))},t.kb=function(t){return Ch(this,this.a.kb(t).then((function(){})))},t.wb=function(t,e){var n=this;return Ch(this,Pe().then((function(){return"undefined"===typeof e||gt(e)?{}:Wi(new Di(e))})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.Wc=function(t,e){return Ch(this,ol(this,t,e,T(this.ab,this)))},t.Vc=function(t,e){var n=this;return Ch(this,Pe().then((function(){var r=e||dr(),i=Lo(t,r);if(!(r=Fo(r)))throw new N("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new N("tenant-id-mismatch");return n.ab(i)})))},kh.prototype.render=function(){},kh.prototype.reset=function(){},kh.prototype.getResponse=function(){},kh.prototype.execute=function(){};var Ah=null;function Ph(t,e){return(e=Oh(e))&&t.a[e]||null}function Oh(t){return(t="undefined"===typeof t?1e12:t)?t.toString():null}function Rh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=he(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():fn(this.f,"click",this.i)}function xh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Dh(){}function Mh(){}Nh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Rh(t,e),this.b++},Nh.prototype.reset=function(t){var e=Ph(this,t);t=Oh(t),e&&t&&(e.delete(),delete this.a[t])},Nh.prototype.getResponse=function(t){return(t=Ph(this,t))?t.getResponse():null},Nh.prototype.execute=function(t){(t=Ph(this,t))&&t.execute()},Rh.prototype.getResponse=function(){return xh(this),this.b},Rh.prototype.execute=function(){xh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},Rh.prototype.delete=function(){xh(this),this.g=!0,clearTimeout(this.a),this.a=null,vn(this.f,"click",this.i)},ti(Dh,"FACTOR_ID","phone"),Mh.prototype.g=function(){return Ah||(Ah=new Nh),Pe(Ah)},Mh.prototype.c=function(){};var Lh=null;function Fh(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var jh=new wt(St,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Uh=new Gr(3e4,6e4);Fh.prototype.g=function(t){var e=this;return new Te((function(n,r){var i=setTimeout((function(){r(new N("network-request-failed"))}),Uh.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new N("internal-error"));delete u[e.a]},Pe(Ya(At(jh,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new N("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},Fh.prototype.c=function(){this.b--};var qh=null;function Vh(t,e,n,r,i,o,a){if(ti(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,a?(Lh||(Lh=new Mh),a=Lh):(qh||(qh=new Fh),a=qh),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Wh])throw new N("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Hh],!u.document)throw new N("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!he(e)||!this.i&&he(e).hasChildNodes())throw new N("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new ns(t,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var c=this.a[Bh];this.a[Bh]=function(t){if(Gh(s,t),"function"===typeof c)c(t);else if("string"===typeof c){var e=Dr(c,u);"function"===typeof e&&e(t)}};var l=this.a[Kh];this.a[Kh]=function(){if(Gh(s,null),"function"===typeof l)l();else if("string"===typeof l){var t=Dr(l,u);"function"===typeof t&&t()}}}var Bh="callback",Kh="expired-callback",Wh="sitekey",Hh="size";function Gh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function zh(t,e){return t.h.push(e),e.oa((function(){X(t.h,e)})),e}function Qh(t){if(t.J)throw new N("internal-error","RecaptchaVerifier instance has been destroyed.")}function Yh(t,e,n){var i=!1;try{this.b=n||r.default.app()}catch(s){throw new N("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new N("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.default.SDK_VERSION?Rr(r.default.SDK_VERSION,a):null,Vh.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),a,D(P),i)}function $h(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new N("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Xh.length)throw new N("internal-error","Argument validator received an unsupported number of arguments.");n=Xh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new N("argument-error",t+" failed: "+r)}(t=Vh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=zh(this,Pe().then((function(){if(Fr()&&!Sr())return Ir();throw new N("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,cu(t.s,Gs,{})})).then((function(e){t.a[Wh]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Qh(this);var t=this;return zh(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=he(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!le&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Gt(a.name),'"'),a.type){o.push(' type="',Gt(a.type),'"');var s={};bt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ye(i,o),a&&("string"===typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):fe(o,a)),2<r.length&&ge(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Qh(this);var t=this;return zh(this,this.render().then((function(e){return new Te((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){J(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Qh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Qh(this),this.J=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=he(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},C(Yh,Vh);var Xh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Jh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"===typeof t}}}function Zh(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"===typeof t}}}function tf(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:g}}function ef(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"===typeof t}}}function nf(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function rf(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function of(t,e){return g(t)&&"string"===typeof t.type&&t.type===e&&"function"===typeof t.Ha}function af(t){return g(t)&&"string"===typeof t.uid}function sf(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function uf(t,e){for(var n in e){var r=e[n].name;t[r]=hf(r,t[n],e[n].j)}}function cf(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:E((function(t){return this[t]}),n),set:E((function(t,e,n,r){$h(t,[n],[r],!0),this[e]=r}),r,n,e[n].lb),enumerable:!0})}}function lf(t,e,n,r){t[e]=hf(e,n,r)}function hf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return $h(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}uf(ph.prototype,{kb:{name:"applyActionCode",j:[Jh("code")]},Sa:{name:"checkActionCode",j:[Jh("code")]},ob:{name:"confirmPasswordReset",j:[Jh("code"),Jh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Jh("email"),Jh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Jh("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Jh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[sf(tf(),ef(),"nextOrObserver"),ef("opt_error",!0),ef("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[sf(tf(),ef(),"nextOrObserver"),ef("opt_error",!0),ef("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Jh("email"),sf(tf("opt_actionCodeSettings",!0),nf(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Jh("email"),tf("actionCodeSettings")]},yb:{name:"setPersistence",j:[Jh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[rf()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[rf()]},Tc:{name:"signInWithCustomToken",j:[Jh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Jh("email"),Jh("password")]},Vc:{name:"signInWithEmailLink",j:[Jh("email"),Jh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[sf({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof Cl)}},nf(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Jh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Jh("url"),tf("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Jh("code")]}}),cf(ph.prototype,{lc:{name:"languageCode",lb:sf(Jh(),nf(),"languageCode")},ti:{name:"tenantId",lb:sf(Jh(),nf(),"tenantId")}}),ph.Persistence=oc,ph.Persistence.LOCAL="local",ph.Persistence.SESSION="session",ph.Persistence.NONE="none",uf(Cl.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Zh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Zh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[rf()]},rb:{name:"linkWithCredential",j:[rf()]},Dc:{name:"linkWithPhoneNumber",j:[Jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[rf()]},ub:{name:"reauthenticateWithCredential",j:[rf()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[sf(tf("opt_actionCodeSettings",!0),nf(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Jh(null,!0)]},cd:{name:"unlink",j:[Jh("provider")]},Cb:{name:"updateEmail",j:[Jh("email")]},Db:{name:"updatePassword",j:[Jh("password")]},ed:{name:"updatePhoneNumber",j:[rf("phone")]},Eb:{name:"updateProfile",j:[tf("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Jh("email"),sf(tf("opt_actionCodeSettings",!0),nf(null,!0),"opt_actionCodeSettings",!0)]}}),uf(Nh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),uf(kh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),uf(Te.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),cf(rl.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Zh("appVerificationDisabledForTesting")}}),uf(il.prototype,{confirm:{name:"confirm",j:[Jh("verificationCode")]}}),lf(po,"fromJSON",(function(t){t="string"===typeof t?JSON.parse(t):t;for(var e,n=[wo,Do,Uo,mo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[sf(Jh(),tf(),"json")]),lf(Mo,"credential",(function(t,e){return new xo(t,e)}),[Jh("email"),Jh("password")]),uf(xo.prototype,{w:{name:"toJSON",j:[Jh(null,!0)]}}),uf(So.prototype,{Ca:{name:"addScope",j:[Jh("scope")]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),lf(So,"credential",Co,[sf(Jh(),tf(),"token")]),lf(Mo,"credentialWithLink",Lo,[Jh("email"),Jh("emailLink")]),uf(ko.prototype,{Ca:{name:"addScope",j:[Jh("scope")]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),lf(ko,"credential",No,[sf(Jh(),tf(),"token")]),uf(Ao.prototype,{Ca:{name:"addScope",j:[Jh("scope")]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),lf(Ao,"credential",Po,[sf(Jh(),sf(tf(),nf()),"idToken"),sf(Jh(),nf(),"accessToken",!0)]),uf(Oo.prototype,{Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),lf(Oo,"credential",Ro,[sf(Jh(),tf(),"token"),Jh("secret",!0)]),uf(Eo.prototype,{Ca:{name:"addScope",j:[Jh("scope")]},credential:{name:"credential",j:[sf(Jh(),sf(tf(),nf()),"optionsOrIdToken"),sf(Jh(),nf(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),uf(bo.prototype,{w:{name:"toJSON",j:[Jh(null,!0)]}}),uf(go.prototype,{w:{name:"toJSON",j:[Jh(null,!0)]}}),lf(Vo,"credential",Bo,[Jh("verificationId"),Jh("verificationCode")]),uf(Vo.prototype,{gb:{name:"verifyPhoneNumber",j:[sf(Jh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?of(t.session,ho)&&"string"===typeof t.phoneNumber:t.session&&t.multiFactorHint?of(t.session,fo)&&af(t.multiFactorHint):t.session&&t.multiFactorUid?of(t.session,fo)&&"string"===typeof t.multiFactorUid:!!t.phoneNumber&&"string"===typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]}}),uf(jo.prototype,{w:{name:"toJSON",j:[Jh(null,!0)]}}),uf(N.prototype,{toJSON:{name:"toJSON",j:[Jh(null,!0)]}}),uf(Xo.prototype,{toJSON:{name:"toJSON",j:[Jh(null,!0)]}}),uf($o.prototype,{toJSON:{name:"toJSON",j:[Jh(null,!0)]}}),uf(ll.prototype,{toJSON:{name:"toJSON",j:[Jh(null,!0)]}}),uf(sl.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}]}}),uf(gl.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}},Jh("displayName",!0)]},bd:{name:"unenroll",j:[sf({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:af},Jh(),"multiFactorInfoIdentifier")]}}),uf(Yh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),lf(Si,"parseLink",xi,[Jh("link")]),lf(Dh,"assertion",(function(t){return new dl(t)}),[rf("phone")]),function(){if("undefined"===typeof r.default||!r.default.INTERNAL||!r.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:pi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:fi,VERIFY_AND_CHANGE_EMAIL:di,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:ph,AuthCredential:po,Error:N};lf(t,"EmailAuthProvider",Mo,[]),lf(t,"FacebookAuthProvider",So,[]),lf(t,"GithubAuthProvider",ko,[]),lf(t,"GoogleAuthProvider",Ao,[]),lf(t,"TwitterAuthProvider",Oo,[]),lf(t,"OAuthProvider",Eo,[Jh("providerId")]),lf(t,"SAMLAuthProvider",To,[Jh("providerId")]),lf(t,"PhoneAuthProvider",Vo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof ph)}}]),lf(t,"RecaptchaVerifier",Yh,[sf(Jh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),tf("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.default.app.App)}}]),lf(t,"ActionCodeURL",Si,[]),lf(t,"PhoneMultiFactorGenerator",Dh,[]),r.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new ph(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),r.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:T((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:T(t.nc,t),addAuthTokenListener:T(t.cc,t),removeAuthTokenListener:T(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.default.registerVersion("@firebase/auth","0.16.8"),r.default.INTERNAL.extendNamespace({User:Cl})}()}).apply("undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});n(7790);var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function o(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function u(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create;var c=n(8448),l=n(4594),h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function f(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var p,d="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},v=v||{},g=d||self;function y(){}function m(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function b(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),w=0;function I(t,e,n){return t.call.apply(t.bind,arguments)}function T(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function E(t,e,n){return(E=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?I:T).apply(null,arguments)}function S(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function C(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function k(){this.s=this.s,this.o=this.o}var N={};k.prototype.s=!1,k.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++w)}(this);delete N[t]}},k.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var A=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},P=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function O(t){return Array.prototype.concat.apply([],arguments)}function R(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function x(t){return/^[\s\xa0]*$/.test(t)}var D,M=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function L(t,e){return-1!=t.indexOf(e)}function F(t,e){return t<e?-1:t>e?1:0}t:{var j=g.navigator;if(j){var U=j.userAgent;if(U){D=U;break t}}D=""}function q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function V(t){var e={};for(var n in t)e[n]=t[n];return e}var B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function K(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<B.length;o++)n=B[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function W(t){return W[" "](t),t}W[" "]=y;var H,G=L(D,"Opera"),z=L(D,"Trident")||L(D,"MSIE"),Q=L(D,"Edge"),Y=Q||z,$=L(D,"Gecko")&&!(L(D.toLowerCase(),"webkit")&&!L(D,"Edge"))&&!(L(D,"Trident")||L(D,"MSIE"))&&!L(D,"Edge"),X=L(D.toLowerCase(),"webkit")&&!L(D,"Edge");function J(){var t=g.document;return t?t.documentMode:void 0}t:{var Z="",tt=function(){var t=D;return $?/rv:([^\);]+)(\)|;)/.exec(t):Q?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):X?/WebKit\/(\S+)/.exec(t):G?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(tt&&(Z=tt?tt[1]:""),z){var et=J();if(null!=et&&et>parseFloat(Z)){H=String(et);break t}}H=Z}var nt,rt={};function it(){return function(t){var e=rt;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=M(String(H)).split("."),n=M("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;t=F(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||F(0==o[2].length,0==a[2].length)||F(o[2],a[2]),o=o[3],a=a[3]}while(0==t)}return 0<=t}))}if(g.document&&z){var ot=J();nt=ot||(parseInt(H,10)||void 0)}else nt=void 0;var at=nt,st=function(){if(!g.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{g.addEventListener("test",y,e),g.removeEventListener("test",y,e)}catch(n){}return t}();function ut(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function ct(t,e){if(ut.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if($){t:{try{W(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:lt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ct.Z.h.call(this)}}ut.prototype.h=function(){this.defaultPrevented=!0},C(ct,ut);var lt={2:"touch",3:"pen",4:"mouse"};ct.prototype.h=function(){ct.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ht="closure_listenable_"+(1e6*Math.random()|0),ft=0;function pt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++ft,this.ca=this.fa=!1}function dt(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function vt(t){this.src=t,this.g={},this.h=0}function gt(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=A(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(dt(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function yt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}vt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var a=yt(t,e,r,i);return-1<a?(e=t[a],n||(e.fa=!1)):((e=new pt(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var mt="closure_lm_"+(1e6*Math.random()|0),bt={};function _t(t,e,n,r,i){if(r&&r.once)return It(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)_t(t,e[o],n,r,i);return null}return n=At(n),t&&t[ht]?t.N(e,n,b(r)?!!r.capture:!!r,i):wt(t,e,n,!1,r,i)}function wt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=b(i)?!!i.capture:!!i,s=kt(t);if(s||(t[mt]=s=new vt(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=Ct;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)st||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(St(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function It(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);return null}return n=At(n),t&&t[ht]?t.O(e,n,b(r)?!!r.capture:!!r,i):wt(t,e,n,!0,r,i)}function Tt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Tt(t,e[o],n,r,i);else r=b(r)?!!r.capture:!!r,n=At(n),t&&t[ht]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=yt(o=t.g[e],n,r,i))&&(dt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=kt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=yt(e,n,r,i)),(n=-1<t?e[t]:null)&&Et(n))}function Et(t){if("number"!==typeof t&&t&&!t.ca){var e=t.src;if(e&&e[ht])gt(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(St(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=kt(e))?(gt(n,t),0==n.h&&(n.src=null,e[mt]=null)):dt(t)}}}function St(t){return t in bt?bt[t]:bt[t]="on"+t}function Ct(t,e){if(t.ca)t=!0;else{e=new ct(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Et(t),t=n.call(r,e)}return t}function kt(t){return(t=t[mt])instanceof vt?t:null}var Nt="__closure_events_fn_"+(1e9*Math.random()>>>0);function At(t){return"function"===typeof t?t:(t[Nt]||(t[Nt]=function(e){return t.handleEvent(e)}),t[Nt])}function Pt(){k.call(this),this.i=new vt(this),this.P=this,this.I=null}function Ot(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"===typeof e)e=new ut(e,t);else if(e instanceof ut)e.target=e.target||t;else{var i=e;K(e=new ut(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.g=n[o];i=Rt(a,r,!0,e)&&i}if(i=Rt(a=e.g=t,r,!0,e)&&i,i=Rt(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Rt(a=e.g=n[o],r,!1,e)&&i}function Rt(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ca&&a.capture==n){var s=a.listener,u=a.ia||a.src;a.fa&&gt(t.i,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}C(Pt,k),Pt.prototype[ht]=!0,Pt.prototype.removeEventListener=function(t,e,n,r){Tt(this,t,e,n,r)},Pt.prototype.M=function(){if(Pt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)dt(n[r]);delete e.g[t],e.h--}}this.I=null},Pt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Pt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var xt=g.JSON.stringify;function Dt(){var t=Bt,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Mt,Lt=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Ft=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new jt}),(function(t){return t.reset()})),jt=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Ut(t){g.setTimeout((function(){throw t}),0)}function qt(t,e){Mt||function(){var t=g.Promise.resolve(void 0);Mt=function(){t.then(Kt)}}(),Vt||(Mt(),Vt=!0),Bt.add(t,e)}var Vt=!1,Bt=new Lt;function Kt(){for(var t;t=Dt();){try{t.h.call(t.g)}catch(n){Ut(n)}var e=Ft;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Vt=!1}function Wt(t,e){Pt.call(this),this.h=t||1,this.g=e||g,this.j=E(this.kb,this),this.l=Date.now()}function Ht(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Gt(t,e,n){if("function"===typeof t)n&&(t=E(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=E(t.handleEvent,t)}return 2147483647<Number(e)?-1:g.setTimeout(t,e||0)}function zt(t){t.g=Gt((function(){t.g=null,t.i&&(t.i=!1,zt(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}C(Wt,Pt),(p=Wt.prototype).da=!1,p.S=null,p.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Ot(this,"tick"),this.da&&(Ht(this),this.start()))}},p.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},p.M=function(){Wt.Z.M.call(this),Ht(this),delete this.g};var Qt=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:zt(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(g.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(k);function Yt(t){k.call(this),this.h=t,this.g={}}C(Yt,k);var $t=[];function Xt(t,e,n,r){Array.isArray(n)||(n&&($t[0]=n.toString()),n=$t);for(var i=0;i<n.length;i++){var o=_t(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Jt(t){q(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Et(t)}),t),t.g={}}function Zt(){this.g=!0}function te(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return xt(n)}catch(s){return e}}(t,n)+(r?" "+r:"")}))}Yt.prototype.M=function(){Yt.Z.M.call(this),Jt(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Zt.prototype.Aa=function(){this.g=!1},Zt.prototype.info=function(){};var ee={},ne=null;function re(){return ne=ne||new Pt}function ie(t){ut.call(this,ee.Ma,t)}function oe(t){var e=re();Ot(e,new ie(e,t))}function ae(t,e){ut.call(this,ee.STAT_EVENT,t),this.stat=e}function se(t){var e=re();Ot(e,new ae(e,t))}function ue(t,e){ut.call(this,ee.Na,t),this.size=e}function ce(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return g.setTimeout((function(){t()}),e)}ee.Ma="serverreachability",C(ie,ut),ee.STAT_EVENT="statevent",C(ae,ut),ee.Na="timingevent",C(ue,ut);var le={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},he={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function fe(){}function pe(t){return t.h||(t.h=t.i())}function de(){}fe.prototype.h=null;var ve,ge={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ye(){ut.call(this,"d")}function me(){ut.call(this,"c")}function be(){}function _e(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Yt(this),this.P=Ie,t=Y?125:void 0,this.W=new Wt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new we}function we(){this.i=null,this.g="",this.h=!1}C(ye,ut),C(me,ut),C(be,fe),be.prototype.g=function(){return new XMLHttpRequest},be.prototype.i=function(){return{}},ve=new be;var Ie=45e3,Te={},Ee={};function Se(t,e,n){t.K=1,t.v=Qe(Be(e)),t.s=n,t.U=!0,Ce(t,null)}function Ce(t,e){t.F=Date.now(),Pe(t),t.A=Be(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),un(n.h,"t",r),t.C=0,n=t.l.H,t.h=new we,t.g=lr(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Qt(E(t.Ia,t,t.g),t.O)),Xt(t.V,t.g,"readystatechange",t.gb),e=t.H?V(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),oe(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function ke(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ne(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Ae(t,n))==Ee){4==e&&(t.o=4,se(14),i=!1),te(t.j,t.m,null,"[Incomplete Response]");break}if(r==Te){t.o=4,se(15),te(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}te(t.j,t.m,r,null),Me(t,r)}ke(t)&&r!=Ee&&r!=Te&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,se(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),nr(e),e.L=!0,se(11))):(te(t.j,t.m,n,"[Invalid Chunked Response]"),De(t),xe(t))}function Ae(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ee:(n=Number(e.substring(n,r)),isNaN(n)?Te:(r+=1)+n>e.length?Ee:(e=e.substr(r,n),t.C=r+n,e))}function Pe(t){t.Y=Date.now()+t.P,Oe(t,t.P)}function Oe(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ce(E(t.eb,t),e)}function Re(t){t.B&&(g.clearTimeout(t.B),t.B=null)}function xe(t){0==t.l.G||t.I||or(t.l,t)}function De(t){Re(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ht(t.W),Jt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Me(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||gn(n.i,t)))if(n.I=t.N,!t.J&&gn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;ir(n),zn(n)}er(n),se(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=ce(E(n.ab,n),6e3));if(1>=vn(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else sr(n,11)}else if((t.J||n.g==t)&&ir(n),!x(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var a=o[3];null!=a&&(n.ma=a,n.h.info("VER="+n.ma));var s=o[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(L(l,"spdy")||L(l,"quic")||L(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(yn(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,ze(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=cr(r,r.H?r.la:null,r.W),p.J){mn(r.i,p);var d=p,v=r.K;v&&d.setTimeout(v),d.B&&(Re(d),Pe(d)),r.g=p}else tr(r);0<n.l.length&&$n(n)}else"stop"!=o[0]&&"close"!=o[0]||sr(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?sr(n,7):Gn(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}oe(4)}catch(o){}}function Le(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(m(t)||"string"===typeof t)P(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(m(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"===typeof t)return t.split("");if(m(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fe(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function je(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Ue(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Ue(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Ue(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(p=_e.prototype).setTimeout=function(t){this.P=t},p.gb=function(t){t=t.target;var e=this.L;e&&3==Vn(t)?e.l():this.Ia(t)},p.Ia=function(t){try{if(t==this.g)t:{var e=Vn(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||Y||this.g&&(this.h.h||this.g.ga()||Bn(this.g)))){this.I||4!=e||7==n||oe(8==n||0>=r?3:2),Re(this);var i=this.g.ba();this.N=i;e:if(ke(this)){var o=Bn(this.g);t="";var a=o.length,s=4==Vn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){De(this),xe(this);var u="";break e}this.h.i=new g.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:s&&n==a-1});o.splice(0,a),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,se(12),De(this),xe(this);break t}te(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Me(this,i)}this.U?(Ne(this,e,u),Y&&this.i&&3==e&&(Xt(this.V,this.W,"tick",this.fb),this.W.start())):(te(this.j,this.m,u,null),Me(this,u)),4==e&&De(this),this.i&&!this.I&&(4==e?or(this.l,this):(this.i=!1,Pe(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,se(12)):(this.o=0,se(13)),De(this),xe(this)}}}catch(e){}},p.fb=function(){if(this.g){var t=Vn(this.g),e=this.g.ga();this.C<e.length&&(Re(this),Ne(this,t,e),this.i&&4!=t&&Pe(this))}},p.cancel=function(){this.I=!0,De(this)},p.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(oe(3),se(17)),De(this),this.o=2,xe(this)):Oe(this,this.Y-t)},(p=Fe.prototype).R=function(){je(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},p.T=function(){return je(this),this.g.concat()},p.get=function(t,e){return Ue(this.h,t)?this.h[t]:e},p.set=function(t,e){Ue(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},p.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ve(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Ve){this.g=void 0!==e?e:t.g,Ke(this,t.j),this.s=t.s,We(this,t.i),He(this,t.m),this.l=t.l,e=t.h;var n=new rn;n.i=e.i,e.g&&(n.g=new Fe(e.g),n.h=e.h),Ge(this,n),this.o=t.o}else t&&(n=String(t).match(qe))?(this.g=!!e,Ke(this,n[1]||"",!0),this.s=Ye(n[2]||""),We(this,n[3]||"",!0),He(this,n[4]),this.l=Ye(n[5]||"",!0),Ge(this,n[6]||"",!0),this.o=Ye(n[7]||"")):(this.g=!!e,this.h=new rn(null,this.g))}function Be(t){return new Ve(t)}function Ke(t,e,n){t.j=n?Ye(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function We(t,e,n){t.i=n?Ye(e,!0):e}function He(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ge(t,e,n){e instanceof rn?(t.h=e,function(t,e){e&&!t.j&&(on(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(an(this,e),un(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=$e(e,en)),t.h=new rn(e,t.g))}function ze(t,e,n){t.h.set(e,n)}function Qe(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ye(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $e(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,Xe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Xe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ve.prototype.toString=function(){var t=[],e=this.j;e&&t.push($e(e,Je,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push($e(e,Je,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push($e(n,"/"==n.charAt(0)?tn:Ze,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",$e(n,nn)),t.join("")};var Je=/[#\/\?@]/g,Ze=/[#\?:]/g,tn=/[#\?]/g,en=/[#\?@]/g,nn=/#/g;function rn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function on(t){t.g||(t.g=new Fe,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function an(t,e){on(t),e=cn(t,e),Ue(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Ue((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&je(t)))}function sn(t,e){return on(t),e=cn(t,e),Ue(t.g.h,e)}function un(t,e,n){an(t,e),0<n.length&&(t.i=null,t.g.set(cn(t,e),R(n)),t.h+=n.length)}function cn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(p=rn.prototype).add=function(t,e){on(this),this.i=null,t=cn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},p.forEach=function(t,e){on(this),this.g.forEach((function(n,r){P(n,(function(n){t.call(e,n,r,this)}),this)}),this)},p.T=function(){on(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},p.R=function(t){on(this);var e=[];if("string"===typeof t)sn(this,t)&&(e=O(e,this.g.get(cn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=O(e,t[n])}return e},p.set=function(t,e){return on(this),this.i=null,sn(this,t=cn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},p.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},p.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.i=t.join("&")};var ln=function(t,e){this.h=t,this.g=e};function hn(t){this.l=t||pn,g.PerformanceNavigationTiming?t=0<(t=g.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(g.g&&g.g.Ea&&g.g.Ea()&&g.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var fn,pn=10;function dn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function vn(t){return t.h?1:t.g?t.g.size:0}function gn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function yn(t,e){t.g?t.g.add(e):t.h=e}function mn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function bn(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=f(t.g.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.D)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return R(t.i)}function _n(){}function wn(){this.g=new _n}function In(t,e,n){var r=n||"";try{Le(t,(function(t,n){var i=t;b(t)&&(i=xt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(Hp){throw e.push(r+"type="+encodeURIComponent("_badmap")),Hp}}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function En(t){this.l=t.$b||null,this.j=t.ib||!1}function Sn(t,e){Pt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Cn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}hn.prototype.cancel=function(){var t,e;if(this.i=bn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=f(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},_n.prototype.stringify=function(t){return g.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return g.JSON.parse(t,void 0)},C(En,fe),En.prototype.g=function(){return new Sn(this.l,this.j)},En.prototype.i=(fn={},function(){return fn}),C(Sn,Pt);var Cn=0;function kn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Nn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,An(t)}function An(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(p=Sn.prototype).open=function(t,e){if(this.readyState!=Cn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,An(this)},p.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||g).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},p.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Nn(this)),this.readyState=Cn},p.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,An(this)),this.g&&(this.readyState=3,An(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof g.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;kn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},p.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Nn(this):An(this),3==this.readyState&&kn(this)}},p.Ua=function(t){this.g&&(this.response=this.responseText=t,Nn(this))},p.Ta=function(t){this.g&&(this.response=t,Nn(this))},p.ha=function(){this.g&&Nn(this)},p.setRequestHeader=function(t,e){this.v.append(t,e)},p.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},p.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Sn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Pn=g.JSON.parse;function On(t){Pt.call(this),this.headers=new Fe,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Rn,this.K=this.L=!1}C(On,Pt);var Rn="",xn=/^https?$/i,Dn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Ln(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Fn(t),Un(t)}function Fn(t){t.D||(t.D=!0,Ot(t,"complete"),Ot(t,"error"))}function jn(t){if(t.h&&"undefined"!=typeof v&&(!t.C[1]||4!=Vn(t)||2!=t.ba()))if(t.v&&4==Vn(t))Gt(t.Fa,0,t);else if(Ot(t,"readystatechange"),4==Vn(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(qe)[1]||null;if(!o&&g.self&&g.self.location){var a=g.self.location.protocol;o=a.substr(0,a.length-1)}i=!xn.test(o?o.toLowerCase():"")}e=i}if(e)Ot(t,"complete"),Ot(t,"success");else{t.m=6;try{var s=2<Vn(t)?t.g.statusText:""}catch(u){s=""}t.j=s+" ["+t.ba()+"]",Fn(t)}}finally{Un(t)}}}function Un(t,e){if(t.g){qn(t);var n=t.g,r=t.C[0]?y:null;t.g=null,t.C=null,e||Ot(t,"ready");try{n.onreadystatechange=r}catch(Hp){}}}function qn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(g.clearTimeout(t.A),t.A=null)}function Vn(t){return t.g?t.g.readyState:0}function Bn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Rn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return q(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):ze(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.za=0,this.l=[],this.h=new Zt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Wn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Wn("baseRetryDelayMs",5e3,t),this.$a=Wn("retryDelaySeedMs",1e4,t),this.Ya=Wn("forwardChannelMaxRetries",2,t),this.ra=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new hn(t&&t.concurrentRequestLimit),this.Ca=new wn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Gn(t){if(Qn(t),3==t.G){var e=t.V++,n=Be(t.F);ze(n,"SID",t.J),ze(n,"RID",e),ze(n,"TYPE","terminate"),Jn(t,n),(e=new _e(t,t.h,e,void 0)).K=2,e.v=Qe(Be(n)),n=!1,g.navigator&&g.navigator.sendBeacon&&(n=g.navigator.sendBeacon(e.v.toString(),"")),!n&&g.Image&&((new Image).src=e.v,n=!0),n||(e.g=lr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Pe(e)}ur(t)}function zn(t){t.g&&(nr(t),t.g.cancel(),t.g=null)}function Qn(t){zn(t),t.u&&(g.clearTimeout(t.u),t.u=null),ir(t),t.i.cancel(),t.m&&("number"===typeof t.m&&g.clearTimeout(t.m),t.m=null)}function Yn(t,e){t.l.push(new ln(t.Za++,e)),3==t.G&&$n(t)}function $n(t){dn(t.i)||t.m||(t.m=!0,qt(t.Ha,t),t.C=0)}function Xn(t,e){var n;n=e?e.m:t.V++;var r=Be(t.F);ze(r,"SID",t.J),ze(r,"RID",n),ze(r,"AID",t.U),Jn(t,r),t.o&&t.s&&Kn(r,t.o,t.s),n=new _e(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),yn(t.i,n),Se(n,r,e)}function Jn(t,e){t.j&&Le({},(function(t,n){ze(e,n,t)}))}function Zn(t,e,n){n=Math.min(t.l.length,n);var r=t.j?E(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].h,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),s=!1;else try{In(l,a,"req"+c+"_")}catch(Qr){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function tr(t){t.g||t.u||(t.Y=1,qt(t.Ga,t),t.A=0)}function er(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=ce(E(t.Ga,t),ar(t,t.A)),t.A++,!0)}function nr(t){null!=t.B&&(g.clearTimeout(t.B),t.B=null)}function rr(t){t.g=new _e(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Be(t.oa);ze(e,"RID","rpc"),ze(e,"SID",t.J),ze(e,"CI",t.N?"0":"1"),ze(e,"AID",t.U),Jn(t,e),ze(e,"TYPE","xmlhttp"),t.o&&t.s&&Kn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Qe(Be(e)),n.s=null,n.U=!0,Ce(n,t)}function ir(t){null!=t.v&&(g.clearTimeout(t.v),t.v=null)}function or(t,e){var n=null;if(t.g==e){ir(t),nr(t),t.g=null;var r=2}else{if(!gn(t.i,e))return;n=e.D,mn(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Ot(r=re(),new ue(r,n,e,i)),$n(t)}else tr(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(vn(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=ce(E(t.Ha,t,e),ar(t,t.C)),t.C++,!0))}(t,e)||2==r&&er(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function ar(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function sr(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=E(t.jb,t);n||(n=new Ve("//www.google.com/images/cleardot.gif"),g.location&&"http"==g.location.protocol||Ke(n,"https"),Qe(n)),function(t,e){var n=new Zt;if(g.Image){var r=new Image;r.onload=S(Tn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=S(Tn,n,r,"TestLoadImage: error",!1,e),r.onabort=S(Tn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=S(Tn,n,r,"TestLoadImage: timeout",!1,e),g.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else se(2);t.G=0,t.j&&t.j.va(e),ur(t),Qn(t)}function ur(t){t.G=0,t.I=-1,t.j&&(0==bn(t.i).length&&0==t.l.length||(t.i.i.length=0,R(t.l),t.l.length=0),t.j.ua())}function cr(t,e,n){var r=function(t){return t instanceof Ve?Be(t):new Ve(t,void 0)}(n);if(""!=r.i)e&&We(r,e+"."+r.i),He(r,r.m);else{var i=g.location;r=function(t,e,n,r){var i=new Ve(null,void 0);return t&&Ke(i,t),e&&We(i,e),n&&He(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&q(t.aa,(function(t,e){ze(r,e,t)})),e=t.D,n=t.sa,e&&n&&ze(r,e,n),ze(r,"VER",t.ma),Jn(t,r),r}function lr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new On(new En({ib:!0})):new On(t.qa)).L=t.H,e}function hr(){}function fr(){if(z&&!(10<=Number(at)))throw Error("Environmental error: no available transport.")}function pr(t,e){Pt.call(this),this.g=new Hn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!x(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!x(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new gr(this)}function dr(t){ye.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function vr(){me.call(this),this.status=1}function gr(t){this.g=t}(p=On.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ve.g(),this.C=this.u?pe(this.u):pe(ve),this.g.onreadystatechange=E(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Ln(this,o)}t=n||"";var i=new Fe(this.headers);r&&Le(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Mn,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(i.T()),n=g.FormData&&t instanceof g.FormData,!(0<=A(Dn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{qn(this),0<this.B&&((this.K=function(t){return z&&it()&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=E(this.pa,this)):this.A=Gt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Ln(this,o)}},p.pa=function(){"undefined"!=typeof v&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ot(this,"timeout"),this.abort(8))},p.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ot(this,"complete"),Ot(this,"abort"),Un(this))},p.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Un(this,!0)),On.Z.M.call(this)},p.Fa=function(){this.s||(this.F||this.v||this.l?jn(this):this.cb())},p.cb=function(){jn(this)},p.ba=function(){try{return 2<Vn(this)?this.g.status:-1}catch(fn){return-1}},p.ga=function(){try{return this.g?this.g.responseText:""}catch(fn){return""}},p.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},p.Da=function(){return this.m},p.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(p=Hn.prototype).ma=8,p.G=1,p.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},p.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new _e(this,this.h,t,void 0),n=this.s;if(this.P&&(n?K(n=V(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"===typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Zn(this,e,r),ze(i=Be(this.F),"RID",t),ze(i,"CVER",22),this.D&&ze(i,"X-HTTP-Session-Id",this.D),Jn(this,i),this.o&&n&&Kn(i,this.o,n),yn(this.i,e),this.Ra&&ze(i,"TYPE","init"),this.ja?(ze(i,"$req",r),ze(i,"SID","null"),e.$=!0,Se(e,i,null)):Se(e,i,r),this.G=2}}else 3==this.G&&(t?Xn(this,t):0==this.l.length||dn(this.i)||Xn(this))},p.Ga=function(){if(this.u=null,rr(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ce(E(this.bb,this),t)}},p.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,se(10),zn(this),rr(this))},p.ab=function(){null!=this.v&&(this.v=null,zn(this),er(this),se(19))},p.jb=function(t){t?(this.h.info("Successfully pinged google.com"),se(2)):(this.h.info("Failed to ping google.com"),se(1))},(p=hr.prototype).xa=function(){},p.wa=function(){},p.va=function(){},p.ua=function(){},p.Oa=function(){},fr.prototype.g=function(t,e){return new pr(t,e)},C(pr,Pt),pr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),qt(E(t.hb,t,e))),se(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=cr(t,null,t.W),$n(t)},pr.prototype.close=function(){Gn(this.g)},pr.prototype.u=function(t){if("string"===typeof t){var e={};e.__data__=t,Yn(this.g,e)}else this.v?((e={}).__data__=xt(t),Yn(this.g,e)):Yn(this.g,t)},pr.prototype.M=function(){this.g.j=null,delete this.j,Gn(this.g),delete this.g,pr.Z.M.call(this)},C(dr,ye),C(vr,me),C(gr,hr),gr.prototype.xa=function(){Ot(this.g,"a")},gr.prototype.wa=function(t){Ot(this.g,new dr(t))},gr.prototype.va=function(t){Ot(this.g,new vr(t))},gr.prototype.ua=function(){Ot(this.g,"b")},fr.prototype.createWebChannel=fr.prototype.g,pr.prototype.send=pr.prototype.u,pr.prototype.open=pr.prototype.m,pr.prototype.close=pr.prototype.close,le.NO_ERROR=0,le.TIMEOUT=8,le.HTTP_ERROR=6,he.COMPLETE="complete",de.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",Pt.prototype.listen=Pt.prototype.N,On.prototype.listenOnce=On.prototype.O,On.prototype.getLastError=On.prototype.La,On.prototype.getLastErrorCode=On.prototype.Da,On.prototype.getStatus=On.prototype.ba,On.prototype.getResponseJson=On.prototype.Qa,On.prototype.getResponseText=On.prototype.ga,On.prototype.send=On.prototype.ea;var yr=function(){return new fr},mr=function(){return re()},br=le,_r=he,wr=ee,Ir={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Tr=En,Er=de,Sr=On,Cr=n(4155),kr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();kr.o=-1;var Nr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ar=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return o(e,t),e}(Error),Pr=new l.Logger("@firebase/firestore");function Or(){return Pr.logLevel}function Rr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=l.LogLevel.DEBUG){var r=e.map(Mr);Pr.debug.apply(Pr,u(["Firestore (8.7.0): "+t],r))}}function xr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=l.LogLevel.ERROR){var r=e.map(Mr);Pr.error.apply(Pr,u(["Firestore (8.7.0): "+t],r))}}function Dr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=l.LogLevel.WARN){var r=e.map(Mr);Pr.warn.apply(Pr,u(["Firestore (8.7.0): "+t],r))}}function Mr(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Lr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Fr(t,e){t||Lr()}function jr(t,e){return t}function Ur(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var qr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ur(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Vr(t,e){return t<e?-1:t>e?1:0}function Br(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Kr(t){return t+"\0"}var Wr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ar(Nr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ar(Nr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ar(Nr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ar(Nr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Hr=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Wr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Gr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Yr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),$r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Yr),Xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Jr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Xr.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ar(Nr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ar(Nr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ar(Nr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Yr),Zr=function(){function t(t){this.fields=t,t.sort(Jr.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Br(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ti=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Vr(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();ti.EMPTY_BYTE_STRING=new ti("");var ei=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ni(t){if(Fr(!!t),"string"==typeof t){var e=0,n=ei.exec(t);if(Fr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ri(t.seconds),nanos:ri(t.nanos)}}function ri(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ii(t){return"string"==typeof t?ti.fromBase64String(t):ti.fromUint8Array(t)}function oi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ai(t){var e=t.mapValue.fields.__previous_value__;return oi(e)?ai(e):e}function si(t){var e=ni(t.mapValue.fields.__local_write_time__.timestampValue);return new Wr(e.seconds,e.nanos)}function ui(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}function li(t){return"number"==typeof t&&Number.isInteger(t)&&!ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var hi=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t($r.fromString(e))},t.fromName=function(e){return new t($r.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===$r.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return $r.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new $r(e.slice()))},t}();function fi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oi(t)?4:10:Lr()}function pi(t,e){var n=fi(t);if(n!==fi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return si(t).isEqual(si(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ni(t.timestampValue),r=ni(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ii(t.bytesValue).isEqual(ii(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ri(t.geoPointValue.latitude)===ri(e.geoPointValue.latitude)&&ri(t.geoPointValue.longitude)===ri(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ri(t.integerValue)===ri(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ri(t.doubleValue),r=ri(e.doubleValue);return n===r?ci(n)===ci(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Br(t.arrayValue.values||[],e.arrayValue.values||[],pi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Gr(n)!==Gr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!pi(n[i],r[i])))return!1;return!0}(t,e);default:return Lr()}}function di(t,e){return void 0!==(t.values||[]).find((function(t){return pi(t,e)}))}function vi(t,e){var n=fi(t),r=fi(e);if(n!==r)return Vr(n,r);switch(n){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ri(t.integerValue||t.doubleValue),r=ri(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return gi(t.timestampValue,e.timestampValue);case 4:return gi(si(t),si(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ii(t),r=ii(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Vr(ri(t.latitude),ri(e.latitude));return 0!==n?n:Vr(ri(t.longitude),ri(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=vi(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=Vr(r[a],o[a]);if(0!==s)return s;var u=vi(n[r[a]],i[o[a]]);if(0!==u)return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function gi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=ni(t),r=ni(e),i=Vr(n.seconds,r.seconds);return 0!==i?i:Vr(n.nanos,r.nanos)}function yi(t){return mi(t)}function mi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ni(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ii(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,hi.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=mi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+mi(t.fields[o])}return e+"}"}(t.mapValue):Lr();var e,n}function bi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function _i(t){return!!t&&"integerValue"in t}function wi(t){return!!t&&"arrayValue"in t}function Ii(t){return!!t&&"nullValue"in t}function Ti(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ei(t){return!!t&&"mapValue"in t}function Si(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},ni(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return zr(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Si(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Si(t.arrayValue.values[r]);return n}return Object.assign({},t)}var Ci=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ei(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Si(e)},t.prototype.setAll=function(t){var e=this,n=Jr.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var a=e.getFieldsMap(n);e.applyChanges(a,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Si(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ei(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return pi(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ei(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){zr(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Si(this.value))},t}();function ki(t){var e=[];return zr(t.fields,(function(t,n){var r=new Jr([t]);if(Ei(n)){var i=ki(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new Zr(e)}var Ni=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Hr.min(),Ci.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Ci.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Ci.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Ci.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Ci.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ai=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function Pi(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new Ai(t,e,n,r,i,o,a)}function Oi(t){var e=jr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+yi(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ui(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Wi(e.startAt)),e.endAt&&(n+="|ub:",n+=Wi(e.endAt)),e.h=n}return e.h}function Ri(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Gi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!pi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qi(t.startAt,e.startAt)&&Qi(t.endAt,e.endAt)}function xi(t){return hi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Di=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return o(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Mi(t,n,r):"array-contains"===n?new Ui(t,r):"in"===n?new qi(t,r):"not-in"===n?new Vi(t,r):"array-contains-any"===n?new Bi(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Li(t,n):new Fi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(vi(e,this.value)):null!==e&&fi(this.value)===fi(e)&&this.m(vi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Lr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Mi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=hi.fromName(r.referenceValue),i}return o(e,t),e.prototype.matches=function(t){var e=hi.comparator(t.key,this.key);return this.m(e)},e}(Di),Li=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ji("in",n),r}return o(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Di),Fi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ji("not-in",n),r}return o(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Di);function ji(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return hi.fromName(t.referenceValue)}))}var Ui=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return o(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return wi(e)&&di(e.arrayValue,this.value)},e}(Di),qi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return o(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&di(this.value.arrayValue,e)},e}(Di),Vi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return o(e,t),e.prototype.matches=function(t){if(di(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!di(this.value.arrayValue,e)},e}(Di),Bi=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return o(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!wi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return di(e.value.arrayValue,t)}))},e}(Di),Ki=function(t,e){this.position=t,this.before=e};function Wi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return yi(t)})).join(",")}var Hi=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Gi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function zi(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?hi.comparator(hi.fromName(a.referenceValue),n.key):vi(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!pi(t.position[n],e.position[n]))return!1;return!0}var Yi=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function $i(t,e,n,r,i,o,a,s){return new Yi(t,e,n,r,i,o,a,s)}function Xi(t){return new Yi(t)}function Ji(t){return!ui(t.limit)&&"F"===t.limitType}function Zi(t){return!ui(t.limit)&&"L"===t.limitType}function to(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function eo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function no(t){return null!==t.collectionGroup}function ro(t){var e=jr(t);if(null===e.p){e.p=[];var n=eo(e),r=to(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Hi(n)),e.p.push(new Hi(Jr.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Hi(Jr.keyField(),u))}}}return e.p}function io(t){var e=jr(t);if(!e.T)if("F"===e.limitType)e.T=Pi(e.path,e.collectionGroup,ro(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ro(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Hi(o.field,a))}var s=e.endAt?new Ki(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ki(e.startAt.position,!e.startAt.before):null;e.T=Pi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function oo(t,e,n){return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ao(t,e){return Ri(io(t),io(e))&&t.limitType===e.limitType}function so(t){return Oi(io(t))+"|lt:"+t.limitType}function uo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+yi(e.value);var e})).join(", ")+"]"),ui(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Wi(t.startAt)),t.endAt&&(e+=", endAt: "+Wi(t.endAt)),"Target("+e+")"}(io(t))+"; limitType="+t.limitType+")"}function co(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):hi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!zi(t.startAt,ro(t),e))&&(!t.endAt||!zi(t.endAt,ro(t),e))}(t,e)}function lo(t){return function(e,n){for(var r=!1,i=0,o=ro(t);i<o.length;i++){var a=o[i],s=ho(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function ho(t,e,n){var r=t.field.isKeyField()?hi.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?vi(r,i):Lr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Lr()}}function fo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function po(t){return{integerValue:""+t}}function vo(t,e){return li(e)?po(e):fo(t,e)}var go=function(){this._=void 0};function yo(t,e,n){return t instanceof _o?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof wo?Io(t,e):t instanceof To?Eo(t,e):function(t,e){var n=bo(t,e),r=Co(n)+Co(t.A);return _i(n)&&_i(t.A)?po(r):fo(t.R,r)}(t,e)}function mo(t,e,n){return t instanceof wo?Io(t,e):t instanceof To?Eo(t,e):n}function bo(t,e){return t instanceof So?_i(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var _o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(go),wo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return o(e,t),e}(go);function Io(t,e){for(var n=ko(e),r=function(t){n.some((function(e){return pi(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var To=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return o(e,t),e}(go);function Eo(t,e){for(var n=ko(e),r=function(t){n=n.filter((function(e){return!pi(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var So=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return o(e,t),e}(go);function Co(t){return ri(t.integerValue||t.doubleValue)}function ko(t){return wi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var No=function(t,e){this.field=t,this.transform=e},Ao=function(t,e){this.version=t,this.transformResults=e},Po=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Oo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ro=function(){};function xo(t,e,n){t instanceof jo?function(t,e,n){var r=t.value.clone(),i=Vo(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Uo?function(t,e,n){if(Oo(t.precondition,e)){var r=Vo(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(qo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Do(t,e,n){t instanceof jo?function(t,e,n){if(Oo(t.precondition,e)){var r=t.value.clone(),i=Bo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Fo(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Uo?function(t,e,n){if(Oo(t.precondition,e)){var r=Bo(t.fieldTransforms,n,e),i=e.data;i.setAll(qo(t)),i.setAll(r),e.convertToFoundDocument(Fo(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Oo(t.precondition,e)&&e.convertToNoDocument(Hr.min())}(t,e)}function Mo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=bo(o.transform,a||null);null!=s&&(null==n&&(n=Ci.empty()),n.set(o.field,s))}return n||null}function Lo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Br(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof wo&&e instanceof wo||t instanceof To&&e instanceof To?Br(t.elements,e.elements,pi):t instanceof So&&e instanceof So?pi(t.A,e.A):t instanceof _o&&e instanceof _o}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Fo(t){return t.isFoundDocument()?t.version:Hr.min()}var jo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return o(e,t),e}(Ro),Uo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return o(e,t),e}(Ro);function qo(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Vo(t,e,n){var r=new Map;Fr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,mo(a,s,n[i]))}return r}function Bo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,yo(s,u,e))}return r}var Ko,Wo,Ho=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return o(e,t),e}(Ro),Go=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return o(e,t),e}(Ro),zo=function(t){this.count=t};function Qo(t){switch(t){case Nr.OK:return Lr();case Nr.CANCELLED:case Nr.UNKNOWN:case Nr.DEADLINE_EXCEEDED:case Nr.RESOURCE_EXHAUSTED:case Nr.INTERNAL:case Nr.UNAVAILABLE:case Nr.UNAUTHENTICATED:return!1;case Nr.INVALID_ARGUMENT:case Nr.NOT_FOUND:case Nr.ALREADY_EXISTS:case Nr.PERMISSION_DENIED:case Nr.FAILED_PRECONDITION:case Nr.ABORTED:case Nr.OUT_OF_RANGE:case Nr.UNIMPLEMENTED:case Nr.DATA_LOSS:return!0;default:return Lr()}}function Yo(t){if(void 0===t)return xr("GRPC error has no .code"),Nr.UNKNOWN;switch(t){case Ko.OK:return Nr.OK;case Ko.CANCELLED:return Nr.CANCELLED;case Ko.UNKNOWN:return Nr.UNKNOWN;case Ko.DEADLINE_EXCEEDED:return Nr.DEADLINE_EXCEEDED;case Ko.RESOURCE_EXHAUSTED:return Nr.RESOURCE_EXHAUSTED;case Ko.INTERNAL:return Nr.INTERNAL;case Ko.UNAVAILABLE:return Nr.UNAVAILABLE;case Ko.UNAUTHENTICATED:return Nr.UNAUTHENTICATED;case Ko.INVALID_ARGUMENT:return Nr.INVALID_ARGUMENT;case Ko.NOT_FOUND:return Nr.NOT_FOUND;case Ko.ALREADY_EXISTS:return Nr.ALREADY_EXISTS;case Ko.PERMISSION_DENIED:return Nr.PERMISSION_DENIED;case Ko.FAILED_PRECONDITION:return Nr.FAILED_PRECONDITION;case Ko.ABORTED:return Nr.ABORTED;case Ko.OUT_OF_RANGE:return Nr.OUT_OF_RANGE;case Ko.UNIMPLEMENTED:return Nr.UNIMPLEMENTED;case Ko.DATA_LOSS:return Nr.DATA_LOSS;default:return Lr()}}(Wo=Ko||(Ko={}))[Wo.OK=0]="OK",Wo[Wo.CANCELLED=1]="CANCELLED",Wo[Wo.UNKNOWN=2]="UNKNOWN",Wo[Wo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wo[Wo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wo[Wo.NOT_FOUND=5]="NOT_FOUND",Wo[Wo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wo[Wo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wo[Wo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wo[Wo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wo[Wo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wo[Wo.ABORTED=10]="ABORTED",Wo[Wo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wo[Wo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wo[Wo.INTERNAL=13]="INTERNAL",Wo[Wo.UNAVAILABLE=14]="UNAVAILABLE",Wo[Wo.DATA_LOSS=15]="DATA_LOSS";var $o=function(){function t(t,e){this.comparator=t,this.root=e||Jo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Jo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Xo(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Xo(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Xo(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Xo(this.root,t,this.comparator,!0)},t}(),Xo=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Jo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Lr();if(this.right.isRed())throw Lr();var t=this.left.check();if(t!==this.right.check())throw Lr();return t+(this.isRed()?0:1)},t}();Jo.EMPTY=null,Jo.RED=!0,Jo.BLACK=!1,Jo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Jo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Zo=function(){function t(t){this.comparator=t,this.data=new $o(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ta(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ta(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ta=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),ea=new $o(hi.comparator);function na(){return ea}var ra=new $o(hi.comparator);function ia(){return ra}var oa=new $o(hi.comparator);function aa(){return oa}var sa=new Zo(hi.comparator);function ua(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=sa,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ca=new Zo(Vr);function la(){return ca}var ha=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,fa.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Hr.min(),r,la(),na(),ua())},t}(),fa=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ti.EMPTY_BYTE_STRING,n,ua(),ua(),ua())},t}(),pa=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},da=function(t,e){this.targetId=t,this.V=e},va=function(t,e,n,r){void 0===n&&(n=ti.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ga=function(){function t(){this.S=0,this.D=ba(),this.C=ti.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=ua(),e=ua(),n=ua();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Lr()}})),new fa(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=ba()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),ya=function(){function t(t){this.W=t,this.G=new Map,this.H=na(),this.J=ma(),this.Y=new Zo(Vr)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Lr()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(xi(i))if(0===n){var o=new hi(i.path);this.tt(e,o,Ni.newNoDocument(o,Hr.min()))}else Fr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&xi(o.target)){var a=new hi(o.target.path);null!==e.H.get(a)||e.at(i,a)||e.tt(i,a,Ni.newNoDocument(a,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=ua();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new ha(t,n,this.Y,this.H,r);return this.H=na(),this.J=ma(),this.Y=new Zo(Vr),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new ga,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Zo(Vr),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new ga),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ma(){return new $o(hi.comparator)}function ba(){return new $o(hi.comparator)}var _a={asc:"ASCENDING",desc:"DESCENDING"},wa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ia=function(t,e){this.databaseId=t,this.I=e};function Ta(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ea(t,e){return t.I?e.toBase64():e.toUint8Array()}function Sa(t,e){return Ta(t,e.toTimestamp())}function Ca(t){return Fr(!!t),Hr.fromTimestamp(function(t){var e=ni(t);return new Wr(e.seconds,e.nanos)}(t))}function ka(t,e){return function(t){return new $r(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Na(t){var e=$r.fromString(t);return Fr(Ja(e)),e}function Aa(t,e){return ka(t.databaseId,e.path)}function Pa(t,e){var n=Na(e);if(n.get(1)!==t.databaseId.projectId)throw new Ar(Nr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ar(Nr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new hi(Da(n))}function Oa(t,e){return ka(t.databaseId,e)}function Ra(t){var e=Na(t);return 4===e.length?$r.emptyPath():Da(e)}function xa(t){return new $r(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Da(t){return Fr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Ma(t,e,n){return{name:Aa(t,e),fields:n.value.mapValue.fields}}function La(t,e,n){var r=Pa(t,e.name),i=Ca(e.updateTime),o=new Ci({mapValue:{fields:e.fields}}),a=Ni.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Fa(t,e){var n;if(e instanceof jo)n={update:Ma(t,e.key,e.value)};else if(e instanceof Ho)n={delete:Aa(t,e.key)};else if(e instanceof Uo)n={update:Ma(t,e.key,e.data),updateMask:Xa(e.fieldMask)};else{if(!(e instanceof Go))return Lr();n={verify:Aa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof _o)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof To)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof So)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Lr()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Sa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Lr()}(t,e.precondition)),n}function ja(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Po.updateTime(Ca(t.updateTime)):void 0!==t.exists?Po.exists(t.exists):Po.none()}(e.currentDocument):Po.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Fr("REQUEST_TIME"===e.setToServerValue),n=new _o;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new wo(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new To(i)}else"increment"in e?n=new So(t,e.increment):Lr();var o=Jr.fromServerFormat(e.fieldPath);return new No(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Pa(t,e.update.name),o=new Ci({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Zr(e.map((function(t){return Jr.fromServerFormat(t)})))}(e.updateMask);return new Uo(i,o,a,n,r)}return new jo(i,o,n,r)}if(e.delete){var s=Pa(t,e.delete);return new Ho(s,n)}if(e.verify){var u=Pa(t,e.verify);return new Go(u,n)}return Lr()}function Ua(t,e){return{documents:[Oa(t,e.path)]}}function qa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Oa(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Oa(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ti(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NAN"}};if(Ii(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ti(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NOT_NAN"}};if(Ii(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:za(t.field),op:Ga(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:za(t.field),direction:Ha(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||ui(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ka(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ka(e.endAt)),n}function Va(t){var e=Ra(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Fr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=Ba(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Hi(Qa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ui(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Wa(n.startAt));var l=null;return n.endAt&&(l=Wa(n.endAt)),$i(e,i,s,a,u,"F",c,l)}function Ba(t){return t?void 0!==t.unaryFilter?[$a(t)]:void 0!==t.fieldFilter?[Ya(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Ba(t)})).reduce((function(t,e){return t.concat(e)})):Lr():[]}function Ka(t){return{before:t.before,values:t.position}}function Wa(t){var e=!!t.before,n=t.values||[];return new Ki(n,e)}function Ha(t){return _a[t]}function Ga(t){return wa[t]}function za(t){return{fieldPath:t.canonicalString()}}function Qa(t){return Jr.fromServerFormat(t.fieldPath)}function Ya(t){return Di.create(Qa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(t.fieldFilter.op),t.fieldFilter.value)}function $a(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Qa(t.unaryFilter.field);return Di.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Qa(t.unaryFilter.field);return Di.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Qa(t.unaryFilter.field);return Di.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Qa(t.unaryFilter.field);return Di.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}function Xa(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Ja(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Za(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=es(e)),e=ts(t.get(n),e);return es(e)}function ts(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function es(t){return t+"\x01\x01"}function ns(t){var e=t.length;if(Fr(e>=2),2===e)return Fr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),$r.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("\x01",o);switch((a<0||a>n)&&Lr(),t.charAt(a+1)){case"\x01":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=t.substring(o,a),i+="\0";break;case"\x11":i+=t.substring(o,a+1);break;default:Lr()}o=a+2}return new $r(r)}var rs=function(t,e){this.seconds=t,this.nanoseconds=e},is=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};is.store="owner",is.key="owner";var os=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};os.store="mutationQueues",os.keyPath="userId";var as=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};as.store="mutations",as.keyPath="batchId",as.userMutationsIndex="userMutationsIndex",as.userMutationsKeyPath=["userId","batchId"];var ss=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Za(e)]},t.key=function(t,e,n){return[t,Za(e),n]},t}();ss.store="documentMutations",ss.PLACEHOLDER=new ss;var us=function(t,e){this.path=t,this.readTime=e},cs=function(t,e){this.path=t,this.version=e},ls=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ls.store="remoteDocuments",ls.readTimeIndex="readTimeIndex",ls.readTimeIndexPath="readTime",ls.collectionReadTimeIndex="collectionReadTimeIndex",ls.collectionReadTimeIndexPath=["parentPath","readTime"];var hs=function(t){this.byteSize=t};hs.store="remoteDocumentGlobal",hs.key="remoteDocumentGlobalKey";var fs=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};fs.store="targets",fs.keyPath="targetId",fs.queryTargetsIndexName="queryTargetsIndex",fs.queryTargetsKeyPath=["canonicalId","targetId"];var ps=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ps.store="targetDocuments",ps.keyPath=["targetId","path"],ps.documentTargetsIndex="documentTargetsIndex",ps.documentTargetsKeyPath=["path","targetId"];var ds=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ds.key="targetGlobalKey",ds.store="targetGlobal";var vs=function(t,e){this.collectionId=t,this.parent=e};vs.store="collectionParents",vs.keyPath=["collectionId","parent"];var gs=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};gs.store="clientMetadata",gs.keyPath="clientId";var ys=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ys.store="bundles",ys.keyPath="bundleId";var ms=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ms.store="namedQueries",ms.keyPath="name";var bs=u(u([],u(u([],u(u([],u(u([],[os.store,as.store,ss.store,ls.store,fs.store,is.store,ds.store,ps.store]),[gs.store])),[hs.store])),[vs.store])),[ys.store,ms.store]),_s="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ws=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Is=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Ts=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Lr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Es=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Is,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new ks(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Rs(e.target.error);n.ft.reject(new ks(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ks(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new As(e)},t}(),Ss=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t((0,c.getUA)())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Rr("SimpleDb","Removing database:",t),Ps(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=(0,c.getUA)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof Cr&&"YES"===(null===(t=Cr.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return a(this,void 0,void 0,(function(){var e,n=this;return s(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ks(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Ar(Nr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ks(t,n))},i.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Rr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return a(this,void 0,void 0,(function(){var i,o,a,u,c;return s(this,(function(l){switch(l.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,c,l,h;return s(this,(function(s){switch(s.label){case 0:++o,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=s.sent(),e=Es.open(u.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),Ts.reject(t)})).toPromise(),c={},a.catch((function(){})),[4,e.dt];case 3:return[2,(c.value=(s.sent(),a),c)];case 4:return l=s.sent(),h="FirebaseError"!==l.name&&o<3,Rr("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),u.close(),h?[3,5]:[2,{value:Promise.reject(l)}];case 5:return[2]}}))},u=this,l.label=1;case 1:return[5,a()];case 2:if("object"==typeof(c=l.sent()))return[2,c.value];l.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Cs=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ps(this.Pt.delete())},t}(),ks=function(t){function e(e,n){var r=this;return(r=t.call(this,Nr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return o(e,t),e}(Ar);function Ns(t){return"IndexedDbTransactionError"===t.name}var As=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ps(n)},t.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),Ps(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ps(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Rr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),Ps(this.store.delete(t))},t.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),Ps(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Ts((function(n,r){e.onerror=function(t){var e=Rs(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Ts((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Cs(i),a=e(i.primaryKey,i.value,o);if(a instanceof Ts){var s=a.catch((function(t){return o.done(),Ts.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Ts.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ps(t){return new Ts((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Rs(t.target.error);n(e)}}))}var Os=!1;function Rs(t){var e=Ss._t((0,c.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ar("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Os||(Os=!0,setTimeout((function(){throw r}),0)),r}}return t}var xs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return o(e,t),e}(ws);function Ds(t,e){var n=jr(t);return Ss.It(n.Mt,e)}var Ms=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&xo(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Do(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Do(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Hr.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ua())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Br(this.mutations,t.mutations,(function(t,e){return Lo(t,e)}))&&Br(this.baseMutations,t.baseMutations,(function(t,e){return Lo(t,e)}))},t}(),Ls=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Fr(e.mutations.length===r.length);for(var i=aa(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),Fs=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Hr.min()),void 0===o&&(o=Hr.min()),void 0===a&&(a=ti.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),js=function(t){this.Lt=t};function Us(t,e){if(e.document)return La(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=hi.fromSegments(e.noDocument.path),r=Ws(e.noDocument.readTime),i=Ni.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=hi.fromSegments(e.unknownDocument.path);return r=Ws(e.unknownDocument.version),Ni.newUnknownDocument(o,r)}return Lr()}function qs(t,e,n){var r=Vs(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Aa(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ta(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new ls(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=Ks(e.version);return a=e.hasCommittedMutations,new ls(null,new us(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=Ks(e.version);return new ls(new cs(c,l),null,null,!0,r,i)}return Lr()}function Vs(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Bs(t){var e=new Wr(t[0],t[1]);return Hr.fromTimestamp(e)}function Ks(t){var e=t.toTimestamp();return new rs(e.seconds,e.nanoseconds)}function Ws(t){var e=new Wr(t.seconds,t.nanoseconds);return Hr.fromTimestamp(e)}function Hs(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ja(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return ja(t.Lt,e)})),s=Wr.fromMillis(e.localWriteTimeMs);return new Ms(e.batchId,s,n,a)}function Gs(t){var e,n,r=Ws(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ws(t.lastLimboFreeSnapshotVersion):Hr.min();return void 0!==t.query.documents?(Fr(1===(n=t.query).documents.length),e=io(Xi(Ra(n.documents[0])))):e=function(t){return io(Va(t))}(t.query),new Fs(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ti.fromBase64String(t.resumeToken))}function zs(t,e){var n,r=Ks(e.snapshotVersion),i=Ks(e.lastLimboFreeSnapshotVersion);n=xi(e.target)?Ua(t.Lt,e.target):qa(t.Lt,e.target);var o=e.resumeToken.toBase64();return new fs(e.targetId,Oi(e.target),r,o,e.sequenceNumber,i,n)}function Qs(t){var e=Va({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?oo(e,e.limit,"L"):e}var Ys=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return $s(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Ws(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return $s(t).put({bundleId:(n=e).id,createTime:Ks(Ca(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Xs(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Qs(e.bundledQuery),readTime:Ws(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Xs(t).put(function(t){return{name:t.name,readTime:Ks(Ca(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function $s(t){return Ds(t,ys.store)}function Xs(t){return Ds(t,ms.store)}var Js=function(){function t(){this.Bt=new Zs}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Ts.resolve()},t.prototype.getCollectionParents=function(t,e){return Ts.resolve(this.Bt.getEntries(e))},t}(),Zs=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Zo($r.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Zo($r.comparator)).toArray()},t}(),tu=function(){function t(){this.qt=new Zs}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Za(i)};return eu(t).put(o)}return Ts.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Kr(e),""],!1,!0);return eu(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ns(o.parent))}return n}))},t}();function eu(t){return Ds(t,vs.store)}var nu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ru=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function iu(t,e,n){var r=t.store(as.store),i=t.store(ss.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){Fr(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=ss.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Ts.waitFor(o).next((function(){return c}))}function ou(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}ru.DEFAULT_COLLECTION_PERCENTILE=10,ru.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ru.DEFAULT=new ru(41943040,ru.DEFAULT_COLLECTION_PERCENTILE,ru.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ru.DISABLED=new ru(-1,0,0);var au=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Fr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uu(t).$t({index:as.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=cu(t),a=uu(t);return a.add({}).next((function(s){Fr("number"==typeof s);for(var u=new Ms(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Fa(t.Lt,e)})),i=n.mutations.map((function(e){return Fa(t.Lt,e)}));return new as(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Zo((function(t,e){return Vr(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],v=ss.key(i.userId,d.key.path,s);h=h.add(d.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,ss.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[s]=u.keys()})),Ts.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return uu(t).get(e).next((function(t){return t?(Fr(t.userId===n.userId),Hs(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Ts.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return uu(t).$t({index:as.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Fr(e.batchId>=r),o=Hs(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return uu(t).$t({index:as.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return uu(t).Nt(as.userMutationsIndex,n).next((function(t){return t.map((function(t){return Hs(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ss.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return cu(t).$t({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=ns(u);if(s===n.userId&&e.path.isEqual(l))return uu(t).get(c).next((function(t){if(!t)throw Lr();Fr(t.userId===n.userId),o.push(Hs(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Zo(Vr),i=[];return e.forEach((function(e){var o=ss.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=cu(t).$t({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=ns(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),Ts.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=ss.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Zo(Vr);return cu(t).$t({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],l=ns(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(uu(t).get(e).next((function(t){if(null===t)throw Lr();Fr(t.userId===n.userId),r.push(Hs(n.R,t))})))})),Ts.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return iu(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Ts.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Ts.resolve();var r=IDBKeyRange.lowerBound(ss.prefixForUser(e.userId)),i=[];return cu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ns(t[1]);i.push(o)}else r.done()})).next((function(){Fr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return su(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return lu(t).get(this.userId).next((function(t){return t||new os(e.userId,-1,"")}))},t}();function su(t,e,n){var r=ss.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return cu(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function uu(t){return Ds(t,as.store)}function cu(t){return Ds(t,ss.store)}function lu(t){return Ds(t,os.store)}var hu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),fu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new hu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Hr.fromTimestamp(new Wr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return pu(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Fr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return pu(t).$t((function(a,s){var u=Gs(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Ts.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return pu(t).$t((function(t,n){var r=Gs(n);e(r)}))},t.prototype.Xt=function(t){return du(t).get(ds.key).next((function(t){return Fr(null!==t),t}))},t.prototype.Zt=function(t,e){return du(t).put(ds.key,e)},t.prototype.te=function(t,e){return pu(t).put(zs(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Oi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return pu(t).$t({range:r,index:fs.queryTargetsIndexName},(function(t,n,r){var o=Gs(n);Ri(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=vu(t);return e.forEach((function(e){var a=Za(e.path);i.push(o.put(new ps(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),Ts.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=vu(t);return Ts.forEach(e,(function(e){var o=Za(e.path);return Ts.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=vu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=vu(t),i=ua();return r.$t({range:n,kt:!0},(function(t,e,n){var r=ns(t[1]),o=new hi(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Za(e.path),r=IDBKeyRange.bound([n],[Kr(n)],!1,!0),i=0;return vu(t).$t({index:ps.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return pu(t).get(e).next((function(t){return t?Gs(t):null}))},t}();function pu(t){return Ds(t,fs.store)}function du(t){return Ds(t,ds.store)}function vu(t){return Ds(t,ps.store)}function gu(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){if(t.code!==Nr.FAILED_PRECONDITION||t.message!==_s)throw t;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function yu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Vr(n,i);return 0===a?Vr(r,o):a}var mu=function(){function t(t){this.ne=t,this.buffer=new Zo(yu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();yu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),bu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return a(e,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ns(e=n.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,gu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),_u=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Ts.resolve(kr.o);var r=new mu(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),Ts.resolve(nu)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),nu):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,a,s,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,s=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Or()<=l.LogLevel.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-h)+"ms"),Ts.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),wu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new _u(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Iu(t,n)},t.prototype.removeReference=function(t,e,n){return Iu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Iu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return lu(t).Ot((function(r){return su(t,r,e).next((function(t){return t&&(n=!0),Ts.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),vu(t).delete([0,Za(a.path)])}))}));i.push(u)}})).next((function(){return Ts.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Iu(t,e)},t.prototype.we=function(t,e){var n,r=vu(t),i=kr.o;return r.$t({index:ps.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var a=r.path,s=r.sequenceNumber;0===o?(i!==kr.o&&e(new hi(ns(n)),i),i=s,n=a):i=kr.o})).next((function(){i!==kr.o&&e(new hi(ns(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Iu(t,e){return vu(t).put(function(t,e){return new ps(0,Za(t.path),e)}(e,t.currentSequenceNumber))}var Tu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){zr(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Qr(this.inner)},t}(),Eu=function(){function t(){this.changes=new Tu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Hr.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Ni.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Ts.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Su=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Nu(t).put(Au(e),n)},t.prototype.removeEntry=function(t,e){var n=Nu(t),r=Au(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Nu(t).get(Au(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Nu(t).get(Au(e)).next((function(t){return{document:n.ye(e,t),size:ou(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=na();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=na(),i=new $o(hi.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,ou(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Ts.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Nu(t).$t({range:r},(function(t,e,r){for(var a=hi.fromSegments(t);o&&hi.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=na(),o=e.path.length+1,a={};if(n.isEqual(Hr.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=Vs(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=ls.collectionReadTimeIndex}return Nu(t).$t(a,(function(t,n,a){if(t.length===o){var s=Us(r.R,n);e.path.isPrefixOf(s.key.path)?co(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Cu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ku(t).get(hs.key).next((function(t){return Fr(!!t),t}))},t.prototype.me=function(t,e){return ku(t).put(hs.key,e)},t.prototype.ye=function(t,e){if(e){var n=Us(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Hr.min()))return n}return Ni.newInvalidDocument(t)},t}(),Cu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Tu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return o(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Zo((function(t,e){return Vr(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=qs(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=ou(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var l=qs(e.Ie.R,Ni.newNoDocument(o,Hr.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Ts.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Eu);function ku(t){return Ds(t,hs.store)}function Nu(t){return Ds(t,ls.store)}function Au(t){return t.path.toArray()}var Pu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Fr(n<r&&n>=0&&r<=11);var o=new Es("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(is.store)}(t),function(t){t.createObjectStore(os.store,{keyPath:os.keyPath}),t.createObjectStore(as.store,{keyPath:as.keyPath,autoIncrement:!0}).createIndex(as.userMutationsIndex,as.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ss.store)}(t),Ou(t),function(t){t.createObjectStore(ls.store)}(t));var a=Ts.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ps.store),t.deleteObjectStore(fs.store),t.deleteObjectStore(ds.store)}(t),Ou(t)),a=a.next((function(){return function(t){var e=t.store(ds.store),n=new ds(0,0,Hr.min().toTimestamp(),0);return e.put(ds.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(as.store).Nt().next((function(n){t.deleteObjectStore(as.store),t.createObjectStore(as.store,{keyPath:as.keyPath,autoIncrement:!0}).createIndex(as.userMutationsIndex,as.userMutationsKeyPath,{unique:!0});var r=e.store(as.store),i=n.map((function(t){return r.put(t)}));return Ts.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(gs.store,{keyPath:gs.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(hs.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ls.store);e.createIndex(ls.readTimeIndex,ls.readTimeIndexPath,{unique:!1}),e.createIndex(ls.collectionReadTimeIndex,ls.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(ys.store,{keyPath:ys.keyPath})}(t),function(t){t.createObjectStore(ms.store,{keyPath:ms.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(ls.store).$t((function(t,n){e+=ou(n)})).next((function(){var n=new hs(e);return t.store(hs.store).put(hs.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(os.store),r=t.store(as.store);return n.Nt().next((function(n){return Ts.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(as.userMutationsIndex,i).next((function(r){return Ts.forEach(r,(function(r){Fr(r.userId===n.userId);var i=Hs(e.R,r);return iu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(ps.store),n=t.store(ls.store);return t.store(ds.store).get(ds.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new $r(n),a=function(t){return[0,Za(t)]}(o);r.push(e.get(a).next((function(n){return n?Ts.resolve():function(n){return e.put(new ps(0,Za(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Ts.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(vs.store,{keyPath:vs.keyPath});var n=e.store(vs.store),r=new Zs,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Za(i)})}};return e.store(ls.store).$t({kt:!0},(function(t,e){var n=new $r(t);return i(n.popLast())})).next((function(){return e.store(ss.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=ns(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(fs.store);return n.$t((function(t,r){var i=Gs(r),o=zs(e.R,i);return n.put(o)}))},t}();function Ou(t){t.createObjectStore(ps.store,{keyPath:ps.keyPath}).createIndex(ps.documentTargetsIndex,ps.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(fs.store,{keyPath:fs.keyPath}).createIndex(fs.queryTargetsIndexName,fs.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ds.store)}var Ru="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",xu=function(){function t(e,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Ar(Nr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wu(this,i),this.Le=n+"main",this.R=new js(u),this.Be=new Ss(this.Le,11,new Pu(this.R)),this.qe=new fu(this.referenceDelegate,this.R),this.Ut=new tu,this.Ue=function(t,e){return new Su(t,e)}(this.R,this.Ut),this.Ke=new Ys,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ar(Nr.FAILED_PRECONDITION,Ru);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new kr(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return a(e,void 0,void 0,(function(){return s(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return a(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return a(e,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Mu(e).put(new gs(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Ns(e))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Du(t).get(is.key).next((function(t){return Ts.resolve(e.tn(t))}))},t.prototype.en=function(t){return Mu(t).delete(this.clientId)},t.prototype.nn=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,i=this;return s(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ds(t,gs.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Ts.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Ts.resolve(!0):Du(t).get(is.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Ar(Nr.FAILED_PRECONDITION,Ru);return!1}}return!(!e.networkEnabled||!e.inForeground)||Mu(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[is.store,gs.store],(function(e){var n=new xs(e,kr.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Mu(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return au.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Rr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,bs,(function(o){return i=new xs(o,r.Ne?r.Ne.next():kr.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw xr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Ar(Nr.FAILED_PRECONDITION,_s);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Du(t).get(is.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ar(Nr.FAILED_PRECONDITION,Ru)}))},t.prototype.Ze=function(t){var e=new is(this.clientId,this.allowTabSynchronization,Date.now());return Du(t).put(is.key,e)},t.yt=function(){return Ss.yt()},t.prototype.Xe=function(t){var e=this,n=Du(t);return n.get(is.key).next((function(t){return e.tn(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(is.key)):Ts.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Du(t){return Ds(t,is.store)}function Mu(t){return Ds(t,gs.store)}function Lu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Fu=function(t,e){this.progress=t,this.wn=e},ju=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return hi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):no(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new hi(e)).next((function(t){var e=ia();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=ia();return this.Ut.getCollectionParents(t,i).next((function(a){return Ts.forEach(a,(function(a){var s=function(t,e){return new Yi(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=Ni.newInvalidDocument(c),r=r.insert(c,l)),Do(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){co(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=ua(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Uo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Uu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ua(),i=ua(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),qu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Hr.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var a=i.Cn(e,o);return(Ji(e)||Zi(e))&&i.Nn(e.limitType,a,r,n)?i.Dn(t,e):(Or()<=l.LogLevel.DEBUG&&Rr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),uo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return a.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Zo(lo(t));return e.forEach((function(e,r){co(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Or()<=l.LogLevel.DEBUG&&Rr("QueryEngine","Using full collection scan to execute query:",uo(e)),this.Sn.getDocumentsMatchingQuery(t,e,Hr.min())},t}(),Vu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new $o(Vr),this.kn=new Tu((function(t){return Oi(t)}),Ri),this.$n=Hr.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new ju(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();function Bu(t,e,n,r){return new Vu(t,e,n,r)}function Ku(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o;return s(this,(function(a){switch(a.label){case 0:return n=jr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new ju(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=ua(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Wu(t,e){var n=jr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=Ts.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Fr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Hu(t){var e=jr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Gu(t,e){var n=jr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Fr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=na();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(zu(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Hr.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return Ts.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.Fn=i,t}))}function zu(t,e,n,r,i){var o=ua();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=na();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(Hr.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):Rr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Qu(t,e){var n=jr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Yu(t,e){var n=jr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Ts.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Fs(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function $u(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,a;return s(this,(function(s){switch(s.label){case 0:r=jr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!Ns(a=s.sent()))throw a;return Rr("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function Xu(t,e,n){var r=jr(t),i=Hr.min(),o=ua();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=jr(t),i=r.kn.get(n);return void 0!==i?Ts.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,io(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Hr.min(),n?o:ua())})).next((function(t){return{documents:t,Bn:o}}))}))}function Ju(t,e){var n=jr(t),r=jr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Zu(t){var e=jr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=jr(t),i=na(),o=Vs(n),a=Nu(e),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:ls.readTimeIndex,range:s},(function(t,e){var n=Us(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Bs(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function tc(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){return[2,(e=jr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Nu(t),n=Hr.min();return e.$t({index:ls.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Bs(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function ec(t,e,n,r){return a(this,void 0,void 0,(function(){var i,o,a,u,c,l,h,f,p,d;return s(this,(function(s){switch(s.label){case 0:for(i=jr(t),o=ua(),a=na(),u=aa(),c=0,l=n;c<l.length;c++)h=l[c],f=e.qn(h.metadata.name),h.document&&(o=o.add(f)),a=a.insert(f,e.Un(h)),u=u.insert(f,e.Kn(h.metadata.readTime));return p=i.On.newChangeBuffer({trackRemovals:!0}),[4,Yu(i,function(t){return io(Xi($r.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=s.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return zu(t,p,a,Hr.min(),u).next((function(e){return p.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function nc(t,e,n){return void 0===n&&(n=ua()),a(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:return[4,Yu(t,io(Qs(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=jr(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Ca(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var a=r.withResumeToken(ti.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Ke.saveNamedQuery(t,e)}))}))]}}))}))}var rc=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Ts.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Ca(n.createTime)}),Ts.resolve()},t.prototype.getNamedQuery=function(t,e){return Ts.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Qs(t.bundledQuery),readTime:Ca(t.readTime)}}(e)),Ts.resolve()},t}(),ic=function(){function t(){this.Wn=new Zo(oc.Gn),this.zn=new Zo(oc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new oc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new oc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new hi(new $r([])),r=new oc(n,t),i=new oc(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new hi(new $r([])),n=new oc(e,t),r=new oc(e,t+1),i=ua();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new oc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),oc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return hi.comparator(t.key,e.key)||Vr(t.ns,e.ns)},t.Hn=function(t,e){return Vr(t.ns,e.ns)||hi.comparator(t.key,e.key)},t}(),ac=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Zo(oc.Gn)}return t.prototype.checkEmpty=function(t){return Ts.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Ms(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new oc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Ts.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Ts.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Ts.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Ts.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Ts.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new oc(e,0),i=new oc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Ts.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Zo(Vr);return e.forEach((function(t){var e=new oc(t,0),i=new oc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Ts.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;hi.isDocumentKey(i)||(i=i.child(""));var o=new oc(new hi(i),0),a=new Zo(Vr);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),Ts.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Fr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Ts.forEach(e.mutations,(function(i){var o=new oc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new oc(e,0),r=this.rs.firstAfterOrEqual(n);return Ts.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Ts.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),sc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new $o(hi.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Ts.resolve(n?n.document.clone():Ni.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=na();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ni.newInvalidDocument(t))})),Ts.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=na(),i=new hi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||co(e,c)&&(r=r.insert(c.key,c.clone()))}return Ts.resolve(r)},t.prototype.fs=function(t,e){return Ts.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new uc(this)},t.prototype.getSize=function(t){return Ts.resolve(this.size)},t}(),uc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return o(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Ts.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Eu),cc=function(){function t(t){this.persistence=t,this.ds=new Tu((function(t){return Oi(t)}),Ri),this.lastRemoteSnapshotVersion=Hr.min(),this.highestTargetId=0,this.ws=0,this._s=new ic,this.targetCount=0,this.ys=hu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Ts.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Ts.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Ts.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Ts.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Ts.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new hu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Ts.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Ts.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Ts.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),Ts.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Ts.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Ts.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Ts.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Ts.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Ts.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Ts.resolve(n)},t.prototype.containsKey=function(t,e){return Ts.resolve(this._s.containsKey(e))},t}(),lc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new kr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new cc(this),this.Ut=new Js,this.Ue=function(t,e){return new sc(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new js(e),this.Ke=new rc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new ac(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new hc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Ts.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),hc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return o(e,t),e}(ws),fc=function(){function t(t){this.persistence=t,this.As=new ic,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Lr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Ts.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Ts.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Ts.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ts.forEach(this.vs,(function(r){var i=hi.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Ts.or([function(){return Ts.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),pc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function dc(t,e){return"firestore_clients_"+t+"_"+e}function vc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function gc(t,e){return"firestore_targets_"+t+"_"+e}pc.UNAUTHENTICATED=new pc(null),pc.GOOGLE_CREDENTIALS=new pc("google-credentials-uid"),pc.FIRST_PARTY=new pc("first-party-uid");var yc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Ar(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(xr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),mc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ar(i.error.code,i.error.message)),o?new t(e,i.state,r):(xr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),bc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=la(),a=0;i&&a<r.activeTargetIds.length;++a)i=li(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(xr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),_c=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(xr("SharedClientState","Failed to parse online state: "+e),null)},t}(),wc=function(){function t(){this.activeTargetIds=la()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ic=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new $o(Vr),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=dc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new wc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,u,c,l,h,f=this;return s(this,(function(s){switch(s.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(dc(this.persistenceKey,r)))&&(o=bc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(a=this.storage.getItem(this.Us))&&(u=this.js(a))&&this.Ws(u),c=0,l=this.$s;c<l.length;c++)h=l[c],this.Fs(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(gc(this.persistenceKey,t));if(n){var r=mc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(gc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Rr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return a(e,void 0,void 0,(function(){var t,e,r,i,o,a;return s(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=kr.o;if(null!=t)try{var n=JSON.parse(t);Fr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==kr.o&&this.sequenceNumberHandler(a);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new yc(this.currentUser,t,e,n),i=vc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=vc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=gc(this.persistenceKey,t),i=new mc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return bc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return yc.Vs(new pc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return mc.Vs(r,e)},t.prototype.js=function(t){return _c.Vs(t)},t.prototype.ii=function(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=la();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Tc=function(){function t(){this.li=new wc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new wc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Ec=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Sc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Cc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Nc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return o(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var a=new Sr;a.listenOnce(_r.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case br.NO_ERROR:var e=a.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case br.TIMEOUT:Rr("Connection",'RPC "'+t+'" timed out'),o(new Ar(Nr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var n=a.getStatus();if(Rr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Nr).indexOf(e)>=0?e:Nr.UNKNOWN}(r.status);o(new Ar(s,r.message))}else o(new Ar(Nr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ar(Nr.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{Rr("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=yr(),i=mr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Tr({})),this.Fi(o.initMessageHeaders,e),(0,c.isMobileCordova)()||(0,c.isReactNative)()||(0,c.isElectron)()||(0,c.isIE)()||(0,c.isUWP)()||(0,c.isBrowserExtension)()||(o.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");Rr("Connection","Creating WebChannel: "+a,o);var s=r.createWebChannel(a,o),u=!1,l=!1,h=new kc({Ei:function(t){l?Rr("Connection","Not sending because WebChannel is closed:",t):(u||(Rr("Connection","Opening WebChannel transport."),s.open(),u=!0),Rr("Connection","WebChannel sending:",t),s.send(t))},Ti:function(){return s.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(s,Er.EventType.OPEN,(function(){l||Rr("Connection","WebChannel transport opened.")})),f(s,Er.EventType.CLOSE,(function(){l||(l=!0,Rr("Connection","WebChannel transport closed"),h.Vi())})),f(s,Er.EventType.ERROR,(function(t){l||(l=!0,Dr("Connection","WebChannel transport errored:",t),h.Vi(new Ar(Nr.UNAVAILABLE,"The operation could not be completed")))})),f(s,Er.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];Fr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Rr("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Ko[t];if(void 0!==e)return Yo(e)}(o),u=i.message;void 0===a&&(a=Nr.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new Ar(a,u)),s.close()}else Rr("Connection","WebChannel received:",n),h.Si(n)}})),f(i,wr.STAT_EVENT,(function(t){t.stat===Ir.PROXY?Rr("Connection","Detected buffering proxy"):t.stat===Ir.NOPROXY&&Rr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Rr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return Rr("RestConnection","Received: ",t),t}),(function(e){throw Dr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Cc[t];return this.Di+"/v1/"+e+":"+n},t}());function Ac(){return"undefined"!=typeof window?window:null}function Pc(){return"undefined"!=typeof document?document:null}function Oc(t){return new Ia(t,!0)}var Rc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),xc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Rc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Nr.RESOURCE_EXHAUSTED?(xr(e.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Nr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Ar(Nr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return a(t,void 0,void 0,(function(){return s(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Dc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return o(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Lr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Fr(void 0===e||"string"==typeof e),ti.fromBase64String(e||"")):(Fr(void 0===e||e instanceof Uint8Array),ti.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?Nr.UNKNOWN:Yo(t.code);return new Ar(e,t.message||"")}(s);n=new va(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Pa(t,r.document.name),o=Ca(r.document.updateTime);var s=new Ci({mapValue:{fields:r.document.fields}}),u=(a=Ni.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new pa(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Pa(t,r.document),o=r.readTime?Ca(r.readTime):Hr.min(),s=Ni.newNoDocument(i,o),a=r.removedTargetIds||[],n=new pa([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Pa(t,r.document),o=r.removedTargetIds||[],n=new pa([],o,i,null);else{if(!("filter"in e))return Lr();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new zo(r),o=l.targetId,n=new da(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Hr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Hr.min():e.readTime?Ca(e.readTime):Hr.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=xa(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=xi(r)?{documents:Ua(t,r)}:{query:qa(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Ea(t,e.resumeToken):e.snapshotVersion.compareTo(Hr.min())>0&&(n.readTime=Ta(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=xa(this.R),e.removeTarget=t,this.cr(e)},e}(xc),Mc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return o(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Fr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Ca(t.updateTime):Ca(e);return n.isEqual(Hr.min())&&(n=Ca(e)),new Ao(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Ca(t.commitTime);return this.listener.Tr(n,e)}return Fr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=xa(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Fa(e.R,t)}))};this.cr(n)},e}(xc),Lc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return o(e,t),e.prototype.br=function(){if(this.Rr)throw new Ar(Nr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Nr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ar(Nr.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Nr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ar(Nr.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Fc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(xr(e),this.Vr=!1):Rr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),jc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return a(o,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return zc(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return(e=jr(t)).Or.add(4),[4,qc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Uc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Fc(n,r)};function Uc(t){return a(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:if(!zc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function qc(t){return a(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Vc(t,e){var n=jr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Gc(n)?Hc(n):ul(n).er()&&Kc(n,e))}function Bc(t,e){var n=jr(t),r=ul(n);n.$r.delete(e),r.er()&&Wc(n,e),0===n.$r.size&&(r.er()?r.ir():zc(n)&&n.Br.set("Unknown"))}function Kc(t,e){t.qr.U(e.targetId),ul(t).mr(e)}function Wc(t,e){t.qr.U(e),ul(t).yr(e)}function Hc(t){t.qr=new ya({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),ul(t).start(),t.Br.Sr()}function Gc(t){return zc(t)&&!ul(t).tr()&&t.$r.size>0}function zc(t){return 0===jr(t).Or.size}function Qc(t){t.qr=void 0}function Yc(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){return t.$r.forEach((function(e,n){Kc(t,e)})),[2]}))}))}function $c(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(n){return Qc(t),Gc(t)?(t.Br.Nr(e),Hc(t)):t.Br.set("Unknown"),[2]}))}))}function Xc(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o;return s(this,(function(u){switch(u.label){case 0:if(t.Br.set("Online"),!(e instanceof va&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o;return s(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.$r.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Jc(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof pa?t.qr.X(e):e instanceof da?t.qr.rt(e):t.qr.et(e),n.isEqual(Hr.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Hu(t.localStore)];case 8:return i=u.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(ti.EMPTY_BYTE_STRING,n.snapshotVersion)),Wc(t,e);var r=new Fs(n.target,e,1,n.sequenceNumber);Kc(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=u.sent()),[4,Jc(t,o)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function Jc(t,e,n){return a(this,void 0,void 0,(function(){var r=this;return s(this,(function(i){switch(i.label){case 0:if(!Ns(e))throw e;return t.Or.add(1),[4,qc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Hu(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return a(r,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Uc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Zc(t,e){return e().catch((function(n){return Jc(t,n,e)}))}function tl(t){return a(this,void 0,void 0,(function(){var e,n,r,i,o;return s(this,(function(a){switch(a.label){case 0:e=jr(t),n=cl(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return zc(t)&&t.kr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Qu(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=cl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,Jc(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return el(e)&&nl(e),[2]}}))}))}function el(t){return zc(t)&&!cl(t).tr()&&t.kr.length>0}function nl(t){cl(t).start()}function rl(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){return cl(t).Ar(),[2]}))}))}function il(t){return a(this,void 0,void 0,(function(){var e,n,r,i;return s(this,(function(o){for(e=cl(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function ol(t,e,n){return a(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Ls.from(r,e,n),[4,Zc(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,tl(t)];case 2:return o.sent(),[2]}}))}))}function al(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return e&&cl(t).pr?[4,function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return Qo(r=e.code)&&r!==Nr.ABORTED?(n=t.kr.shift(),cl(t).sr(),[4,Zc(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,tl(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return el(t)&&nl(t),[2]}}))}))}function sl(t,e){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=jr(t),e?(n.Or.delete(2),[4,Uc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,qc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function ul(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=jr(t);return r.br(),new Dc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Yc.bind(null,t),Ri:$c.bind(null,t),_r:Xc.bind(null,t)}),t.Mr.push((function(n){return a(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Gc(t)?Hc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Qc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function cl(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=jr(t);return r.br(),new Mc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:rl.bind(null,t),Ri:al.bind(null,t),Ir:il.bind(null,t),Tr:ol.bind(null,t)}),t.Mr.push((function(n){return a(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,tl(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Rr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr}var ll=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ar(Nr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function hl(t,e){if(xr("AsyncQueue",e+": "+t),Ns(t))return new Ar(Nr.UNAVAILABLE,e+": "+t);throw t}var fl=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||hi.comparator(e.key,n.key)}:function(t,e){return hi.comparator(t.key,e.key)},this.keyedMap=ia(),this.sortedSet=new $o(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),pl=function(){function t(){this.Qr=new $o(hi.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Lr():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),dl=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,fl.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ao(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),vl=function(){this.Wr=void 0,this.listeners=[]},gl=function(){this.queries=new Tu((function(t){return so(t)}),ao),this.onlineState="Unknown",this.Gr=new Set};function yl(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u,c;return s(this,(function(s){switch(s.label){case 0:if(n=jr(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new vl),!i)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=s.sent(),[3,4];case 3:return u=s.sent(),c=hl(u,"Initialization of query '"+uo(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&wl(n),[2]}}))}))}function ml(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a;return s(this,(function(s){return n=jr(t),r=e.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function bl(t,e){for(var n=jr(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(a)&&(r=!0);u.Wr=a}}r&&wl(n)}function _l(t,e,n){var r=jr(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function wl(t){t.Gr.forEach((function(t){t.next()}))}var Il=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new dl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=dl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Tl=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),El=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Pa(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?La(this.R,t.document,!1):Ni.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return Ca(t)},t}(),Sl=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=Cl(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new El(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],l=(e.get(c)||ua()).add(a);e.set(c,l)}}return e},t.prototype.complete=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,i;return s(this,(function(o){switch(o.label){case 0:return[4,ec(this.localStore,new El(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,nc(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Fu(Object.assign({},this.progress),t))]}}))}))},t}();function Cl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var kl=function(t){this.key=t},Nl=function(t){this.key=t},Al=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ua(),this.mutatedKeys=ua(),this.lo=lo(t),this.fo=new fl(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new pl,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Ji(this.query)&&i.size===this.query.limit?i.last():null,c=Zi(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=co(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data.isEqual(h.data)?f!==p&&(r.track({type:3,doc:h}),d=!0):n.yo(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(s=!0)),d&&(h?(a=a.add(h),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Ji(this.query)||Zi(this.query))for(;a.size>this.query.limit;){var l=Ji(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new dl(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new pl,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ua(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Nl(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new kl(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ua();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return dl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Pl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ol=function(t){this.key=t,this.bo=!1},Rl=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Tu((function(t){return so(t)}),ao),this.Vo=new Map,this.So=new Set,this.Do=new $o(hi.comparator),this.Co=new Map,this.No=new ic,this.xo={},this.Fo=new Map,this.ko=hu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function xl(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u;return s(this,(function(s){switch(s.label){case 0:return n=uh(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Yu(n.localStore,io(e))];case 2:return a=s.sent(),u=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,Dl(n,e,r,"current"===u)];case 3:i=s.sent(),n.isPrimaryClient&&Vc(n.remoteStore,a),s.label=4;case 4:return[2,i]}}))}))}function Dl(t,e,n,r){return a(this,void 0,void 0,(function(){var i,o,u,c,l,h;return s(this,(function(f){switch(f.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return a(this,void 0,void 0,(function(){var i,o,a;return s(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,Xu(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(zl(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,Xu(t.localStore,e,!0)];case 1:return i=f.sent(),o=new Al(e,i.Bn),u=o._o(i.documents),c=fa.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),l=o.applyChanges(u,t.isPrimaryClient,c),zl(t,n,l.To),h=new Pl(e,n,o),[2,(t.Po.set(e,h),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),l.snapshot)]}}))}))}function Ml(t,e){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return n=jr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!ao(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,$u(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Bc(n.remoteStore,r.targetId),Hl(n,r.targetId)})).catch(gu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Hl(n,r.targetId),[4,$u(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Ll(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,a;return s(this,(function(s){switch(s.label){case 0:r=ch(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=jr(t),i=Wr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ua());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=Mo(c,n.get(c.key));null!=l&&a.push(new Uo(c.key,l,ki(l.value.mapValue),Po.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new $o(Vr)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,$l(r,i.changes)];case 3:return s.sent(),[4,tl(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=hl(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function Fl(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:n=jr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Gu(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Fr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Fr(r.bo):t.removedDocuments.size>0&&(Fr(r.bo),r.bo=!1))})),[4,$l(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,gu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function jl(t,e,n){var r=jr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=jr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&wl(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ul(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,a,u,c;return s(this,(function(s){switch(s.label){case 0:return(r=jr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new $o(hi.comparator)).insert(o,Ni.newNoDocument(o,Hr.min())),u=ua().add(o),c=new ha(Hr.min(),new Map,new Zo(Vr),a,u),[4,Fl(r,c)]):[3,2];case 1:return s.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Yl(r),[3,4];case 2:return[4,$u(r.localStore,e,!1).then((function(){return Hl(r,e,n)})).catch(gu)];case 3:s.sent(),s.label=4;case 4:return[2]}}))}))}function ql(t,e){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:n=jr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Wu(n.localStore,e)];case 2:return i=o.sent(),Wl(n,r,null),Kl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,$l(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,gu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Vl(t,e,n){return a(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:r=jr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=jr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Fr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Wl(r,e,n),Kl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,$l(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,gu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Bl(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a;return s(this,(function(s){switch(s.label){case 0:zc((n=jr(t)).remoteStore)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=jr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=hl(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function Kl(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function Wl(t,e,n){var r=jr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Hl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Gl(t,e)}))}function Gl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Bc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Yl(t))}function zl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof kl?(t.No.addReference(o.key,e),Ql(t,o)):o instanceof Nl?(Rr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Gl(t,o.key)):Lr()}}function Ql(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Rr("SyncEngine","New document in limbo: "+n),t.So.add(r),Yl(t))}function Yl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new hi($r.fromString(e)),r=t.ko.next();t.Co.set(r,new Ol(n)),t.Do=t.Do.insert(n,r),Vc(t.remoteStore,new Fs(io(Xi(n.path)),r,2,kr.o))}}function $l(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,u;return s(this,(function(c){switch(c.label){case 0:return r=jr(t),i=[],o=[],u=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){u.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Uu.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(u)]);case 1:return c.sent(),r.vo._r(i),[4,function(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u,c,l,h;return s(this,(function(s){switch(s.label){case 0:n=jr(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Ts.forEach(e,(function(e){return Ts.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Ts.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return s.sent(),[3,4];case 3:if(!Ns(r=s.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],u=a.targetId,a.fromCache||(c=n.Fn.get(u),l=c.snapshotVersion,h=c.withLastLimboFreeSnapshotVersion(l),n.Fn=n.Fn.insert(u,h));return[2]}}))}))}(r.localStore,o)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Xl(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return(n=jr(t)).currentUser.isEqual(e)?[3,3]:(Rr("SyncEngine","User change. New user:",e.toKey()),[4,Ku(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new Ar(Nr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,$l(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Jl(t,e){var n=jr(t),r=n.Co.get(e);if(r&&r.bo)return ua().add(r.key);var i=ua(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Zl(t,e){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return[4,Xu((n=jr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&zl(n,e.targetId,i.To),i)]}}))}))}function th(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){return[2,Zu((e=jr(t)).localStore).then((function(t){return $l(e,t)}))]}))}))}function eh(t,e,n,r){return a(this,void 0,void 0,(function(){var i,o;return s(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=jr(t),r=jr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Ts.resolve(null)}))}))}((i=jr(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,tl(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Wl(i,e,r||null),Kl(i,e),function(t,e){jr(jr(t)._n).Gt(e)}(i.localStore,e)):Lr(),a.label=4;case 4:return[4,$l(i,o)];case 5:return a.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function nh(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u,c,l;return s(this,(function(s){switch(s.label){case 0:return uh(n=jr(t)),ch(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,rh(n,r.toArray())]);case 1:return i=s.sent(),n.$o=!0,[4,sl(n.remoteStore,!0)];case 2:for(s.sent(),o=0,a=i;o<a.length;o++)u=a[o],Vc(n.remoteStore,u);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(c=[],l=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?c.push(e):l=l.then((function(){return Hl(n,e),$u(n.localStore,e,!0)})),Bc(n.remoteStore,e)})),[4,l]);case 4:return s.sent(),[4,rh(n,c)];case 5:return s.sent(),function(t){var e=jr(t);e.Co.forEach((function(t,n){Bc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new $o(hi.comparator)}(n),n.$o=!1,[4,sl(n.remoteStore,!1)];case 6:s.sent(),s.label=7;case 7:return[2]}}))}))}function rh(t,e,n){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u,c,l,h,f,p,d,v,g;return s(this,(function(s){switch(s.label){case 0:n=jr(t),r=[],i=[],o=0,a=e,s.label=1;case 1:return o<a.length?(u=a[o],c=void 0,(l=n.Vo.get(u))&&0!==l.length?[4,Yu(n.localStore,io(l[0]))]:[3,7]):[3,13];case 2:c=s.sent(),h=0,f=l,s.label=3;case 3:return h<f.length?(p=f[h],d=n.Po.get(p),[4,Zl(n,d)]):[3,6];case 4:(v=s.sent()).snapshot&&i.push(v.snapshot),s.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Ju(n.localStore,u)];case 8:return g=s.sent(),[4,Yu(n.localStore,g)];case 9:return c=s.sent(),[4,Dl(n,ih(g),u,!1)];case 10:s.sent(),s.label=11;case 11:r.push(c),s.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function ih(t){return $i(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function oh(t){var e=jr(t);return jr(jr(e.localStore).persistence).fn()}function ah(t,e,n,r){return a(this,void 0,void 0,(function(){var i,o,a;return s(this,(function(s){switch(s.label){case 0:return(i=jr(t)).$o?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Zu(i.localStore)];case 3:return o=s.sent(),a=ha.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,$l(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,$u(i.localStore,e,!0)];case 6:return s.sent(),Hl(i,e,r),[3,8];case 7:Lr(),s.label=8;case 8:return[2]}}))}))}function sh(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,a,u,c,l,h,f,p;return s(this,(function(d){switch(d.label){case 0:if(!(r=uh(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(Rr("SyncEngine","Adding an already active target "+a),[3,5]):[4,Ju(r.localStore,a)]):[3,6];case 2:return u=d.sent(),[4,Yu(r.localStore,u)];case 3:return c=d.sent(),[4,Dl(r,ih(u),c.targetId,!1)];case 4:d.sent(),Vc(r.remoteStore,c),d.label=5;case 5:return i++,[3,1];case 6:l=function(t){return s(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,$u(r.localStore,t,!1).then((function(){Bc(r.remoteStore,t),Hl(r,t)})).catch(gu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,d.label=7;case 7:return h<f.length?(p=f[h],[5,l(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function uh(t){var e=jr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ul.bind(null,e),e.vo._r=bl.bind(null,e.eventManager),e.vo.Mo=_l.bind(null,e.eventManager),e}function ch(t){var e=jr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ql.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Vl.bind(null,e),e}function lh(t,e,n){var r=jr(t);(function(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,a,u,c;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=s.sent(),[4,function(t,e){var n=jr(t),r=Ca(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Ke.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return s.sent()?[4,e.close()]:[3,4];case 3:return[2,(s.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(Cl(r)),i=new Sl(r,t.localStore,e.R),[4,e.Lo()];case 5:o=s.sent(),s.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=s.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=s.sent(),s.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return u=s.sent(),[4,$l(t,u.wn,void 0)];case 12:return s.sent(),[4,function(t,e){var n=jr(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Ke.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return s.sent(),n._completeWith(u.progress),[3,15];case 14:return Dr("SyncEngine","Loading bundle failed with "+(c=s.sent())),n._failWith(c),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var hh=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.R=Oc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Bu(this.persistence,new qu,t.initialUser,this.R)},t.prototype.qo=function(t){return new lc(fc.bs,this.R)},t.prototype.Bo=function(t){return new Tc},t.prototype.terminate=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),fh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return o(e,t),e.prototype.initialize=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,tc(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,ch(this.Qo.syncEngine)];case 4:return n.sent(),[4,tl(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Bu(this.persistence,new qu,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new bu(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Lu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ru.withCacheSize(this.cacheSizeBytes):ru.DEFAULT;return new xu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Ac(),Pc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Tc},e}(hh),ph=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return o(e,t),e.prototype.initialize=function(e){return a(this,void 0,void 0,(function(){var n,r=this;return s(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Ic?(this.sharedClientState.syncEngine={ui:eh.bind(null,n),ai:ah.bind(null,n),hi:sh.bind(null,n),fn:oh.bind(null,n),ci:th.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return a(r,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,nh(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Ac();if(!Ic.yt(e))throw new Ar(Nr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Lu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Ic(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(fh),dh=function(){function t(){}return t.prototype.initialize=function(t,e){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return jl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Xl.bind(null,this.syncEngine),[4,sl(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new gl},t.prototype.createDatastore=function(t){var e,n=Oc(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Nc(e));return function(t,e,n){return new Lc(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return jl(a.syncEngine,t,0)},o=Sc.yt()?new Sc:new Ec,new jc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new Rl(t,e,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=jr(t),Rr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,qc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function vh(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return a(this,void 0,void 0,(function(){var r;return s(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var gh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),yh=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Is,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return a(this,void 0,void 0,(function(){var t,e,n,r;return s(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Tl(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return a(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return a(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),mh=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return a(this,void 0,void 0,(function(){var e,n=this;return s(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Ar(Nr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u;return s(this,(function(s){switch(s.label){case 0:return n=jr(t),r=xa(n.R)+"/documents",i={documents:e.map((function(t){return Aa(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=s.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=Pa(t,e.found.name),r=Ca(e.found.updateTime),i=new Ci({mapValue:{fields:e.found.fields}});return Ni.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Fr(!!e.missing),Fr(!!e.readTime);var n=Pa(t,e.missing),r=Ca(e.readTime);return Ni.newNoDocument(n,r)}(t,e):Lr()}(n.R,t);a.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=a.get(t.toString());Fr(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Ho(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return a(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=hi.fromPath(n);e.mutations.push(new Go(r,e.precondition(r)))})),[4,function(t,e){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return n=jr(t),r=xa(n.R)+"/documents",i={writes:e.map((function(t){return Fa(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Lr();e=Hr.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ar(Nr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Po.updateTime(e):Po.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Hr.min()))throw new Ar(Nr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Po.updateTime(e)}return Po.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),bh=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Rc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return a(t,void 0,void 0,(function(){var t,e,n=this;return s(this,(function(r){return t=new mh(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!ui(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Qo(e)}return!1},t}(),_h=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=pc.UNAUTHENTICATED,this.clientId=qr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return a(r,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return Rr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ar(Nr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return a(t,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=hl(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function wh(t,e){return a(this,void 0,void 0,(function(){var n,r,i=this;return s(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Rr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return a(i,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Ku(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Ih(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Th(t)];case 1:return n=i.sent(),Rr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return(n=jr(t)).asyncQueue.verifyOperationInProgress(),Rr("RemoteStore","RemoteStore received new credentials"),r=zc(n),n.Or.add(3),[4,qc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Uc(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Th(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Rr("FirestoreClient","Using default OfflineComponentProvider"),[4,wh(t,new hh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Eh(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Rr("FirestoreClient","Using default OnlineComponentProvider"),[4,Ih(t,new dh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Sh(t){return Th(t).then((function(t){return t.persistence}))}function Ch(t){return Th(t).then((function(t){return t.localStore}))}function kh(t){return Eh(t).then((function(t){return t.remoteStore}))}function Nh(t){return Eh(t).then((function(t){return t.syncEngine}))}function Ah(t){return a(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,Eh(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=xl.bind(null,e.syncEngine),n.onUnlisten=Ml.bind(null,e.syncEngine),n)]}}))}))}function Ph(t,e,n){var r=this;void 0===n&&(n={});var i=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(r,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new gh({next:function(o){e.enqueueAndForget((function(){return ml(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Ar(Nr.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Ar(Nr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new Il(Xi(n.path),o,{includeMetadataChanges:!0,so:!0});return yl(t,a)},[4,Ah(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Oh(t,e,n){var r=this;void 0===n&&(n={});var i=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(r,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new gh({next:function(n){e.enqueueAndForget((function(){return ml(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Ar(Nr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new Il(n,o,{includeMetadataChanges:!0,so:!0});return yl(t,a)},[4,Ah(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Rh=function(t,e,n,r,i,o,a,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},xh=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Dh=new Map,Mh=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Lh=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(pc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Fh=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),jh=function(){function t(t){var e=this;this.currentUser=pc.UNAUTHENTICATED,this.oc=new Is,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Rr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Rr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Fr("string"==typeof n.accessToken),new Mh(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return a(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new pc(t)},t}(),Uh=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=pc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),qh=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Uh(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(pc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Vh(t,e,n){if(!n)throw new Ar(Nr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Bh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Kh(t,e,n,r){if(!0===e&&!0===r)throw new Ar(Nr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Wh(t){if(!hi.isDocumentKey(t))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Hh(t){if(hi.isDocumentKey(t))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Gh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Lr()}function zh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ar(Nr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Gh(t);throw new Ar(Nr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Qh(t,e){if(e<=0)throw new Ar(Nr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Yh=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ar(Nr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ar(Nr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Kh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),$h=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yh({}),this._settingsFrozen=!1,t instanceof xh?(this._databaseId=t,this._credentials=new Lh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ar(Nr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xh(t.options.projectId)}(t),this._credentials=new jh(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Ar(Nr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Ar(Nr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yh(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Lh;switch(t.type){case"gapi":var e=t.client;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new qh(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ar(Nr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Dh.get(this))&&(Rr("ComponentProvider","Removing Datastore"),Dh.delete(this),t.terminate()),Promise.resolve();var t},t}(),Xh=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Zh(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Jh=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Zh=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Xi(r))||this)._path=r,i.type="collection",i}return o(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Xh(this.firestore,null,new hi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Jh);function tf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=(0,c.getModularInstance)(t),Vh("collection","path",e),t instanceof $h)return Hh(n=$r.fromString.apply($r,u([e],r))),new Zh(t,null,n);if(!(t instanceof Xh||t instanceof Zh))throw new Ar(Nr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Hh(n=$r.fromString.apply($r,u([t.path],r)).child($r.fromString(e))),new Zh(t.firestore,null,n)}function ef(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=(0,c.getModularInstance)(t),1===arguments.length&&(e=qr.u()),Vh("doc","path",e),t instanceof $h)return Wh(n=$r.fromString.apply($r,u([e],r))),new Xh(t,null,new hi(n));if(!(t instanceof Xh||t instanceof Zh))throw new Ar(Nr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Wh(n=t._path.child($r.fromString.apply($r,u([e],r)))),new Xh(t.firestore,t instanceof Zh?t.converter:null,new hi(n))}function nf(t,e){return t=(0,c.getModularInstance)(t),e=(0,c.getModularInstance)(e),(t instanceof Xh||t instanceof Zh)&&(e instanceof Xh||e instanceof Zh)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function rf(t,e){return t=(0,c.getModularInstance)(t),e=(0,c.getModularInstance)(e),t instanceof Jh&&e instanceof Jh&&t.firestore===e.firestore&&ao(t._query,e._query)&&t.converter===e.converter}var of=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Rc(this,"async_queue_retry"),this.Tc=function(){var e=Pc();e&&Rr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Pc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Pc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise((function(t){})):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.Rc()}))},t.prototype.Rc=function(){return a(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ns(t=n.sent()))throw t;return Rr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.Rc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ac=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,xr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=ll.createAndSchedule(this,t,e,n,(function(t){return r.bc(t)}));return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Lr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return a(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()}))},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function af(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var sf=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Is,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),uf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new of,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return o(e,t),e.prototype._terminate=function(){return this._firestoreClient||lf(this),this._firestoreClient.terminate()},e}($h);function cf(t){return t._firestoreClient||lf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function lf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Rh(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new _h(t._credentials,t._queue,r)}function hf(t,e,n){var r=this,i=new Is;return t.asyncQueue.enqueue((function(){return a(r,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,wh(t,n)];case 1:return o.sent(),[4,Ih(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Nr.FAILED_PRECONDITION||t.code===Nr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function ff(t){if(t._initialized||t._terminated)throw new Ar(Nr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var pf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jr(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),df=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(ti.fromBase64String(e))}catch(e){throw new Ar(Nr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(ti.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),vf=function(t){this._methodName=t},gf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ar(Nr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ar(Nr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Vr(this._lat,t._lat)||Vr(this._long,t._long)},t}(),yf=/^__.*__$/,mf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Uo(t,this.data,this.fieldMask,e,this.fieldTransforms):new jo(t,this.data,e,this.fieldTransforms)},t}(),bf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Uo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function _f(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Lr()}}var wf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Vf(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(_f(this.Cc)&&yf.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),If=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Oc(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new wf({Cc:t,methodName:e,Bc:n,path:Jr.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Tf(t){var e=t._freezeSettings(),n=Oc(t._databaseId);return new If(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ef(t,e,n,r,i,o){void 0===o&&(o={});var a=t.qc(o.merge||o.mergeFields?2:0,e,n,i);Ff("Data must be an object, but it was:",a,r);var s,u,c=Mf(r,a);if(o.merge)s=new Zr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var p=jf(e,f[h],n);if(!a.contains(p))throw new Ar(Nr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Bf(l,p)||l.push(p)}s=new Zr(l),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new mf(new Ci(c),s,u)}var Sf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+"() can only appear at the top level of your update data"):t.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(vf);function Cf(t,e,n){return new wf({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype._toFieldTransform=function(t){return new No(t.path,new _o)},e.prototype.isEqual=function(t){return t instanceof e},e}(vf),Nf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return o(e,t),e.prototype._toFieldTransform=function(t){var e=Cf(this,t,!0),n=this.Uc.map((function(t){return Df(t,e)})),r=new wo(n);return new No(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vf),Af=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return o(e,t),e.prototype._toFieldTransform=function(t){var e=Cf(this,t,!0),n=this.Uc.map((function(t){return Df(t,e)})),r=new To(n);return new No(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vf),Pf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return o(e,t),e.prototype._toFieldTransform=function(t){var e=new So(t.R,vo(t.R,this.Kc));return new No(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(vf);function Of(t,e,n,r){var i=t.qc(1,e,n);Ff("Data must be an object, but it was:",i,r);var o=[],a=Ci.empty();zr(r,(function(t,r){var s=qf(e,t,n);r=(0,c.getModularInstance)(r);var u=i.$c(s);if(r instanceof Sf)o.push(s);else{var l=Df(r,u);null!=l&&(o.push(s),a.set(s,l))}}));var s=new Zr(o);return new bf(a,s,i.fieldTransforms)}function Rf(t,e,n,r,i,o){var a=t.qc(1,e,n),s=[jf(e,r,n)],u=[i];if(o.length%2!=0)throw new Ar(Nr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var l=0;l<o.length;l+=2)s.push(jf(e,o[l])),u.push(o[l+1]);for(var h=[],f=Ci.empty(),p=s.length-1;p>=0;--p)if(!Bf(h,s[p])){var d=s[p],v=u[p];v=(0,c.getModularInstance)(v);var g=a.$c(d);if(v instanceof Sf)h.push(d);else{var y=Df(v,g);null!=y&&(h.push(d),f.set(d,y))}}var m=new Zr(h);return new bf(f,m,a.fieldTransforms)}function xf(t,e,n,r){return void 0===r&&(r=!1),Df(n,t.qc(r?4:3,e))}function Df(t,e){if(Lf(t=(0,c.getModularInstance)(t)))return Ff("Unsupported field value:",e,t),Mf(t,e);if(t instanceof vf)return function(t,e){if(!_f(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=Df(o[i],e.Oc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,c.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return vo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Wr.fromDate(t);return{timestampValue:Ta(e.R,n)}}if(t instanceof Wr)return n=new Wr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ta(e.R,n)};if(t instanceof gf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof df)return{bytesValue:Ea(e.R,t._byteString)};if(t instanceof Xh){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ka(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+Gh(t))}(t,e)}function Mf(t,e){var n={};return Qr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zr(t,(function(t,r){var i=Df(r,e.xc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Lf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Wr||t instanceof gf||t instanceof df||t instanceof Xh||t instanceof vf)}function Ff(t,e,n){if(!Lf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Gh(n);throw"an object"===r?e.Mc(t+" a custom object"):e.Mc(t+" "+r)}}function jf(t,e,n){if((e=(0,c.getModularInstance)(e))instanceof pf)return e._internalPath;if("string"==typeof e)return qf(t,e);throw Vf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Uf=new RegExp("[~\\*/\\[\\]]");function qf(t,e,n){if(e.search(Uf)>=0)throw Vf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(pf.bind.apply(pf,u([void 0],e.split(".")))))._internalPath}catch(Hp){throw Vf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Vf(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new Ar(Nr.INVALID_ARGUMENT,(s+=". ")+t+u)}function Bf(t,e){return t.some((function(t){return t.isEqual(e)}))}var Kf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Xh(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Wf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Hf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Kf);function Hf(t,e){return"string"==typeof e?qf(t,e):e instanceof pf?e._internalPath:e._delegate._internalPath}var Gf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),zf=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return o(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Qf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Hf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Kf),Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(zf),Yf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Gf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Qf(n._firestore,n._userDataWriter,r.key,r,new Gf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ar(Nr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Qf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Gf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Qf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Gf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:$f(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function $f(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}function Xf(t,e){return t instanceof zf&&e instanceof zf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Yf&&e instanceof Yf&&t._firestore===e._firestore&&rf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Jf(t){if(Zi(t)&&0===t.explicitOrderBy.length)throw new Ar(Nr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zf=function(){};function tp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var ep=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return o(e,t),e.prototype._apply=function(t){var e=Tf(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){up(a,o);for(var u=[],c=0,l=a;c<l.length;c++){var h=l[c];u.push(sp(r,t,h))}s={arrayValue:{values:u}}}else s=sp(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||up(a,o),s=xf(n,"where",a,"in"===o||"not-in"===o);var f=Di.create(i,o,s);return function(t,e){if(e.g()){var n=eo(t);if(null!==n&&!n.isEqual(e.field))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=to(t);null!==r&&cp(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Ar(Nr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ar(Nr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new Jh(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Zf),np=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return o(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Hi(e,n);return function(t,e){if(null===to(t)){var n=eo(t);null!==n&&cp(t,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new Jh(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Yi(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Zf),rp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return o(e,t),e.prototype._apply=function(t){return new Jh(t.firestore,t.converter,oo(t._query,this.zc,this.Hc))},e}(Zf),ip=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return o(e,t),e.prototype._apply=function(t){var e=ap(t,this.type,this.Jc,this.Yc);return new Jh(t.firestore,t.converter,function(t,e){return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Zf),op=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return o(e,t),e.prototype._apply=function(t){var e=ap(t,this.type,this.Jc,this.Yc);return new Jh(t.firestore,t.converter,function(t,e){return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Zf);function ap(t,e,n,r){if(n[0]=(0,c.getModularInstance)(n[0]),n[0]instanceof Kf)return function(t,e,n,r,i){if(!r)throw new Ar(Nr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=ro(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(bi(e,r.key));else{var c=r.data.field(u.field);if(oi(c))throw new Ar(Nr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ki(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Tf(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new Ar(Nr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!no(t)&&-1!==c.indexOf("/"))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child($r.fromString(c));if(!hi.isDocumentKey(l))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new hi(l);s.push(bi(e,h))}else{var f=xf(n,r,c);s.push(f)}}return new Ki(s,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function sp(t,e,n){if("string"==typeof(n=(0,c.getModularInstance)(n))){if(""===n)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!no(e)&&-1!==n.indexOf("/"))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child($r.fromString(n));if(!hi.isDocumentKey(r))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return bi(t,new hi(r))}if(n instanceof Xh)return bi(t,n._key);throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Gh(n)+".")}function up(t,e){if(!Array.isArray(t)||0===t.length)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function cp(t,e,n){if(!n.isEqual(e))throw new Ar(Nr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var lp=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),fi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ri(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ii(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Lr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return zr(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new gf(ri(t.latitude),ri(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=ai(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(si(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ni(t);return new Wr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=$r.fromString(t);Fr(Ja(n));var r=new xh(n.get(1),n.get(3)),i=new hi(n.popFirst(5));return r.isEqual(e)||xr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function hp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var fp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return o(e,t),e.prototype.convertBytes=function(t){return new df(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Xh(this.firestore,null,e)},e}(lp),pp=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Tf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=dp(t,this._firestore),i=hp(r.converter,e,n),o=Ef(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Po.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,a=dp(t,this._firestore);return o="string"==typeof(e=(0,c.getModularInstance)(e))||e instanceof pf?Rf(this._dataReader,"WriteBatch.update",a._key,e,n,r):Of(this._dataReader,"WriteBatch.update",a._key,e),this._mutations.push(o.toMutation(a._key,Po.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=dp(t,this._firestore);return this._mutations=this._mutations.concat(new Ho(e._key,Po.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Ar(Nr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function dp(t,e){if((t=(0,c.getModularInstance)(t)).firestore!==e)throw new Ar(Nr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var vp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return o(e,t),e.prototype.convertBytes=function(t){return new df(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Xh(this.firestore,null,e)},e}(lp);function gp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=zh(t,Xh);var o=zh(t.firestore,uf),a=Tf(o);return mp(o,[("string"==typeof(e=(0,c.getModularInstance)(e))||e instanceof pf?Rf(a,"updateDoc",t._key,e,n,r):Of(a,"updateDoc",t._key,e)).toMutation(t._key,Po.exists(!0))])}function yp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=(0,c.getModularInstance)(t);var u={includeMetadataChanges:!1},l=0;"object"!=typeof i[l]||af(i[l])||(u=i[l],l++);var h,f,p,d={includeMetadataChanges:u.includeMetadataChanges};if(af(i[l])){var v=i[l];i[l]=null===(e=v.next)||void 0===e?void 0:e.bind(v),i[l+1]=null===(n=v.error)||void 0===n?void 0:n.bind(v),i[l+2]=null===(r=v.complete)||void 0===r?void 0:r.bind(v)}if(t instanceof Xh)f=zh(t.firestore,uf),p=Xi(t._key.path),h={next:function(e){i[l]&&i[l](bp(f,t,e))},error:i[l+1],complete:i[l+2]};else{var g=zh(t,Jh);f=zh(g.firestore,uf),p=g._query;var y=new vp(f);h={next:function(t){i[l]&&i[l](new Yf(f,y,g,t))},error:i[l+1],complete:i[l+2]},Jf(t._query)}return function(t,e,n,r){var i=this,o=new gh(r),u=new Il(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return a(i,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=yl,[4,Ah(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return a(i,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=ml,[4,Ah(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(cf(f),p,d,h)}function mp(t,e){return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(n,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return n=Ll,[4,Nh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(cf(t),e)}function bp(t,e,n){var r=n.docs.get(e._key),i=new vp(t);return new zf(t,i,e._key,r,new Gf(n.hasPendingWrites,n.fromCache),e.converter)}var _p=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return o(e,t),e.prototype.get=function(e){var n=this,r=dp(e,this._firestore),i=new vp(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new zf(n._firestore,i,r._key,t._document,new Gf(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Tf(t)}return t.prototype.get=function(t){var e=this,n=dp(t,this._firestore),r=new fp(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Lr();var i=t[0];if(i.isFoundDocument())return new Kf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Kf(e._firestore,r,n._key,null,n.converter);throw Lr()}))},t.prototype.set=function(t,e,n){var r=dp(t,this._firestore),i=hp(r.converter,e,n),o=Ef(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a=dp(t,this._firestore);return o="string"==typeof(e=(0,c.getModularInstance)(e))||e instanceof pf?Rf(this._dataReader,"Transaction.update",a._key,e,n,r):Of(this._dataReader,"Transaction.update",a._key,e),this._transaction.update(a._key,o),this},t.prototype.delete=function(t){var e=dp(t,this._firestore);return this._transaction.delete(e._key),this},t}());function wp(){if("undefined"==typeof Uint8Array)throw new Ar(Nr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ip(){if("undefined"==typeof atob)throw new Ar(Nr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Tp=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Ip(),new t(df.fromBase64String(e))},t.fromUint8Array=function(e){return wp(),new t(df.fromUint8Array(e))},t.prototype.toBase64=function(){return Ip(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return wp(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Ep=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ff(t=zh(t,uf));var n=cf(t),r=t._freezeSettings(),i=new dh;return hf(n,i,new fh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ff(t=zh(t,uf));var e=cf(t),n=t._freezeSettings(),r=new dh;return hf(e,r,new ph(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Ar(Nr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Is;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return a(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return Ss.yt()?(e=t+"main",[4,Ss.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Lu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Sp=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof xh||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Dr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=zh(t,$h))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=(0,c.createMockUserToken)(r.mockUserToken),a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Ar(Nr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Fh(new Mh(o,new pc(a)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return a(e,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,Sh(t)];case 1:return e=r.sent(),[4,kh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=jr(t);return e.Or.delete(0),Uc(e)}(n))]}}))}))}))}(cf(zh(this._delegate,uf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return a(e,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,Sh(t)];case 1:return e=r.sent(),[4,kh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return(e=jr(t)).Or.add(0),[4,qc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(cf(zh(this._delegate,uf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Kh("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return e=Bl,[4,Nh(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(cf(zh(this._delegate,uf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new gh(e);return t.asyncQueue.enqueueAndForget((function(){return a(n,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=function(t,e){jr(t).Gr.add(e),e.next()},[4,Ah(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return a(n,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=function(t,e){jr(t).Gr.delete(e)},[4,Ah(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(cf(t=zh(t,uf)),af(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Ar(Nr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Up(this,tf(this._delegate,t))}catch(t){throw Op(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Pp(this,ef(this._delegate,t))}catch(t){throw Op(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Lp(this,function(t,e){if(t=zh(t,$h),Vh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Jh(t,null,function(t){return new Yi($r.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Op(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(n,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return[4,function(t){return Eh(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new bh(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(cf(t),(function(n){return e(new _p(t,n))}))}(this._delegate,(function(n){return t(new kp(e,n))}))},t.prototype.batch=function(){var t=this;return cf(this._delegate),new Np(new pp(this._delegate,(function(e){return mp(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Ar(Nr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Ar(Nr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Cp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return o(e,t),e.prototype.convertBytes=function(t){return new Tp(new df(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Pp.tu(e,this.firestore,null)},e}(lp);var kp=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Cp(t)}return t.prototype.get=function(t){var e=this,n=qp(t);return this._delegate.get(n).then((function(t){return new Dp(e._firestore,new zf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=qp(t);return n?(Bh("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=qp(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,u([a,e,n],i)),this},t.prototype.delete=function(t){var e=qp(t);return this._delegate.delete(e),this},t}(),Np=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=qp(t);return n?(Bh("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=qp(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,u([a,e,n],i)),this},t.prototype.delete=function(t){var e=qp(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ap=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Qf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Mp(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Cp(e),n),i.set(n,o)),o},t}();Ap.nu=new WeakMap;var Pp=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Cp(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Ar(Nr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Xh(n._delegate,r,new hi(e)))},t.tu=function(e,n,r){return new t(n,new Xh(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Up(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Up(this.firestore,tf(this._delegate,t))}catch(t){throw Op(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=(0,c.getModularInstance)(t))instanceof Xh&&nf(this._delegate,t)},t.prototype.set=function(t,e){e=Bh("DocumentReference.set",e);try{return function(t,e,n){t=zh(t,Xh);var r=zh(t.firestore,uf),i=hp(t.converter,e,n);return mp(r,[Ef(Tf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Po.none())])}(this._delegate,t,e)}catch(t){throw Op(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?gp(this._delegate,t):gp.apply(void 0,u([this._delegate,t,e],n))}catch(t){throw Op(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return mp(zh((t=this._delegate).firestore,uf),[new Ho(t._key,Po.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Rp(e),i=xp(e,(function(e){return new Dp(t.firestore,new zf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return yp(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zh(t,Xh);var e=zh(t.firestore,uf),n=cf(e),r=new vp(e);return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(n,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return a(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=jr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Ar(Nr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=hl(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Ch(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new zf(e,r,t._key,n,new Gf(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zh(t,Xh);var e=zh(t.firestore,uf);return Ph(cf(e),t._key,{source:"server"}).then((function(n){return bp(e,t,n)}))}(this._delegate):function(t){t=zh(t,Xh);var e=zh(t.firestore,uf);return Ph(cf(e),t._key).then((function(n){return bp(e,t,n)}))}(this._delegate)).then((function(t){return new Dp(e.firestore,new zf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ap.eu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Op(t,e,n){return t.message=t.message.replace(e,n),t}function Rp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!af(r))return r}return{}}function xp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=af(t[0])?t[0]:af(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Dp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Pp(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Xf(this._delegate,t._delegate)},t}(),Mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Dp),Lp=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Cp(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,tp(this._delegate,function(t,e,n){var r=e,i=Hf("where",t);return new ep(i,r,n)}(e,n,r)))}catch(e){throw Op(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,tp(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Hf("orderBy",t);return new np(r,n)}(e,n)))}catch(e){throw Op(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,tp(this._delegate,function(t){return Qh("limit",t),new rp("limit",t,"F")}(e)))}catch(e){throw Op(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,tp(this._delegate,function(t){return Qh("limitToLast",t),new rp("limitToLast",t,"L")}(e)))}catch(e){throw Op(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,tp(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Op(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,tp(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Op(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,tp(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Op(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,tp(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Op(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return rf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zh(t,Jh);var e=zh(t.firestore,uf),n=cf(e),r=new vp(e);return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return a(n,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return a(this,void 0,void 0,(function(){var r,i,o,a,u;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Xu(t,e,!0)];case 1:return u=s.sent(),r=new Al(e,u.Bn),i=r._o(u.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=s.sent(),u=hl(a,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,Ch(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Yf(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zh(t,Jh);var e=zh(t.firestore,uf),n=cf(e),r=new vp(e);return Oh(n,t._query,{source:"server"}).then((function(n){return new Yf(e,r,t,n)}))}(this._delegate):function(t){t=zh(t,Jh);var e=zh(t.firestore,uf),n=cf(e),r=new vp(e);return Jf(t._query),Oh(n,t._query).then((function(n){return new Yf(e,r,t,n)}))}(this._delegate)).then((function(t){return new jp(e.firestore,new Yf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Rp(e),i=xp(e,(function(e){return new jp(t.firestore,new Yf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return yp(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ap.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Fp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Mp(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),jp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Lp(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Mp(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Fp(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Mp(n._firestore,r))}))},t.prototype.isEqual=function(t){return Xf(this._delegate,t._delegate)},t}(),Up=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return o(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Pp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Pp(this.firestore,void 0===t?ef(this._delegate):ef(this._delegate,t))}catch(t){throw Op(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=zh(t.firestore,uf),r=ef(t),i=hp(t.converter,e);return mp(n,[Ef(Tf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Po.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Pp(e.firestore,t)}))},e.prototype.isEqual=function(t){return nf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Ap.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(Lp);function qp(t){return zh(t,Xh)}var Vp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(pf.bind.apply(pf,u([void 0],t)))}return t.documentId=function(){return new t(Jr.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=(0,c.getModularInstance)(t))instanceof pf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Bp=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new kf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Sf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Nf("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Af("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Pf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();function Kp(t){return function(t,e){var n=cf(t=zh(t,uf)),r=new sf;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new yh(t,e)}(function(t,e){if(t instanceof Uint8Array)return vh(t,e);if(t instanceof ArrayBuffer)return vh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,Oc(e));t.asyncQueue.enqueueAndForget((function(){return a(i,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=lh,[4,Nh(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)}function Wp(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return a(n,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=jr(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Ke.getNamedQuery(t,e)}))},[4,Ch(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(cf(e=zh(e,uf)),n).then((function(t){return t?new Jh(e,null,t.query):null}))).then((function(t){return t?new Lp(r,t):null}))}var Hp,Gp,zp=n(8886),Qp={Firestore:Sp,GeoPoint:gf,Timestamp:Wr,Blob:Tp,Transaction:kp,WriteBatch:Np,DocumentReference:Pp,DocumentSnapshot:Dp,Query:Lp,QueryDocumentSnapshot:Mp,QuerySnapshot:jp,CollectionReference:Up,FieldPath:Vp,FieldValue:Bp,setLogLevel:function(t){var e;e=t,Pr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new zp.Component("firestore",(function(t){return function(t,e){return new Sp(t,new uf(t,e),new Ep)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Qp)))})(Hp=r.default),Hp.registerVersion("@firebase/firestore","2.3.8"),(Gp=Sp).prototype.loadBundle=Kp,Gp.prototype.namedQuery=Wp;var Yp=function(t,e){return(Yp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function $p(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Xp(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;Object.create;var Jp={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Zp=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Yp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error);var td=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return $p(this,void 0,void 0,(function(){var t;return Xp(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return $p(this,void 0,void 0,(function(){return Xp(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return $p(this,void 0,void 0,(function(){var t,e;return Xp(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function ed(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var nd=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"===typeof t||"object"===typeof t)return ed(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"===typeof t||"object"===typeof t?ed(t,(function(t){return e.decode(t)})):t},t}();var rd=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new nd,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new td(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(Hp){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return $p(this,void 0,void 0,(function(){var r,i,o;return Xp(this,(function(a){switch(a.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=a.sent())&&(n["X-Firebase-AppCheck"]=r),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=a.sent(),[3,5];case 4:return a.sent(),[2,{status:0,json:null}];case 5:o=null,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,i.json()];case 7:return o=a.sent(),[3,9];case 8:return a.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return $p(this,void 0,void 0,(function(){var t;return Xp(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return $p(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f,p;return Xp(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=d.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Zp("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(s),c=u.timer,l=u.promise,[4,Promise.race([id(c,this.postJSON(r,i,o)),l,id(c,this.cancelAllRequests)])];case 2:if(!(h=d.sent()))throw new Zp("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"===typeof s){if(!Jp[s])return new Zp("internal","internal");r=Jp[s],i=s}var u=a.message;"string"===typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(Hp){}return"ok"===r?null:new Zp(r,i,o)}(h.status,h.json,this.serializer))throw f;if(!h.json)throw new Zp("internal","Response is not valid JSON object.");if("undefined"===typeof(p=h.json.data)&&(p=h.json.result),"undefined"===typeof p)throw new Zp("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function id(t,e){return $p(this,void 0,void 0,(function(){var n;return Xp(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}!function(t,e){var n={Functions:rd};t.INTERNAL.registerComponent(new zp.Component("functions",(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal"),s=t.getProvider("messaging");return new rd(i,o,s,a,r,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(r.default,fetch.bind(self)),r.default.registerVersion("@firebase/functions","0.6.13");var od=function(){return(od=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function ad(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function sd(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function ud(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function cd(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}Object.create;var ld,hd=n(8676),fd="0.4.30",pd=1e4,dd="w:0.4.30",vd="FIS_v2",gd=36e5,yd=((ld={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',ld["not-registered"]="Firebase Installation is not registered.",ld["installation-not-found"]="Firebase Installation not found.",ld["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',ld["app-offline"]="Could not process request. Application offline.",ld["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",ld),md=new c.ErrorFactory("installations","Installations",yd);function bd(t){return t instanceof c.FirebaseError&&t.code.includes("request-failed")}function _d(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function wd(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function Id(t,e){return ad(this,void 0,void 0,(function(){var n,r;return sd(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,md.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function Td(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Ed(t,e){var n=e.refreshToken,r=Td(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function Sd(t){return ad(this,void 0,void 0,(function(){var e;return sd(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Cd(t,e){var n=e.fid;return ad(this,void 0,void 0,(function(){var e,r,i,o,a,s;return sd(this,(function(u){switch(u.label){case 0:return e=_d(t),r=Td(t),i={fid:n,authVersion:vd,appId:t.appId,sdkVersion:dd},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,Sd((function(){return fetch(e,o)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return s=u.sent(),[2,{fid:s.fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:wd(s.authToken)}];case 3:return[4,Id("Create Installation",a)];case 4:throw u.sent()}}))}))}function kd(t){return new Promise((function(e){setTimeout(e,t)}))}function Nd(t){return btoa(String.fromCharCode.apply(String,function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}([],cd(t)))).replace(/\+/g,"-").replace(/\//g,"_")}var Ad=/^[cdef][\w-]{21}$/;function Pd(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return Nd(t).substr(0,22)}(t);return Ad.test(e)?e:""}catch(Cf){return""}}function Od(t){return t.appName+"!"+t.appId}var Rd=new Map;function xd(t,e){var n=Od(t);Dd(n,e),function(t,e){var n=Ld();n&&n.postMessage({key:t,fid:e});Fd()}(n,e)}function Dd(t,e){var n,r,i=Rd.get(t);if(i)try{for(var o=ud(i),a=o.next();!a.done;a=o.next()){(0,a.value)(e)}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var Md=null;function Ld(){return!Md&&"BroadcastChannel"in self&&((Md=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Dd(t.data.key,t.data.fid)}),Md}function Fd(){0===Rd.size&&Md&&(Md.close(),Md=null)}var jd,Ud="firebase-installations-store",qd=null;function Vd(){return qd||(qd=(0,hd.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Ud)}}))),qd}function Bd(t,e){return ad(this,void 0,void 0,(function(){var n,r,i,o,a;return sd(this,(function(s){switch(s.label){case 0:return n=Od(t),[4,Vd()];case 1:return r=s.sent(),i=r.transaction(Ud,"readwrite"),[4,(o=i.objectStore(Ud)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||xd(t,e.fid),[2,e]}}))}))}function Kd(t){return ad(this,void 0,void 0,(function(){var e,n,r;return sd(this,(function(i){switch(i.label){case 0:return e=Od(t),[4,Vd()];case 1:return n=i.sent(),[4,(r=n.transaction(Ud,"readwrite")).objectStore(Ud).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Wd(t,e){return ad(this,void 0,void 0,(function(){var n,r,i,o,a,s;return sd(this,(function(u){switch(u.label){case 0:return n=Od(t),[4,Vd()];case 1:return r=u.sent(),i=r.transaction(Ud,"readwrite"),[4,(o=i.objectStore(Ud)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||xd(t,s.fid),[2,s]}}))}))}function Hd(t){return ad(this,void 0,void 0,(function(){var e,n,r;return sd(this,(function(i){switch(i.label){case 0:return[4,Wd(t,(function(n){var r=function(t){return Qd(t||{fid:Pd(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(md.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return ad(this,void 0,void 0,(function(){var n,r;return sd(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Cd(t,e)];case 1:return n=i.sent(),[2,Bd(t,n)];case 2:return bd(r=i.sent())&&409===r.customData.serverCode?[4,Kd(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Bd(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Gd(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function Gd(t){return ad(this,void 0,void 0,(function(){var e,n,r,i;return sd(this,(function(o){switch(o.label){case 0:return[4,zd(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,kd(100)];case 3:return o.sent(),[4,zd(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,Hd(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function zd(t){return Wd(t,(function(t){if(!t)throw md.create("installation-not-found");return Qd(t)}))}function Qd(t){return 1===(e=t).registrationStatus&&e.registrationTime+pd<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Yd(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return ad(this,void 0,void 0,(function(){var t,i,o,a,s,u,c;return sd(this,(function(l){switch(l.label){case 0:return t=function(t,e){var n=e.fid;return _d(t)+"/"+n+"/authTokens:generate"}(n,e),i=Ed(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:dd}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,Sd((function(){return fetch(t,s)}))];case 1:return(u=l.sent()).ok?[4,u.json()]:[3,3];case 2:return c=l.sent(),[2,wd(c)];case 3:return[4,Id("Generate Auth Token",u)];case 4:throw l.sent()}}))}))}function $d(t,e){return void 0===e&&(e=!1),ad(this,void 0,void 0,(function(){var n,r,i;return sd(this,(function(o){switch(o.label){case 0:return[4,Wd(t.appConfig,(function(r){if(!Jd(r))throw md.create("not-registered");var i=r.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+gd}(t)}(i))return r;if(1===i.requestStatus)return n=function(t,e){return ad(this,void 0,void 0,(function(){var n,r;return sd(this,(function(i){switch(i.label){case 0:return[4,Xd(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,kd(100)];case 3:return i.sent(),[4,Xd(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,$d(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw md.create("app-offline");var o=function(t){var e={requestStatus:1,requestTime:Date.now()};return od(od({},t),{authToken:e})}(r);return n=function(t,e){return ad(this,void 0,void 0,(function(){var n,r,i;return sd(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,Yd(t,e)];case 1:return n=o.sent(),i=od(od({},e),{authToken:n}),[4,Bd(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!bd(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,Kd(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=od(od({},e),{authToken:{requestStatus:0}}),[4,Bd(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function Xd(t){return Wd(t,(function(t){if(!Jd(t))throw md.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+pd<Date.now()?od(od({},t),{authToken:{requestStatus:0}}):t}))}function Jd(t){return void 0!==t&&2===t.registrationStatus}function Zd(t){return ad(this,void 0,void 0,(function(){var e;return sd(this,(function(n){switch(n.label){case 0:return[4,Hd(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function tv(t,e){return ad(this,void 0,void 0,(function(){var n,r,i,o;return sd(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return _d(t)+"/"+n}(t,e),r=Ed(t,e),i={method:"DELETE",headers:r},[4,Sd((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,Id("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function ev(t,e){var n=t.appConfig;return function(t,e){Ld();var n=Od(t),r=Rd.get(n);r||(r=new Set,Rd.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=Od(t),r=Rd.get(n);r&&(r.delete(e),0===r.size&&Rd.delete(n),Fd())}(n,e)}}function nv(t){return md.create("missing-app-config-values",{valueName:t})}(jd=r.default).INTERNAL.registerComponent(new zp.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw nv("App Configuration");if(!t.name)throw nv("App Name");try{for(var r=ud(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw nv(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return ad(this,void 0,void 0,(function(){var e,n,r;return sd(this,(function(i){switch(i.label){case 0:return[4,Hd(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):$d(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),ad(this,void 0,void 0,(function(){return sd(this,(function(n){switch(n.label){case 0:return[4,Zd(t.appConfig)];case 1:return n.sent(),[4,$d(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return ad(this,void 0,void 0,(function(){var e,n;return sd(this,(function(r){switch(r.label){case 0:return[4,Wd(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw md.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw md.create("app-offline");case 3:return[4,tv(e,n)];case 4:return r.sent(),[4,Kd(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return ev(n,t)}}}),"PUBLIC")),jd.registerVersion("@firebase/installations",fd);var rv=function(){return(rv=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function iv(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function ov(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function av(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sv(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}var uv;Object.create;var cv,lv=((uv={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',uv["only-available-in-window"]="This method is available in a Window context.",uv["only-available-in-sw"]="This method is available in a service worker context.",uv["permission-default"]="The notification permission was not granted and dismissed instead.",uv["permission-blocked"]="The notification permission was not granted and blocked instead.",uv["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",uv["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",uv["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",uv["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",uv["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",uv["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",uv["token-update-no-token"]="FCM returned no token when updating the user to push.",uv["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",uv["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",uv["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",uv["invalid-vapid-key"]="The public VAPID key must be a string.",uv["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",uv),hv=new c.ErrorFactory("messaging","Messaging",lv),fv="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",pv="google.c.a.c_id";function dv(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}([],sv(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function vv(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(cv||(cv={}));var gv="fcm_token_details_db",yv="fcm_token_object_Store";function mv(t){return iv(this,void 0,void 0,(function(){var e,n,r=this;return ov(this,(function(i){switch(i.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(e=i.sent(),!e.map((function(t){return t.name})).includes(gv))return[2,null];i.label=2;case 2:return n=null,[4,(0,hd.openDb)(gv,5,(function(e){return iv(r,void 0,void 0,(function(){var r,i,o,a;return ov(this,(function(s){switch(s.label){case 0:return e.oldVersion<2?[2]:e.objectStoreNames.contains(yv)?[4,(r=e.transaction.objectStore(yv)).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,r.clear()];case 2:if(s.sent(),!i)return[2];if(2===e.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];n={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"===typeof o.vapidKey?o.vapidKey:dv(o.vapidKey)}}}else(3===e.oldVersion||4===e.oldVersion)&&(n={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:dv(o.auth),p256dh:dv(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:dv(o.vapidKey)}});return[2]}}))}))}))];case 3:return i.sent().close(),[4,(0,hd.deleteDb)(gv)];case 4:return i.sent(),[4,(0,hd.deleteDb)("fcm_vapid_details_db")];case 5:return i.sent(),[4,(0,hd.deleteDb)("undefined")];case 6:return i.sent(),[2,bv(n)?n:null]}}))}))}function bv(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"===typeof t.createTime&&t.createTime>0&&"string"===typeof t.token&&t.token.length>0&&"string"===typeof e.auth&&e.auth.length>0&&"string"===typeof e.p256dh&&e.p256dh.length>0&&"string"===typeof e.endpoint&&e.endpoint.length>0&&"string"===typeof e.swScope&&e.swScope.length>0&&"string"===typeof e.vapidKey&&e.vapidKey.length>0}var _v="firebase-messaging-store",wv=null;function Iv(){return wv||(wv=(0,hd.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(_v)}}))),wv}function Tv(t){return iv(this,void 0,void 0,(function(){var e,n,r;return ov(this,(function(i){switch(i.label){case 0:return e=Cv(t),[4,Iv()];case 1:return[4,i.sent().transaction(_v).objectStore(_v).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,mv(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,Ev(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function Ev(t,e){return iv(this,void 0,void 0,(function(){var n,r,i;return ov(this,(function(o){switch(o.label){case 0:return n=Cv(t),[4,Iv()];case 1:return r=o.sent(),[4,(i=r.transaction(_v,"readwrite")).objectStore(_v).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function Sv(t){return iv(this,void 0,void 0,(function(){var e,n,r;return ov(this,(function(i){switch(i.label){case 0:return e=Cv(t),[4,Iv()];case 1:return n=i.sent(),[4,(r=n.transaction(_v,"readwrite")).objectStore(_v).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Cv(t){return t.appConfig.appId}function kv(t,e){return iv(this,void 0,void 0,(function(){var n,r,i,o,a,s;return ov(this,(function(u){switch(u.label){case 0:return[4,Ov(t)];case 1:n=u.sent(),r=Rv(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(Pv(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),hv.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,hv.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw hv.create("token-subscribe-no-token");return[2,o.token]}}))}))}function Nv(t,e){return iv(this,void 0,void 0,(function(){var n,r,i,o,a,s;return ov(this,(function(u){switch(u.label){case 0:return[4,Ov(t)];case 1:n=u.sent(),r=Rv(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(Pv(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),hv.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,hv.create("token-update-failed",{errorInfo:s});if(!o.token)throw hv.create("token-update-no-token");return[2,o.token]}}))}))}function Av(t,e){return iv(this,void 0,void 0,(function(){var n,r,i,o,a;return ov(this,(function(s){switch(s.label){case 0:return[4,Ov(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Pv(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,hv.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),hv.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function Pv(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function Ov(t){var e=t.appConfig,n=t.installations;return iv(this,void 0,void 0,(function(){var t;return ov(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function Rv(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==fv&&(o.web.applicationPubKey=i),o}function xv(t,e,n){return iv(this,void 0,void 0,(function(){var r,i,o,a;return ov(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw hv.create("permission-blocked");return[4,Fv(e,n)];case 1:return r=s.sent(),[4,Tv(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:dv(r.getKey("auth")),p256dh:dv(r.getKey("p256dh"))},i?[3,3]:[2,Lv(t,o)];case 3:if(function(t,e){var n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}(i.subscriptionOptions,o))return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Av(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,Lv(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Mv({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}}))}))}function Dv(t,e){return iv(this,void 0,void 0,(function(){var n,r;return ov(this,(function(i){switch(i.label){case 0:return[4,Tv(t)];case 1:return(n=i.sent())?[4,Av(t,n.token)]:[3,4];case 2:return i.sent(),[4,Sv(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function Mv(t,e,n){return iv(this,void 0,void 0,(function(){var r,i,o;return ov(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,Nv(e,t)];case 1:return r=a.sent(),i=rv(rv({},t),{token:r,createTime:Date.now()}),[4,Ev(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,Dv(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function Lv(t,e){return iv(this,void 0,void 0,(function(){var n,r;return ov(this,(function(i){switch(i.label){case 0:return[4,kv(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,Ev(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function Fv(t,e){return iv(this,void 0,void 0,(function(){var n;return ov(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:vv(e)})]}}))}))}function jv(t){return"object"===typeof t&&!!t&&pv in t}function Uv(t){return new Promise((function(e){setTimeout(e,t)}))}var qv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!==typeof t)throw hv.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return iv(this,void 0,void 0,(function(){var n;return ov(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,Tv(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null===n||void 0===n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:fv,r.label=2;case 2:return[2,xv(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return Dv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw hv.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw hv.create("use-vapid-key-after-get-token");if("string"!==typeof t||0===t.length)throw hv.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw hv.create("only-available-in-window")},t.prototype.onMessage=function(){throw hv.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw hv.create("only-available-in-window")},t.prototype.onPush=function(t){return iv(this,void 0,void 0,(function(){var e,n,r,i;return ov(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(n){return null}}(t))?[4,Wv()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Kv(n,e)]:(r=!1,e.notification?[4,Hv(Vv(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"===typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,Uv(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return iv(this,void 0,void 0,(function(){var r;return ov(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,Dv(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,Tv(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Dv(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,xv(this.firebaseDependencies,self.registration,null!==(n=null===(e=null===r||void 0===r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:fv)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return iv(this,void 0,void 0,(function(){var r,i,o,a,s;return ov(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;if(i)return i;return jv(t.data)?self.location.origin:null}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,Bv(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,Uv(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=cv.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function Vv(t){var e,n=rv({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function Bv(t){return iv(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return ov(this,(function(u){switch(u.label){case 0:return[4,Wv()];case 1:e=u.sent();try{for(n=av(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(c){a={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function Kv(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=cv.PUSH_RECEIVED;try{for(var i=av(t),o=i.next();!o.done;o=i.next()){o.value.postMessage(e)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Wv(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Hv(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Gv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return iv(this,void 0,void 0,(function(){var e,n;return ov(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===cv.PUSH_RECEIVED&&("function"===typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),jv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return iv(this,void 0,void 0,(function(){return ov(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw hv.create("permission-blocked");return[4,this.updateVapidKey(null===t||void 0===t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null===t||void 0===t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,xv(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return iv(this,void 0,void 0,(function(){return ov(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=fv),[2]}))}))},t.prototype.updateSwReg=function(t){return iv(this,void 0,void 0,(function(){return ov(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw hv.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return iv(this,void 0,void 0,(function(){var t,e;return ov(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),hv.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return iv(this,void 0,void 0,(function(){return ov(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,Dv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return iv(this,void 0,void 0,(function(){var t;return ov(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?hv.create("permission-blocked"):hv.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw hv.create("use-vapid-key-after-get-token");if("string"!==typeof t||0===t.length)throw hv.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw hv.create("invalid-sw-registration");if(this.swRegistration)throw hv.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw hv.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw hv.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return iv(this,void 0,void 0,(function(){var n;return ov(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case cv.NOTIFICATION_CLICKED:return"notification_open";case cv.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function zv(t){return hv.create("missing-app-config-values",{valueName:t})}var Qv={isSupported:Yv};function Yv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}r.default.INTERNAL.registerComponent(new zp.Component("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw zv("App Configuration Object");if(!t.name)throw zv("App Name");var r=t.options;try{for(var i=av(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw zv(a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Yv())throw hv.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new qv(n):new Gv(n)}),"PUBLIC").setServiceProps(Qv));var $v=function(t,e){return($v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Xv=function(){return(Xv=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Jv(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Zv(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function tg(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create;var eg="firebasestorage.googleapis.com",ng=function(t){function e(n,r){var i=t.call(this,rg(n),"Firebase Storage: "+r+" ("+rg(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}$v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._codeEquals=function(t){return rg(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(c.FirebaseError);function rg(t){return"storage/"+t}function ig(){return new ng("unknown","An unknown error occurred, please check the error payload for server response.")}function og(){return new ng("canceled","User canceled the upload/download.")}function ag(){return new ng("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function sg(t){return new ng("invalid-argument",t)}function ug(){return new ng("app-deleted","The Firebase app was deleted.")}function cg(t){return new ng("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lg(t,e){return new ng("invalid-format","String does not match format '"+t+"': "+e)}function hg(t){throw new ng("internal-error","Internal error: "+t)}var fg={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},pg=function(t,e){this.data=t,this.contentType=e||null};function dg(t,e){switch(t){case fg.RAW:return new pg(vg(e));case fg.BASE64:case fg.BASE64URL:return new pg(gg(t,e));case fg.DATA_URL:return new pg(function(t){var e=new yg(t);return e.base64?gg(fg.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(Hp){throw lg(fg.DATA_URL,"Malformed data URL.")}return vg(e)}(e.rest)}(e),new yg(e).contentType)}throw ig()}function vg(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<t.length-1&&56320===(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320===(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function gg(t,e){switch(t){case fg.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw lg(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case fg.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw lg(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(Hp){throw lg(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var yg=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw lg(fg.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i};var mg,bg={STATE_CHANGED:"state_changed"},_g={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function wg(t){switch(t){case"running":case"pausing":case"canceling":return _g.RUNNING;case"paused":return _g.PAUSED;case"success":return _g.SUCCESS;case"canceled":return _g.CANCELED;case"error":default:return _g.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(mg||(mg={}));var Ig=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=mg.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=mg.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=mg.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw hg("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw hg("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw hg("cannot .getStatus() before sending");try{return this.xhr_.status}catch(Hp){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw hg("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}();var Tg=function(){function t(){}return t.prototype.createConnection=function(){return new Ig},t}(),Eg=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(Hp){return new t(e,"")}if(""===r.path)return r;throw new ng("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===eg?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var l=u[c],h=l.regex.exec(e);if(h){var f=h[l.indices.bucket],p=h[l.indices.path];p||(p=""),r=new t(f,p),l.postModify(r);break}}if(null==r)throw function(t){return new ng("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),Sg=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function Cg(t){return"string"===typeof t||t instanceof String}function kg(t){return Ng()&&t instanceof Blob}function Ng(){return"undefined"!==typeof Blob}function Ag(t,e,n,r){if(r<e)throw sg("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw sg("Invalid value for '"+t+"'. Expected "+n+" or less.")}function Pg(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null===n||void 0===n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function Og(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}var Rg=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.connection;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());!function(t){return void 0!==t}(s)?i():i(s)}catch(Hp){o(Hp)}else null!==a?((r=ig()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?ug():og()):o(r=new ng("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new xg(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var u=!1;function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u||(u=!0,e.apply(null,t))}function l(e){i=setTimeout((function(){i=null,t(h,s())}),e)}function h(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)c.call.apply(c,tg([null,t],e));else{var i;s()||o?c.call.apply(c,tg([null,t],e)):(r<64&&(r*=2),1===a?(a=2,i=0):i=1e3*(r+Math.random()),l(i))}}var f=!1;function p(t){f||(f=!0,u||(null!==i?(t||(a=2),clearTimeout(i),l(0)):t||(a=1)))}return l(0),setTimeout((function(){o=!0,p(!0)}),n),p}((function(e,n){if(n)e(!1,new xg(!1,null,!0));else{var r=t.pool_.createConnection();t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(){null!==t.progressCallback_&&r.removeUploadProgressListener(i),t.pendingConnection_=null;var n=r.getErrorCode()===mg.NO_ERROR,o=r.getStatus();if(n&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new xg(a,r))}else{var s=r.getErrorCode()===mg.ABORT;e(!1,new xg(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),xg=function(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n};function Dg(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Mg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Dg();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Ng())return new Blob(t);throw new ng("unsupported-environment","This browser doesn't seem to support creating Blobs")}var Lg=function(){function t(t,e){var n=0,r="";kg(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(kg(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Ng()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Mg.apply(null,r))}var i=e.map((function(t){return Cg(t)?dg(fg.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function Fg(t){var e;try{e=JSON.parse(t)}catch(Hp){return null}return function(t){return"object"===typeof t&&!Array.isArray(t)}(e)?e:null}function jg(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Ug(t,e){return e}var qg=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Ug},Vg=null;function Bg(){if(Vg)return Vg;var t=[];t.push(new qg("bucket")),t.push(new qg("generation")),t.push(new qg("metageneration")),t.push(new qg("name","fullPath",!0));var e=new qg("name");e.xform=function(t,e){return function(t){return!Cg(t)||t.length<2?t:jg(t)}(e)},t.push(e);var n=new qg("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new qg("timeCreated")),t.push(new qg("updated")),t.push(new qg("md5Hash",null,!0)),t.push(new qg("cacheControl",null,!0)),t.push(new qg("contentDisposition",null,!0)),t.push(new qg("contentEncoding",null,!0)),t.push(new qg("contentLanguage",null,!0)),t.push(new qg("contentType",null,!0)),t.push(new qg("metadata","customMetadata",!0)),Vg=t}function Kg(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Eg(n,r);return e._makeStorageReference(i)}})}(r,t),r}function Wg(t,e,n){var r=Fg(e);return null===r?null:Kg(t,r,n)}function Hg(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function Gg(t,e,n){var r=Fg(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new Eg(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var l=c[u];s=t._makeStorageReference(new Eg(e,l.name)),r.items.push(s)}return r}(t,e,r)}var zg=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Qg(t){if(!t)throw ig()}function Yg(t,e){return function(n,r){var i=Wg(t,r,e);return Qg(null!==i),i}}function $g(t,e){return function(n,r){var i=Wg(t,r,e);return Qg(null!==i),function(t,e,n){var r=Fg(e);if(null===r)return null;if(!Cg(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return Pg("/b/"+o(r)+"/o/"+o(i),n)+Og({alt:"media",token:e})}))[0]}(i,r,t.host)}}function Xg(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new ng("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new ng("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new ng("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new ng("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function Jg(t){var e=Xg(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new ng("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function Zg(t,e,n){var r=Pg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new zg(r,"GET",Yg(t,n),i);return o.errorHandler=Jg(e),o}function ty(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Pg(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new zg(a,"GET",function(t,e){return function(n,r){var i=Gg(t,e,r);return Qg(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=Xg(e),u}function ey(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var ny=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function ry(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(Hp){Qg(!1)}return Qg(!!n&&-1!==(e||["active"]).indexOf(n)),n}var iy=262144;function oy(t,e,n,r,i,o,a,s){var u=new ny(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new ng("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f=h+l,p={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":""+u.current},d=r.slice(h,f);if(null===d)throw ag();var v=e.maxUploadRetryTime,g=new zg(n,"POST",(function(t,n){var i,a=ry(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?Yg(e,o)(t,n):null,new ny(s,c,"final"===a,i)}),v);return g.headers=p,g.body=d.uploadData(),g.progressCallback=s||null,g.errorHandler=Xg(t),g}var ay=function(t,e,n){if(function(t){return"function"===typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}};function sy(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var uy=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Bg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=ey(e,r,i),s={name:a.fullPath},u=Pg(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":""+r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=Hg(a,n),h=t.maxUploadRetryTime,f=new zg(u,"POST",(function(t){var e;ry(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(Hp){Qg(!1)}return Qg(Cg(e)),e}),h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=Xg(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new zg(n,"POST",(function(t){var e=ry(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(Hp){Qg(!1)}n||Qg(!1);var i=Number(n);return Qg(!isNaN(i)),new ny(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Xg(e),o}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=iy*this._chunkMultiplier,n=new ny(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=oy(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(Hp){return t._error=Hp,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){iy*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=Zg(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=ey(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Hg(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=Lg.getBlob(c,r,l);if(null===h)throw ag();var f={name:u.fullPath},p=Pg(o,t.host),d=t.maxUploadRetryTime,v=new zg(p,"POST",Yg(t,n),d);return v.urlParams=f,v.headers=a,v.body=h.uploadData(),v.errorHandler=Xg(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=og(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=wg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new ay(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(wg(this._state)){case _g.SUCCESS:sy(this._resolve.bind(null,this.snapshot))();break;case _g.CANCELED:case _g.ERROR:sy(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(wg(this._state)){case _g.RUNNING:case _g.PAUSED:t.next&&sy(t.next.bind(t,this.snapshot))();break;case _g.SUCCESS:t.complete&&sy(t.complete.bind(t))();break;case _g.CANCELED:case _g.ERROR:t.error&&sy(t.error.bind(t,this._error))();break;default:t.error&&sy(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),cy=function(){function t(t,e){this._service=t,this._location=e instanceof Eg?e:Eg.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new Eg(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return jg(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new Eg(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw cg(t)},t}();function ly(t){var e={prefixes:[],items:[]};return hy(t,e).then((function(){return e}))}function hy(t,e,n){return Jv(this,void 0,void 0,(function(){var r,i,o;return Zv(this,(function(a){switch(a.label){case 0:return[4,fy(t,{pageToken:n})];case 1:return r=a.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,hy(t,e,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function fy(t,e){return Jv(this,void 0,void 0,(function(){var n,r;return Zv(this,(function(i){switch(i.label){case 0:return null!=e&&"number"===typeof e.maxResults&&Ag("options.maxResults",1,1e3,e.maxResults),n=e||{},r=ty(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function py(t,e){return Jv(this,void 0,void 0,(function(){var n;return Zv(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=Pg(e.fullServerUrl(),t.host),o=Hg(n,r),a=t.maxOperationRetryTime,s=new zg(i,"PATCH",Yg(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=Jg(e),s}(t.storage,t._location,e,Bg()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}function dy(t){return Jv(this,void 0,void 0,(function(){var e;return Zv(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=Pg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new zg(r,"GET",$g(t,n),i);return o.errorHandler=Jg(e),o}(t.storage,t._location,Bg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new ng("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function vy(t){return Jv(this,void 0,void 0,(function(){var e;return Zv(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=Pg(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new zg(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=Jg(e),i}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}function gy(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Eg(t._location.bucket,n);return new cy(t.storage,r)}function yy(t){return/^[A-Za-z]+:\/\//.test(t)}function my(t,e){if(t instanceof wy){var n=t;if(null==n._bucket)throw new ng("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new cy(n,n._bucket);return null!=e?my(r,e):r}if(void 0!==e){if(e.includes(".."))throw sg('`path` param cannot contain ".."');return gy(t,e)}return t}function by(t,e){if(e&&yy(e)){if(t instanceof wy)return new cy(t,e);throw sg("To use ref(service, url), the first argument must be a Storage instance.")}return my(t,e)}function _y(t,e){var n=null===e||void 0===e?void 0:e.storageBucket;return null==n?null:Eg.makeFromBucketSpec(n,t)}var wy=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=eg,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Eg.makeFromBucketSpec(i,this._host):_y(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=Eg.makeFromBucketSpec(this._url,t):this._bucket=_y(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){Ag("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){Ag("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return Jv(this,void 0,void 0,(function(){var t,e;return Zv(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return Jv(this,void 0,void 0,(function(){var t;return Zv(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new cy(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new Sg(ug());var i=function(t,e,n,r,i,o){var a=Og(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!==e&&void 0!==e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new Rg(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return Jv(this,void 0,void 0,(function(){var e,n,r;return Zv(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=i.sent(),n=e[0],r=e[1],[2,this._makeRequest(t,n,r)]}}))}))},t}();function Iy(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new uy(t,new Lg(e),n)}(t=(0,c.getModularInstance)(t),e,n)}function Ty(t){return function(t){return Jv(this,void 0,void 0,(function(){var e;return Zv(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=Zg(t.storage,t._location,Bg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,c.getModularInstance)(t))}function Ey(t,e){return by(t=(0,c.getModularInstance)(t),e)}var Sy=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),Cy=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new Sy(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new Sy(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"===typeof e?function(t){return e(new Sy(t,i,i._ref))}:{next:e.next?function(t){return e.next(new Sy(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),ky=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new Ny(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new Ny(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),Ny=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return gy(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new Cy(Iy(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=fg.RAW),this._throwIfRoot("putString");var r=dg(e,t),i=Xv({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new Cy(new uy(this._delegate,new Lg(r.data,!0),i),this)},t.prototype.listAll=function(){var t=this;return function(t){return ly(t=(0,c.getModularInstance)(t))}(this._delegate).then((function(e){return new ky(e,t.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return fy(t=(0,c.getModularInstance)(t),e)}(this._delegate,t||void 0).then((function(t){return new ky(t,e.storage)}))},t.prototype.getMetadata=function(){return Ty(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return py(t=(0,c.getModularInstance)(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return dy(t=(0,c.getModularInstance)(t))}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return vy(t=(0,c.getModularInstance)(t))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw cg(t)},t}(),Ay=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(yy(t))throw sg("ref() expected a child path but got a URL, use refFromURL instead.");return new Ny(Ey(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!yy(t))throw sg("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Eg.makeFromUrl(t,this._delegate.host)}catch(Hp){throw sg("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ny(Ey(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){!function(t,e,n){t.host="http://"+e+":"+n}(this._delegate,t,e)},t}();function Py(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new Ay(i,new wy(i,o,a,new Tg,n,r.default.SDK_VERSION))}!function(t){var e={TaskState:_g,TaskEvent:bg,StringFormat:fg,Storage:wy,Reference:Ny};t.INTERNAL.registerComponent(new zp.Component("storage",Py,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.6")}(r.default);var Oy=function(){return(Oy=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create;function Ry(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create;var xy,Dy,My,Ly="0.4.16",Fy=Ly,jy="FB-PERF-TRACE-MEASURE",Uy="_wt_",qy="_fcp",Vy="_fid",By="@firebase/performance/config",Ky="@firebase/performance/configexpire",Wy="Performance",Hy=((xy={})["trace started"]="Trace {$traceName} was started before.",xy["trace stopped"]="Trace {$traceName} is not running.",xy["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",xy["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",xy["no window"]="Window is not available.",xy["no app id"]="App id is not available.",xy["no project id"]="Project id is not available.",xy["no api key"]="Api key is not available.",xy["invalid cc log"]="Attempted to queue invalid cc event",xy["FB not default"]="Performance can only start when Firebase app instance is the default one.",xy["RC response not ok"]="RC response is not ok",xy["invalid attribute name"]="Attribute name {$attributeName} is invalid.",xy["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",xy["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",xy["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",xy),Gy=new c.ErrorFactory("performance",Wy,Hy),zy=new l.Logger(Wy);zy.logLevel=l.LogLevel.INFO;var Qy,Yy=function(){function t(t){if(this.window=t,!t)throw Gy.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,c.isIndexedDBAvailable)()||(zy.info("IndexedDB is not supported by current browswer"),!1):(zy.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===Dy&&(Dy=new t(My)),Dy},t}();function $y(t,e){var n=t.length-e.length;if(n<0||n>1)throw Gy.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Xy,Jy,Zy=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=$y("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=$y("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw Gy.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw Gy.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw Gy.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Qy&&(Qy=new t),Qy},t}();function tm(){return Xy}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Jy||(Jy={}));var em=["firebase_","google_","ga_"],nm=new RegExp("^[a-zA-Z]\\w*$");function rm(){var t=Yy.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function im(){switch(Yy.getInstance().document.visibilityState){case"visible":return Jy.VISIBLE;case"hidden":return Jy.HIDDEN;default:return Jy.UNKNOWN}}function om(){var t=Yy.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var am="0.0.1",sm=!0,um="FIREBASE_INSTALLATIONS_AUTH";function cm(t){var e=function(){var t=Yy.getInstance().localStorage;if(!t)return;var e=t.getItem(Ky);if(!e||(n=e,!(Number(n)>Date.now())))return;var n;var r=t.getItem(By);if(!r)return;try{return JSON.parse(r)}catch(Cf){return}}();return e?(hm(e),Promise.resolve()):function(t){return function(){var t=Zy.getInstance().installationsService.getToken();return t.then((function(t){})),t}().then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+Zy.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+Zy.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:um+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:Zy.getInstance().getAppId(),app_version:Fy,sdk_version:am})});return fetch(r).then((function(t){if(t.ok)return t.json();throw Gy.create("RC response not ok")}))})).catch((function(){zy.info(lm)}))}(t).then(hm).then((function(t){return function(t){var e=Yy.getInstance().localStorage;if(!t||!e)return;e.setItem(By,JSON.stringify(t)),e.setItem(Ky,String(Date.now()+60*Zy.getInstance().configTimeToLive*60*1e3))}(t)}),(function(){}))}var lm="Could not fetch config, will use default configs";function hm(t){if(!t)return t;var e=Zy.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=sm,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=fm(e.tracesSamplingRate),e.logNetworkAfterSampling=fm(e.networkRequestsSamplingRate),t}function fm(t){return Math.random()<=t}var pm,dm=1;function vm(){return dm=2,pm=pm||function(){var t=Yy.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return function(){var t=Zy.getInstance().installationsService.getId();return t.then((function(t){Xy=t})),t}()})).then((function(t){return cm(t)})).then((function(){return gm()}),(function(){return gm()}))}function gm(){dm=3}var ym,mm=1e4,bm=3,_m=[],wm=!1;function Im(t){setTimeout((function(){if(0!==bm)return _m.length?void function(){var t=_m.splice(0,1e3),e=t.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}));(function(t,e){return function(t){var e=Zy.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||zy.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=mm;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(_m=Ry(Ry([],e),_m),zy.info("Retry transport request later.")),bm=3,Im(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Zy.getInstance().logSource,log_event:e},t).catch((function(){_m=Ry(Ry([],t),_m),bm--,zy.info("Tries left: "+bm+"."),Im(mm)}))}():Im(mm)}),t)}function Tm(t){if(!t.eventTime||!t.message)throw Gy.create("invalid cc log");_m=Ry(Ry([],_m),[t])}function Em(t,e){ym||(ym=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Tm({message:t.apply(void 0,e),eventTime:Date.now()})}}(km)),ym(t,e)}function Sm(t){var e=Zy.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Yy.getInstance().requiredApisAvailable()&&(t.isAuto&&im()!==Jy.VISIBLE||(3===dm?Cm(t):vm().then((function(){return Cm(t)}),(function(){return Cm(t)}))))}function Cm(t){if(tm()){var e=Zy.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return Em(t,1)}),0)}}function km(t,e){return 0===e?function(t){var e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:Nm(),network_request_metric:e};return JSON.stringify(n)}(t):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Nm(),trace_metric:e};return JSON.stringify(r)}(t)}function Nm(){return{google_app_id:Zy.getInstance().getAppId(),app_instance_id:tm(),web_app_info:{sdk_version:Fy,page_url:Yy.getInstance().getUrl(),service_worker_status:rm(),visibility_state:im(),effective_connection_type:om()},application_process_state:0}}var Am=["_fp",qy,Vy];var Pm=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Yy.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw Gy.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw Gy.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Sm(this)},t.prototype.record=function(t,e,n){if(t<=0)throw Gy.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw Gy.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Oy({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Sm(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(n=t,r=this.name,0===n.length||n.length>100||!(r&&r.startsWith(Uy)&&Am.indexOf(n)>-1)&&n.startsWith("_"))throw Gy.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=function(t){var e=Math.floor(t);return e<t&&zy.info("Metric value should be an Integer, setting the value as : "+e+"."),e}(e)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40)&&!em.some((function(t){return n.startsWith(t)}))&&!!n.match(nm),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw Gy.create("invalid attribute name",{attributeName:t});if(!i)throw Gy.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return Oy({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=Yy.getInstance().getUrl();if(i){var o=new t(Uy+i,!0),a=Math.floor(1e3*Yy.getInstance().getTimeOrigin());o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(qy,Math.floor(1e3*u.startTime)),r&&o.putMetric(Vy,Math.floor(1e3*r))}Sm(o)}},t.createUserTimingTrace=function(e){Sm(new t(e,!1,e))},t}();function Om(t){var e=t;if(e&&void 0!==e.responseStart){var n=Yy.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=Zy.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return Em(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Rm(){tm()&&(setTimeout((function(){return function(){var t=Yy.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){Pm.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),Pm.createOobTrace(e,n,t))}))}else Pm.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Yy.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){Om(r[n])}t.setupObserver("resource",Om)}()}),0),setTimeout((function(){return function(){for(var t=Yy.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){xm(r[n])}t.setupObserver("measure",xm)}()}),0))}function xm(t){var e=t.name;e.substring(0,jy.length)!==jy&&Pm.createUserTimingTrace(e)}var Dm=function(){function t(t){this.app=t,Yy.getInstance().requiredApisAvailable()&&(0,c.validateIndexedDBOpenable)().then((function(t){t&&(wm||(Im(5500),wm=!0),vm().then(Rm,Rm))})).catch((function(t){zy.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new Pm(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Zy.getInstance().instrumentationEnabled},set:function(t){Zy.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Zy.getInstance().dataCollectionEnabled},set:function(t){Zy.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){var e=function(t,e){if("[DEFAULT]"!==t.name)throw Gy.create("FB not default");if("undefined"===typeof window)throw Gy.create("no window");return function(t){My=t}(window),Zy.getInstance().firebaseAppInstance=t,Zy.getInstance().installationsService=e,new Dm(t)};t.INTERNAL.registerComponent(new zp.Component("performance",(function(t){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC")),t.registerVersion("@firebase/performance",Ly)}(r.default);var Mm=function(){return(Mm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Lm(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Fm(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;Object.create;var jm,Um,qm="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(jm||(jm={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(Um||(Um={}));var Vm,Bm=new l.Logger("@firebase/analytics");function Km(t,e,n,r,i,o){return Lm(this,void 0,void 0,(function(){var a,s,u,c;return Fm(this,(function(l){switch(l.label){case 0:a=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=l.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return c=l.sent(),Bm.error(c),[3,8];case 8:return t(jm.CONFIG,i,o),[2]}}))}))}function Wm(t,e,n,r,i){return Lm(this,void 0,void 0,(function(){var o,a,s,u,c,l,h,f;return Fm(this,(function(p){switch(p.label){case 0:return p.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=p.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=a;c<l.length&&(h=l[c],"break"!==u(h));c++);p.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return p.sent(),t(jm.EVENT,r,i||{}),[3,5];case 4:return f=p.sent(),Bm.error(f),[3,5];case 5:return[2]}}))}))}function Hm(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return Lm(this,void 0,void 0,(function(){var s;return Fm(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==jm.EVENT?[3,2]:[4,Wm(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==jm.CONFIG?[3,4]:[4,Km(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(jm.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),Bm.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}var Gm=((Vm={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Vm["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Vm["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Vm["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Vm["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Vm["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Vm["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Vm["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Vm["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Vm),zm=new c.ErrorFactory("analytics","Analytics",Gm),Qm=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Ym(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function $m(t){var e;return Lm(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return Fm(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:Ym(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=c.sent()).status||304===a.status)return[3,6];s="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(s=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw zm.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function Xm(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=Qm),Lm(this,void 0,void 0,(function(){var e,a,s,u,l,h,f;return Fm(this,(function(p){switch(p.label){case 0:e=t.appId,a=t.measurementId,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Jm(n,i)];case 2:return p.sent(),[3,4];case 3:if(s=p.sent(),a)return Bm.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+s.message+"]"),[2,{appId:e,measurementId:a}];throw s;case 4:return p.trys.push([4,6,,7]),[4,$m(t)];case 5:return u=p.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof c.FirebaseError)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l=p.sent())){if(r.deleteThrottleMetadata(e),a)return Bm.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:e,measurementId:a}];throw l}return h=503===Number(l.customData.httpStatus)?(0,c.calculateBackoffMillis)(o,r.intervalMillis,30):(0,c.calculateBackoffMillis)(o,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:o+1},r.setThrottleMetadata(e,f),Bm.debug("Calling attemptFetch again in "+h+" millis"),[2,Xm(t,f,n,r)];case 7:return[2]}}))}))}function Jm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(zm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Zm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();function tb(t,e,n,r,i,o){return Lm(this,void 0,void 0,(function(){var a,s,u,l,h,f,p;return Fm(this,(function(d){switch(d.label){case 0:return(a=function(t,e,n){return void 0===e&&(e=Qm),Lm(this,void 0,void 0,(function(){var r,i,o,a,s,u,c=this;return Fm(this,(function(l){if(r=t.options,i=r.appId,o=r.apiKey,a=r.measurementId,!i)throw zm.create("no-app-id");if(!o){if(a)return[2,{measurementId:a,appId:i}];throw zm.create("no-api-key")}return s=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new Zm,setTimeout((function(){return Lm(c,void 0,void 0,(function(){return Fm(this,(function(t){return u.abort(),[2]}))}))}),void 0!==n?n:6e4),[2,Xm({appId:i,apiKey:o,measurementId:a},s,u,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Bm.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Bm.error(t)})),e.push(a),s=function(){return Lm(this,void 0,void 0,(function(){var t;return Fm(this,(function(e){switch(e.label){case 0:return(0,c.isIndexedDBAvailable)()?[3,1]:(Bm.warn(zm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,c.validateIndexedDBOpenable)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),Bm.warn(zm.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([a,s])];case 1:return u=d.sent(),l=u[0],h=u[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(qm))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=qm+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(o,l.measurementId),i("js",new Date),(p={}).origin="firebase",p.update=!0,f=p,null!=h&&(f.firebase_id=h),i(jm.CONFIG,l.measurementId,f),[2,l.measurementId]}}))}))}var eb,nb,rb={},ib=[],ob={},ab="dataLayer",sb="gtag",ub=!1;function cb(t){if(ub)throw zm.create("already-initialized");t.dataLayerName&&(ab=t.dataLayerName),t.gtagName&&(sb=t.gtagName)}function lb(t,e){!function(){var t=[];if((0,c.isBrowserExtension)()&&t.push("This is a browser extension environment."),(0,c.areCookiesEnabled)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=zm.create("invalid-analytics-context",{errorInfo:e});Bm.warn(n.message)}}();var n=t.options.appId;if(!n)throw zm.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw zm.create("no-api-key");Bm.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=rb[n])throw zm.create("already-exists",{id:n});if(!ub){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ab);var r=Hm(rb,ib,ob,ab,sb),i=r.wrappedGtag,o=r.gtagCore;nb=i,eb=o,ub=!0}return rb[n]=tb(t,ib,ob,e,eb,ab),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return Lm(this,void 0,void 0,(function(){var o,a;return Fm(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(jm.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=Mm(Mm({},r),{send_to:o}),t(jm.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(nb,rb[n],t,e,r).catch((function(t){return Bm.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return Lm(this,void 0,void 0,(function(){var i;return Fm(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(jm.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(jm.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(nb,rb[n],t,e).catch((function(t){return Bm.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return Lm(this,void 0,void 0,(function(){var i;return Fm(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(jm.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(jm.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(nb,rb[n],t,e).catch((function(t){return Bm.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return Lm(this,void 0,void 0,(function(){var i,o,a,s,u;return Fm(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return t(jm.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(jm.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(nb,rb[n],t,e).catch((function(t){return Bm.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return Lm(this,void 0,void 0,(function(){var n;return Fm(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(rb[n],t).catch((function(t){return Bm.error(t)}))},INTERNAL:{delete:function(){return delete rb[n],Promise.resolve()}}}}var hb="analytics";function fb(){return Lm(this,void 0,void 0,(function(){return Fm(this,(function(t){switch(t.label){case 0:if((0,c.isBrowserExtension)())return[2,!1];if(!(0,c.areCookiesEnabled)())return[2,!1];if(!(0,c.isIndexedDBAvailable)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,c.validateIndexedDBOpenable)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new zp.Component(hb,(function(t){return lb(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:cb,EventName:Um,isSupported:fb})),t.INTERNAL.registerComponent(new zp.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider(hb).getImmediate().logEvent}}catch(Hp){throw zm.create("interop-component-reg-failed",{reason:Hp})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.14")}(r.default);var pb=function(){return(pb=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function db(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(Hp){o(Hp)}}function s(t){try{u(r.throw(t))}catch(Hp){o(Hp)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function vb(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(Hp){o=[6,Hp],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;Object.create;var gb,yb=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return db(this,void 0,void 0,(function(){var e,n,r,i,o;return vb(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),mb=((gb={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",gb["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",gb["registration-api-key"]="Undefined API key. Check Firebase app initialization.",gb["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",gb["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",gb["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",gb["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",gb["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",gb["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",gb["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',gb["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',gb["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",gb["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",gb),bb=new c.ErrorFactory("remoteconfig","Remote Config",mb);var _b=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return db(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,v,g,y,m,b;return vb(this,(function(_){switch(_.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=_.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:a,body:JSON.stringify(s)},c=fetch(o,u),l=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),_.label=2;case 2:return _.trys.push([2,5,,6]),[4,Promise.race([c,l])];case 3:return _.sent(),[4,c];case 4:return h=_.sent(),[3,6];case 5:throw f=_.sent(),p="fetch-client-network","AbortError"===f.name&&(p="fetch-timeout"),bb.create(p,{originalErrorMessage:f.message});case 6:if(d=h.status,v=h.headers.get("ETag")||void 0,200!==h.status)return[3,11];m=void 0,_.label=7;case 7:return _.trys.push([7,9,,10]),[4,h.json()];case 8:return m=_.sent(),[3,10];case 9:throw b=_.sent(),bb.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:g=m.entries,y=m.state,_.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===y?d=500:"NO_CHANGE"===y?d=304:"NO_TEMPLATE"!==y&&"EMPTY_CONFIG"!==y||(g={}),304!==d&&200!==d)throw bb.create("fetch-status",{httpStatus:d});return[2,{status:d,eTag:v,config:g}]}var w}))}))},t}(),wb=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),Ib=["1","true","t","yes","y","on"],Tb=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&Ib.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),Eb=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=l.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=l.LogLevel.SILENT;break;default:this._logger.logLevel=l.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return db(this,void 0,void 0,(function(){var t,e,n;return vb(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return db(this,void 0,void 0,(function(){var t,e,n,r=this;return vb(this,(function(i){switch(i.label){case 0:t=new wb,setTimeout((function(){return db(r,void 0,void 0,(function(){return vb(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=function(t,e){return t instanceof c.FirebaseError&&-1!==t.code.indexOf(e)}(e,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return db(this,void 0,void 0,(function(){return vb(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return function(t,e){void 0===t&&(t={});void 0===e&&(e={});return Object.keys(pb(pb({},t),e))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Tb("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Tb("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Tb("static"))},t}();function Sb(t,e){var n=t.target.error||void 0;return bb.create(e,{originalErrorMessage:n&&n.message})}var Cb="app_namespace_store";var kb=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Sb(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(Cb,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return db(this,void 0,void 0,(function(){var e,n=this;return vb(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Cb],"readonly").objectStore(Cb),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(Sb(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(Hp){i(bb.create("storage-get",{originalErrorMessage:Hp&&Hp.message}))}}))]}}))}))},t.prototype.set=function(t,e){return db(this,void 0,void 0,(function(){var n,r=this;return vb(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([Cb],"readwrite").objectStore(Cb),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(Sb(t,"storage-set"))},u.onsuccess=function(){i()}}catch(Hp){o(bb.create("storage-set",{originalErrorMessage:Hp&&Hp.message}))}}))]}}))}))},t.prototype.delete=function(t){return db(this,void 0,void 0,(function(){var e,n=this;return vb(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Cb],"readwrite").objectStore(Cb),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(Sb(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(Hp){i(bb.create("storage-delete",{originalErrorMessage:Hp&&Hp.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),Nb=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return db(this,void 0,void 0,(function(){var t,e,n,r,i,o;return vb(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function Ab(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(bb.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Pb,Ob=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return db(this,void 0,void 0,(function(){var e;return vb(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return db(this,void 0,void 0,(function(){var e,i,o;return vb(this,(function(a){switch(a.label){case 0:return[4,Ab(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof c.FirebaseError)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=a.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+(0,c.calculateBackoffMillis)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return a.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),Rb="@firebase/remote-config";(Pb=r.default).INTERNAL.registerComponent(new zp.Component("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"===typeof window)throw bb.create("registration-window");var o=r.options,a=o.projectId,s=o.apiKey,u=o.appId;if(!a)throw bb.create("registration-project-id");if(!s)throw bb.create("registration-api-key");if(!u)throw bb.create("registration-app-id");n=n||"firebase";var c=new kb(u,r.name,n),h=new Nb(c),f=new l.Logger(Rb);f.logLevel=l.LogLevel.ERROR;var p=new _b(i,Pb.SDK_VERSION,n,a,s,u),d=new Ob(p,c),v=new yb(d,c,h,f),g=new Eb(r,v,h,c,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),Pb.registerVersion(Rb,"0.1.41");n(2224);var xb="8.7.1";r.default.registerVersion("firebase",xb,"app"),r.default.SDK_VERSION=xb;console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),r.default.registerVersion("firebase","8.7.1")},8679:function(t,e,n){"use strict";var r=n(1296),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(t){return r.isMemo(t)?a:s[t.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var c=Object.defineProperty,l=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,d=Object.prototype;t.exports=function t(e,n,r){if("string"!==typeof n){if(d){var i=p(n);i&&i!==d&&t(e,i,r)}var a=l(n);h&&(a=a.concat(h(n)));for(var s=u(e),v=u(n),g=0;g<a.length;++g){var y=a[g];if(!o[y]&&(!r||!r[y])&&(!v||!v[y])&&(!s||!s[y])){var m=f(n,y);try{c(e,y,m)}catch(b){}}}}return e}},6103:function(t,e){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,m=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,_=n?Symbol.for("react.scope"):60119;function w(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case l:case h:case o:case s:case a:case p:return t;default:switch(t=t&&t.$$typeof){case c:case f:case g:case v:case u:return t;default:return e}}case i:return e}}}function I(t){return w(t)===h}e.AsyncMode=l,e.ConcurrentMode=h,e.ContextConsumer=c,e.ContextProvider=u,e.Element=r,e.ForwardRef=f,e.Fragment=o,e.Lazy=g,e.Memo=v,e.Portal=i,e.Profiler=s,e.StrictMode=a,e.Suspense=p,e.isAsyncMode=function(t){return I(t)||w(t)===l},e.isConcurrentMode=I,e.isContextConsumer=function(t){return w(t)===c},e.isContextProvider=function(t){return w(t)===u},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return w(t)===f},e.isFragment=function(t){return w(t)===o},e.isLazy=function(t){return w(t)===g},e.isMemo=function(t){return w(t)===v},e.isPortal=function(t){return w(t)===i},e.isProfiler=function(t){return w(t)===s},e.isStrictMode=function(t){return w(t)===a},e.isSuspense=function(t){return w(t)===p},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===o||t===h||t===s||t===a||t===p||t===d||"object"===typeof t&&null!==t&&(t.$$typeof===g||t.$$typeof===v||t.$$typeof===u||t.$$typeof===c||t.$$typeof===f||t.$$typeof===m||t.$$typeof===b||t.$$typeof===_||t.$$typeof===y)},e.typeOf=w},1296:function(t,e,n){"use strict";t.exports=n(6103)},8676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function d(t){this._db=t}function v(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))}function g(t){return r(indexedDB,"deleteDatabase",[t])}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=v,t.deleteDb=g,Object.defineProperty(t,"__esModule",{value:!0})}(e)},161:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return b}});var r=n(6156),i=n(5893);n(3024);function o(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var a="function"===typeof Symbol&&Symbol.observable||"@@observable",s=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+s(),REPLACE:"@@redux/REPLACE"+s(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+s()}};function c(t){if("object"!==typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={idUser:"",userEmail:"",userName:"",userSum:0,userAvatar:"",cardsIncome:[],cardsExpenses:[]};var p=function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];0,"function"===typeof t[i]&&(n[i]=t[i])}var a,s=Object.keys(n);try{!function(t){Object.keys(t).forEach((function(e){var n=t[e];if("undefined"===typeof n(void 0,{type:u.INIT}))throw new Error(o(12));if("undefined"===typeof n(void 0,{type:u.PROBE_UNKNOWN_ACTION()}))throw new Error(o(13))}))}(n)}catch(c){a=c}return function(t,e){if(void 0===t&&(t={}),a)throw a;for(var r=!1,i={},u=0;u<s.length;u++){var c=s[u],l=n[c],h=t[c],f=l(h,e);if("undefined"===typeof f){e&&e.type;throw new Error(o(14))}i[c]=f,r=r||f!==h}return(r=r||s.length!==Object.keys(t).length)?i:t}}({userInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_USER_ID":return h(h({},t),{},{idUser:e.payload});case"SET_USER_NAME":return h(h({},t),{},{userName:e.payload});case"SET_USER_EMAIL":return h(h({},t),{},{userEmail:e.payload});case"SET_USER_SUM":return h(h({},t),{},{userSum:e.payload});case"SET_USER_AVATAR":return h(h({},t),{},{userAvatar:e.payload});case"SET_USER_INCOME_CARDS":return h(h({},t),{},{cardsIncome:e.payload});case"SET_USER_EXPENSES_CARDS":return h(h({},t),{},{cardsExpenses:e.payload});default:return t}}}),d=n(8278),v=n(6940);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=function t(e,n,r){var i;if("function"===typeof n&&"function"===typeof r||"function"===typeof r&&"function"===typeof arguments[3])throw new Error(o(0));if("function"===typeof n&&"undefined"===typeof r&&(r=n,n=void 0),"undefined"!==typeof r){if("function"!==typeof r)throw new Error(o(1));return r(t)(e,n)}if("function"!==typeof e)throw new Error(o(2));var s=e,l=n,h=[],f=h,p=!1;function d(){f===h&&(f=h.slice())}function v(){if(p)throw new Error(o(3));return l}function g(t){if("function"!==typeof t)throw new Error(o(4));if(p)throw new Error(o(5));var e=!0;return d(),f.push(t),function(){if(e){if(p)throw new Error(o(6));e=!1,d();var n=f.indexOf(t);f.splice(n,1),h=null}}}function y(t){if(!c(t))throw new Error(o(7));if("undefined"===typeof t.type)throw new Error(o(8));if(p)throw new Error(o(9));try{p=!0,l=s(l,t)}finally{p=!1}for(var e=h=f,n=0;n<e.length;n++){(0,e[n])()}return t}function m(t){if("function"!==typeof t)throw new Error(o(10));s=t,y({type:u.REPLACE})}function b(){var t,e=g;return(t={subscribe:function(t){if("object"!==typeof t||null===t)throw new Error(o(11));function n(){t.next&&t.next(v())}return n(),{unsubscribe:e(n)}}})[a]=function(){return this},t}return y({type:u.INIT}),(i={dispatch:y,subscribe:g,getState:v,replaceReducer:m})[a]=b,i}(p);function b(t){var e=t.Component,n=t.pageProps;return(0,i.jsx)(v.zt,{store:m,children:(0,i.jsx)(e,y({},n))})}d.Z.initializeApp({apiKey:"AIzaSyD4ZOaQgincn4u2ohZbafA0KebyN68JE9E",authDomain:"project-pfa-e4c83.firebaseapp.com",databaseURL:"https://project-pfa-e4c83-default-rtdb.firebaseio.com",projectId:"project-pfa-e4c83",storageBucket:"project-pfa-e4c83.appspot.com",messagingSenderId:"964044908564",appId:"1:964044908564:web:56963fd7a04f0d8bafdf01"})},1780:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(161)}])},3024:function(){},4155:function(t){var e,n,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"===typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"===typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var s,u=[],c=!1,l=-1;function h(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&f())}function f(){if(!c){var t=a(h);c=!0;for(var e=u.length;e;){for(s=u,u=[];++l<e;)s&&s[l].run();l=-1,e=u.length}s=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function d(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},6940:function(t,e,n){"use strict";n.d(e,{zt:function(){return l},$j:function(){return U}});var r=n(7294),i=(n(5697),r.createContext(null));var o=function(t){t()},a=function(){return o},s={notify:function(){}};var u=function(){function t(t,e){this.store=t,this.parentSub=e,this.unsubscribe=null,this.listeners=s,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var e=t.prototype;return e.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},e.notifyNestedSubs=function(){this.listeners.notify()},e.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},e.isSubscribed=function(){return Boolean(this.unsubscribe)},e.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=function(){var t=a(),e=null,n=null;return{clear:function(){e=null,n=null},notify:function(){t((function(){for(var t=e;t;)t.callback(),t=t.next}))},get:function(){for(var t=[],n=e;n;)t.push(n),n=n.next;return t},subscribe:function(t){var r=!0,i=n={callback:t,next:null,prev:n};return i.prev?i.prev.next=i:e=i,function(){r&&null!==e&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}())},e.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=s)},t}(),c="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?r.useLayoutEffect:r.useEffect;var l=function(t){var e=t.store,n=t.context,o=t.children,a=(0,r.useMemo)((function(){var t=new u(e);return t.onStateChange=t.notifyNestedSubs,{store:e,subscription:t}}),[e]),s=(0,r.useMemo)((function(){return e.getState()}),[e]);c((function(){var t=a.subscription;return t.trySubscribe(),s!==e.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}}),[a,s]);var l=n||i;return r.createElement(l.Provider,{value:a},o)};function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function f(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}var p=n(8679),d=n.n(p),v=n(2973),g=[],y=[null,null];function m(t,e){var n=t[1];return[e.payload,n+1]}function b(t,e,n){c((function(){return t.apply(void 0,e)}),n)}function _(t,e,n,r,i,o,a){t.current=r,e.current=i,n.current=!1,o.current&&(o.current=null,a())}function w(t,e,n,r,i,o,a,s,u,c){if(t){var l=!1,h=null,f=function(){if(!l){var t,n,f=e.getState();try{t=r(f,i.current)}catch(p){n=p,h=p}n||(h=null),t===o.current?a.current||u():(o.current=t,s.current=t,a.current=!0,c({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=f,n.trySubscribe(),f();return function(){if(l=!0,n.tryUnsubscribe(),n.onStateChange=null,h)throw h}}}var I=function(){return[null,0]};function T(t,e){void 0===e&&(e={});var n=e,o=n.getDisplayName,a=void 0===o?function(t){return"ConnectAdvanced("+t+")"}:o,s=n.methodName,c=void 0===s?"connectAdvanced":s,l=n.renderCountProp,p=void 0===l?void 0:l,T=n.shouldHandleStateChanges,E=void 0===T||T,S=n.storeKey,C=void 0===S?"store":S,k=(n.withRef,n.forwardRef),N=void 0!==k&&k,A=n.context,P=void 0===A?i:A,O=f(n,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),R=P;return function(e){var n=e.displayName||e.name||"Component",i=a(n),o=h({},O,{getDisplayName:a,methodName:c,renderCountProp:p,shouldHandleStateChanges:E,storeKey:C,displayName:i,wrappedComponentName:n,WrappedComponent:e}),s=O.pure;var l=s?r.useMemo:function(t){return t()};function T(n){var i=(0,r.useMemo)((function(){var t=n.reactReduxForwardedRef,e=f(n,["reactReduxForwardedRef"]);return[n.context,t,e]}),[n]),a=i[0],s=i[1],c=i[2],p=(0,r.useMemo)((function(){return a&&a.Consumer&&(0,v.isContextConsumer)(r.createElement(a.Consumer,null))?a:R}),[a,R]),d=(0,r.useContext)(p),T=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(d)&&Boolean(d.store);var S=T?n.store:d.store,C=(0,r.useMemo)((function(){return function(e){return t(e.dispatch,o)}(S)}),[S]),k=(0,r.useMemo)((function(){if(!E)return y;var t=new u(S,T?null:d.subscription),e=t.notifyNestedSubs.bind(t);return[t,e]}),[S,T,d]),N=k[0],A=k[1],P=(0,r.useMemo)((function(){return T?d:h({},d,{subscription:N})}),[T,d,N]),O=(0,r.useReducer)(m,g,I),x=O[0][0],D=O[1];if(x&&x.error)throw x.error;var M=(0,r.useRef)(),L=(0,r.useRef)(c),F=(0,r.useRef)(),j=(0,r.useRef)(!1),U=l((function(){return F.current&&c===L.current?F.current:C(S.getState(),c)}),[S,x,c]);b(_,[L,M,j,c,U,F,A]),b(w,[E,S,N,C,L,M,j,F,A,D],[S,N,C]);var q=(0,r.useMemo)((function(){return r.createElement(e,h({},U,{ref:s}))}),[s,e,U]);return(0,r.useMemo)((function(){return E?r.createElement(p.Provider,{value:P},q):q}),[p,q,P])}var S=s?r.memo(T):T;if(S.WrappedComponent=e,S.displayName=T.displayName=i,N){var k=r.forwardRef((function(t,e){return r.createElement(S,h({},t,{reactReduxForwardedRef:e}))}));return k.displayName=i,k.WrappedComponent=e,d()(k,e)}return d()(S,e)}}function E(t,e){return t===e?0!==t||0!==e||1/t===1/e:t!==t&&e!==e}function S(t,e){if(E(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(e,n[i])||!E(t[n[i]],e[n[i]]))return!1;return!0}function C(t){return function(e,n){var r=t(e,n);function i(){return r}return i.dependsOnOwnProps=!1,i}}function k(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function N(t,e){return function(e,n){n.displayName;var r=function(t,e){return r.dependsOnOwnProps?r.mapToProps(t,e):r.mapToProps(t)};return r.dependsOnOwnProps=!0,r.mapToProps=function(e,n){r.mapToProps=t,r.dependsOnOwnProps=k(t);var i=r(e,n);return"function"===typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=k(i),i=r(e,n)),i},r}}var A=[function(t){return"function"===typeof t?N(t):void 0},function(t){return t?void 0:C((function(t){return{dispatch:t}}))},function(t){return t&&"object"===typeof t?C((function(e){return function(t,e){var n={},r=function(r){var i=t[r];"function"===typeof i&&(n[r]=function(){return e(i.apply(void 0,arguments))})};for(var i in t)r(i);return n}(t,e)})):void 0}];var P=[function(t){return"function"===typeof t?N(t):void 0},function(t){return t?void 0:C((function(){return{}}))}];function O(t,e,n){return h({},n,t,e)}var R=[function(t){return"function"===typeof t?function(t){return function(e,n){n.displayName;var r,i=n.pure,o=n.areMergedPropsEqual,a=!1;return function(e,n,s){var u=t(e,n,s);return a?i&&o(u,r)||(r=u):(a=!0,r=u),r}}}(t):void 0},function(t){return t?void 0:function(){return O}}];function x(t,e,n,r){return function(i,o){return n(t(i,o),e(r,o),o)}}function D(t,e,n,r,i){var o,a,s,u,c,l=i.areStatesEqual,h=i.areOwnPropsEqual,f=i.areStatePropsEqual,p=!1;function d(i,p){var d=!h(p,a),v=!l(i,o);return o=i,a=p,d&&v?(s=t(o,a),e.dependsOnOwnProps&&(u=e(r,a)),c=n(s,u,a)):d?(t.dependsOnOwnProps&&(s=t(o,a)),e.dependsOnOwnProps&&(u=e(r,a)),c=n(s,u,a)):v?function(){var e=t(o,a),r=!f(e,s);return s=e,r&&(c=n(s,u,a)),c}():c}return function(i,l){return p?d(i,l):(s=t(o=i,a=l),u=e(r,a),c=n(s,u,a),p=!0,c)}}function M(t,e){var n=e.initMapStateToProps,r=e.initMapDispatchToProps,i=e.initMergeProps,o=f(e,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=n(t,o),s=r(t,o),u=i(t,o);return(o.pure?D:x)(a,s,u,t,o)}function L(t,e,n){for(var r=e.length-1;r>=0;r--){var i=e[r](t);if(i)return i}return function(e,r){throw new Error("Invalid value of type "+typeof t+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function F(t,e){return t===e}function j(t){var e=void 0===t?{}:t,n=e.connectHOC,r=void 0===n?T:n,i=e.mapStateToPropsFactories,o=void 0===i?P:i,a=e.mapDispatchToPropsFactories,s=void 0===a?A:a,u=e.mergePropsFactories,c=void 0===u?R:u,l=e.selectorFactory,p=void 0===l?M:l;return function(t,e,n,i){void 0===i&&(i={});var a=i,u=a.pure,l=void 0===u||u,d=a.areStatesEqual,v=void 0===d?F:d,g=a.areOwnPropsEqual,y=void 0===g?S:g,m=a.areStatePropsEqual,b=void 0===m?S:m,_=a.areMergedPropsEqual,w=void 0===_?S:_,I=f(a,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),T=L(t,o,"mapStateToProps"),E=L(e,s,"mapDispatchToProps"),C=L(n,c,"mergeProps");return r(p,h({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:T,initMapDispatchToProps:E,initMergeProps:C,pure:l,areStatesEqual:v,areOwnPropsEqual:y,areStatePropsEqual:b,areMergedPropsEqual:w},I))}}var U=j();var q,V=n(3935);q=V.unstable_batchedUpdates,o=q},8359:function(t,e){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,m=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,_=n?Symbol.for("react.scope"):60119;function w(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case l:case h:case o:case s:case a:case p:return t;default:switch(t=t&&t.$$typeof){case c:case f:case g:case v:case u:return t;default:return e}}case i:return e}}}function I(t){return w(t)===h}e.isContextConsumer=function(t){return w(t)===c}},2973:function(t,e,n){"use strict";t.exports=n(8359)}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[774,179],(function(){return e(1780),e(4651)}));var n=t.O();_N_E=n}]);